{% extends 'base.html' %}
{% load static %}

{% block content %}
<!-- Background Premium com Efeitos Avançados -->
<div class="premium-background">
    <div class="gradient-orbs">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>
        <div class="orb orb-4"></div>
    </div>
    <div class="mesh-gradient"></div>
    <div class="noise-texture"></div>
</div>

<!-- Loading Screen -->
<div class="loading-screen" id="loadingScreen">
    <div class="loading-content">
        <div class="loading-logo">
            <i class="fas fa-user-plus"></i>
        </div>
        <div class="loading-text">Carregando...</div>
        <div class="loading-bar">
            <div class="loading-progress"></div>
        </div>
    </div>
</div>

<div class="premium-container">
    <!-- Header Premium -->
    <header class="premium-header">
        <div class="header-glass">
            <!-- Breadcrumb Moderno -->
            <nav class="breadcrumb-premium">
                <a href="{% url 'home' %}" class="breadcrumb-link">
                    <div class="breadcrumb-icon">
                        <i class="fas fa-home"></i>
                    </div>
                    <span>Dashboard</span>
                </a>
                <div class="breadcrumb-separator">
                    <svg viewBox="0 0 24 24" fill="none">
                        <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <a href="{% url 'configuracoes' %}" class="breadcrumb-link">
                    <div class="breadcrumb-icon">
                        <i class="fas fa-cog"></i>
                    </div>
                    <span>Configurações</span>
                </a>
                <div class="breadcrumb-separator">
                    <svg viewBox="0 0 24 24" fill="none">
                        <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <span class="breadcrumb-current">
                    <div class="breadcrumb-icon">
                        <i class="fas fa-user-plus"></i>
                    </div>
                    <span>Criar Usuário</span>
                </span>
            </nav>

            <!-- Hero Section Ultra Premium -->
            <div class="hero-ultra-premium">
                <!-- Background Elements -->
                <div class="hero-background">
                    <div class="hero-gradient"></div>
                    <div class="hero-pattern"></div>
                    <div class="hero-orbs">
                        <div class="hero-orb hero-orb-1"></div>
                        <div class="hero-orb hero-orb-2"></div>
                        <div class="hero-orb hero-orb-3"></div>
                    </div>
                </div>
                
                <!-- Content Container -->
                <div class="hero-content">
                    <!-- Badge Premium -->
                    <div class="hero-badge-premium">
                        <div class="badge-icon">
                            <i class="fas fa-user-plus"></i>
                        </div>
                        <span class="badge-text">Novo Usuário</span>
                        <div class="badge-glow"></div>
                        <div class="badge-sparkle">
                            <div class="sparkle"></div>
                            <div class="sparkle"></div>
                            <div class="sparkle"></div>
                        </div>
                    </div>
                    
                    <!-- Title Section -->
                    <div class="hero-title-section">
                        <h1 class="hero-title-ultra">
                            <span class="title-line-1">Criar</span>
                            <span class="title-line-2">Novo Usuário</span>
                            <div class="title-accent"></div>
                        </h1>
                        <p class="hero-subtitle-ultra">
                            Configure um novo membro da equipe com acesso 
                            <span class="subtitle-highlight">personalizado</span> ao sistema
                        </p>
                    </div>
                    
                    <!-- Stats Dashboard Premium -->
                    <div class="stats-dashboard-premium">
                        <div class="dashboard-header">
                            <div class="dashboard-title">
                                <i class="fas fa-chart-pulse"></i>
                                <span>Estatísticas do Sistema</span>
                            </div>
                            <div class="dashboard-live">
                                <div class="live-indicator"></div>
                                <span>Ao vivo</span>
                            </div>
                        </div>
                        
                        <div class="stats-grid-ultra">
                            <div class="stat-card-ultra primary" data-tooltip="Total de usuários cadastrados">
                                <div class="stat-background">
                                    <div class="stat-pattern"></div>
                                    <div class="stat-gradient"></div>
                                </div>
                                <div class="stat-header-ultra">
                                    <div class="stat-icon-ultra">
                                        <i class="fas fa-users"></i>
                                        <div class="icon-ripple"></div>
                                    </div>
                                    <div class="stat-trend positive">
                                        <i class="fas fa-trending-up"></i>
                                        <span>+12%</span>
                                    </div>
                                </div>
                                <div class="stat-body-ultra">
                                    <div class="stat-number-ultra" id="totalUsersHeader">
                                        <span class="number-value">-</span>
                                        <div class="number-animation"></div>
                                    </div>
                                    <div class="stat-label-ultra">
                                        <span class="label-main">Usuários</span>
                                        <span class="label-sub">Total no sistema</span>
                                    </div>
                                </div>
                                <div class="stat-footer-ultra">
                                    <div class="progress-line">
                                        <div class="progress-fill" style="width: 75%"></div>
                                    </div>
                                    <span class="progress-text">75% da capacidade</span>
                                </div>
                            </div>
                            
                            <div class="stat-card-ultra success" data-tooltip="Usuários ativos no momento">
                                <div class="stat-background">
                                    <div class="stat-pattern"></div>
                                    <div class="stat-gradient"></div>
                                </div>
                                <div class="stat-header-ultra">
                                    <div class="stat-icon-ultra">
                                        <i class="fas fa-user-check"></i>
                                        <div class="icon-ripple"></div>
                                    </div>
                                    <div class="stat-trend positive">
                                        <i class="fas fa-trending-up"></i>
                                        <span>+5%</span>
                                    </div>
                                </div>
                                <div class="stat-body-ultra">
                                    <div class="stat-number-ultra" id="activeUsersHeader">
                                        <span class="number-value">-</span>
                                        <div class="number-animation"></div>
                                    </div>
                                    <div class="stat-label-ultra">
                                        <span class="label-main">Ativos</span>
                                        <span class="label-sub">Online agora</span>
                                    </div>
                                </div>
                                <div class="stat-footer-ultra">
                                    <div class="progress-line">
                                        <div class="progress-fill" style="width: 85%"></div>
                                    </div>
                                    <span class="progress-text">85% de engajamento</span>
                                </div>
                            </div>
                            
                            <div class="stat-card-ultra warning" data-tooltip="Administradores do sistema">
                                <div class="stat-background">
                                    <div class="stat-pattern"></div>
                                    <div class="stat-gradient"></div>
                                </div>
                                <div class="stat-header-ultra">
                                    <div class="stat-icon-ultra">
                                        <i class="fas fa-crown"></i>
                                        <div class="icon-ripple"></div>
                                    </div>
                                    <div class="stat-trend stable">
                                        <i class="fas fa-equals"></i>
                                        <span>0%</span>
                                    </div>
                                </div>
                                <div class="stat-body-ultra">
                                    <div class="stat-number-ultra" id="adminUsersHeader">
                                        <span class="number-value">-</span>
                                        <div class="number-animation"></div>
                                    </div>
                                    <div class="stat-label-ultra">
                                        <span class="label-main">Administradores</span>
                                        <span class="label-sub">Acesso total</span>
                                    </div>
                                </div>
                                <div class="stat-footer-ultra">
                                    <div class="progress-line">
                                        <div class="progress-fill" style="width: 30%"></div>
                                    </div>
                                    <span class="progress-text">Controle restrito</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Action Button Premium -->
                        <div class="dashboard-action">
                            <button class="action-btn-ultra" onclick="scrollToForm()">
                                <div class="btn-icon-ultra">
                                    <i class="fas fa-rocket"></i>
                                </div>
                                <span class="btn-text">Começar Agora</span>
                                <div class="btn-shine"></div>
                                <div class="btn-particles">
                                    <div class="particle"></div>
                                    <div class="particle"></div>
                                    <div class="particle"></div>
                                </div>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>



    <!-- Main Content -->
    <main class="main-content">
        <div class="content-wrapper">
            <!-- Form Container Premium -->
            <div class="form-container-premium">
                <!-- Progress Flow -->
                <div class="progress-flow">
                    <div class="flow-line">
                        <div class="flow-progress" id="flowProgress"></div>
                    </div>
                    <div class="flow-steps">
                        <div class="flow-step active" data-step="1">
                            <div class="step-circle">
                                <i class="fas fa-user"></i>
                                <div class="step-ripple"></div>
                            </div>
                            <div class="step-content">
                                <div class="step-title">Dados Pessoais</div>
                                <div class="step-desc">Informações básicas</div>
                            </div>
                        </div>
                        <div class="flow-step" data-step="2">
                            <div class="step-circle">
                                <i class="fas fa-lock"></i>
                                <div class="step-ripple"></div>
                            </div>
                            <div class="step-content">
                                <div class="step-title">Credenciais</div>
                                <div class="step-desc">Senha e acesso</div>
                            </div>
                        </div>
                        <div class="flow-step" data-step="3">
                            <div class="step-circle">
                                <i class="fas fa-shield-alt"></i>
                                <div class="step-ripple"></div>
                            </div>
                            <div class="step-content">
                                <div class="step-title">Permissões</div>
                                <div class="step-desc">Nível de acesso</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Form Premium -->
                <form method="post" class="form-premium" id="createUserForm" novalidate>
                    {% csrf_token %}
                    
                    <!-- Step 1: Dados Pessoais -->
                    <div class="step-panel active" data-step="1">
                        <div class="panel-header">
                            <div class="panel-icon">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="panel-content">
                                <h2>Informações Pessoais</h2>
                                <p>Configure os dados básicos do novo usuário</p>
                            </div>
                        </div>
                        
                        <div class="fields-grid">
                            <div class="field-group">
                                <label class="field-label">
                                    <span class="label-text">Nome Completo</span>
                                    <span class="label-required">*</span>
                                </label>
                                <div class="field-wrapper">
                                    <div class="field-icon">
                                        <i class="fas fa-user"></i>
                                    </div>
                                    <input type="text" id="first_name" name="first_name" class="field-input" placeholder="Digite o nome completo" required autocomplete="off">
                                    <div class="field-border"></div>
                                    <div class="field-focus"></div>
                                </div>
                                <div class="field-feedback" id="first_name_feedback"></div>
                                <div class="field-hint">Nome que será exibido no sistema</div>
                            </div>
                            
                            <div class="field-group">
                                <label class="field-label">
                                    <span class="label-text">Sobrenome</span>
                                </label>
                                <div class="field-wrapper">
                                    <div class="field-icon">
                                        <i class="fas fa-user-tag"></i>
                                    </div>
                                    <input type="text" id="last_name" name="last_name" class="field-input" placeholder="Digite o sobrenome" autocomplete="off">
                                    <div class="field-border"></div>
                                    <div class="field-focus"></div>
                                </div>
                                <div class="field-feedback" id="last_name_feedback"></div>
                                <div class="field-hint">Sobrenome ou nome da família</div>
                            </div>
                            
                            <div class="field-group">
                                <label class="field-label">
                                    <span class="label-text">Nome de Usuário</span>
                                    <span class="label-required">*</span>
                                </label>
                                <div class="field-wrapper">
                                    <div class="field-icon">
                                        <i class="fas fa-at"></i>
                                    </div>
                                    <input type="text" id="username" name="username" class="field-input" placeholder="usuario_sistema" required autocomplete="off">
                                    <div class="field-border"></div>
                                    <div class="field-focus"></div>
                                    <div class="field-status" id="username_status"></div>
                                </div>
                                <div class="field-feedback" id="username_feedback"></div>
                                <div class="field-hint">Nome único para login (apenas letras e números)</div>
                            </div>
                            
                            <div class="field-group">
                                <label class="field-label">
                                    <span class="label-text">Email</span>
                                </label>
                                <div class="field-wrapper">
                                    <div class="field-icon">
                                        <i class="fas fa-envelope"></i>
                                    </div>
                                    <input type="email" id="email" name="email" class="field-input" placeholder="usuario@exemplo.com" autocomplete="off">
                                    <div class="field-border"></div>
                                    <div class="field-focus"></div>
                                </div>
                                <div class="field-feedback" id="email_feedback"></div>
                                <div class="field-hint">Endereço de email para notificações</div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 2: Credenciais -->
                    <div class="step-panel" data-step="2">
                        <div class="panel-header">
                            <div class="panel-icon">
                                <i class="fas fa-lock"></i>
                            </div>
                            <div class="panel-content">
                                <h2>Credenciais de Acesso</h2>
                                <p>Defina uma senha segura para o usuário</p>
                            </div>
                        </div>
                        
                        <div class="fields-grid">
                            <div class="field-group">
                                <label class="field-label">
                                    <span class="label-text">Nova Senha</span>
                                    <span class="label-required">*</span>
                                </label>
                                <div class="field-wrapper">
                                    <div class="field-icon">
                                        <i class="fas fa-key"></i>
                                    </div>
                                    <input type="password" id="password1" name="password1" class="field-input" placeholder="••••••••" required autocomplete="new-password">
                                    <div class="field-border"></div>
                                    <div class="field-focus"></div>
                                    <button type="button" class="field-action" onclick="togglePassword('password1')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                                <div class="field-feedback" id="password1_feedback"></div>
                                
                                <!-- Password Strength -->
                                <div class="password-strength">
                                    <div class="strength-header">
                                        <span class="strength-label">Força da senha</span>
                                        <span class="strength-text" id="strengthText">Digite uma senha</span>
                                    </div>
                                    <div class="strength-meter">
                                        <div class="strength-fill" id="strengthFill"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="field-group">
                                <label class="field-label">
                                    <span class="label-text">Confirmar Senha</span>
                                    <span class="label-required">*</span>
                                </label>
                                <div class="field-wrapper">
                                    <div class="field-icon">
                                        <i class="fas fa-check-double"></i>
                                    </div>
                                    <input type="password" id="password2" name="password2" class="field-input" placeholder="••••••••" required autocomplete="new-password">
                                    <div class="field-border"></div>
                                    <div class="field-focus"></div>
                                    <button type="button" class="field-action" onclick="togglePassword('password2')">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                </div>
                                <div class="field-feedback" id="password2_feedback"></div>
                                <div class="field-hint">Digite a senha novamente para confirmar</div>
                            </div>
                        </div>

                        <!-- Security Guidelines -->
                        <div class="security-guidelines">
                            <div class="guidelines-header">
                                <div class="guidelines-icon">
                                    <i class="fas fa-shield-alt"></i>
                                </div>
                                <h3>Diretrizes de Segurança</h3>
                            </div>
                            <div class="guidelines-grid">
                                <div class="guideline-item" id="guideline-length">
                                    <div class="guideline-icon">
                                        <i class="fas fa-times"></i>
                                    </div>
                                    <span>Mínimo 8 caracteres</span>
                                </div>
                                <div class="guideline-item" id="guideline-uppercase">
                                    <div class="guideline-icon">
                                        <i class="fas fa-times"></i>
                                    </div>
                                    <span>Letra maiúscula</span>
                                </div>
                                <div class="guideline-item" id="guideline-lowercase">
                                    <div class="guideline-icon">
                                        <i class="fas fa-times"></i>
                                    </div>
                                    <span>Letra minúscula</span>
                                </div>
                                <div class="guideline-item" id="guideline-number">
                                    <div class="guideline-icon">
                                        <i class="fas fa-times"></i>
                                    </div>
                                    <span>Número</span>
                                </div>
                                <div class="guideline-item" id="guideline-special">
                                    <div class="guideline-icon">
                                        <i class="fas fa-times"></i>
                                    </div>
                                    <span>Caractere especial</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Permissões -->
                    <div class="step-panel" data-step="3">
                        <div class="panel-header">
                            <div class="panel-icon">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <div class="panel-content">
                                <h2>Permissões e Acesso</h2>
                                <p>Configure o nível de acesso do usuário no sistema</p>
                            </div>
                        </div>
                        
                        <div class="permissions-premium">
                            <div class="permission-card">
                                <div class="permission-header">
                                    <div class="permission-icon">
                                        <i class="fas fa-user-check"></i>
                                    </div>
                                    <div class="permission-info">
                                        <h3>Status do Usuário</h3>
                                        <p>Controla se o usuário pode fazer login no sistema</p>
                                    </div>
                                </div>
                                <div class="permission-control">
                                    <div class="toggle-premium">
                                        <input type="checkbox" id="is_active" name="is_active" checked class="toggle-input">
                                        <label for="is_active" class="toggle-label">
                                            <div class="toggle-track">
                                                <div class="toggle-thumb">
                                                    <i class="fas fa-check"></i>
                                                </div>
                                            </div>
                                            <span class="toggle-text">Usuário Ativo</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="permission-card">
                                <div class="permission-header">
                                    <div class="permission-icon admin">
                                        <i class="fas fa-crown"></i>
                                    </div>
                                    <div class="permission-info">
                                        <h3>Privilégios Administrativos</h3>
                                        <p>Permite gerenciar outros usuários e configurações do sistema</p>
                                    </div>
                                </div>
                                <div class="permission-control">
                                    <div class="toggle-premium">
                                        <input type="checkbox" id="is_staff" name="is_staff" class="toggle-input">
                                        <label for="is_staff" class="toggle-label">
                                            <div class="toggle-track">
                                                <div class="toggle-thumb">
                                                    <i class="fas fa-crown"></i>
                                                </div>
                                            </div>
                                            <span class="toggle-text">Administrador</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- User Preview Premium -->
                        <div class="user-preview-premium">
                            <div class="preview-header">
                                <div class="preview-icon">
                                    <i class="fas fa-eye"></i>
                                </div>
                                <h3>Preview do Usuário</h3>
                                <p>Visualização de como o usuário aparecerá no sistema</p>
                            </div>
                            <div class="preview-card">
                                <div class="preview-avatar">
                                    <div class="avatar-circle">
                                        <i class="fas fa-user"></i>
                                    </div>
                                    <div class="avatar-status" id="avatarStatus"></div>
                                </div>
                                <div class="preview-details">
                                    <div class="preview-name" id="previewName">Novo Usuário</div>
                                    <div class="preview-username" id="previewUsername">@usuario</div>
                                    <div class="preview-email" id="previewEmail">usuario@exemplo.com</div>
                                    <div class="preview-badges">
                                        <div class="preview-badge status" id="previewStatus">Ativo</div>
                                        <div class="preview-badge role" id="previewRole" style="display: none;">Administrador</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Navigation Premium -->
                    <div class="navigation-premium">
                        <button type="button" class="nav-btn nav-btn-secondary" id="prevBtn" onclick="navigateStep(-1)" style="display: none;">
                            <div class="btn-icon">
                                <i class="fas fa-arrow-left"></i>
                            </div>
                            <span>Voltar</span>
                        </button>
                        
                        <div class="nav-center">
                            <div class="step-counter">
                                <span class="current-step" id="currentStepDisplay">1</span>
                                <span class="step-separator">de</span>
                                <span class="total-steps">3</span>
                            </div>
                        </div>
                        
                        <button type="button" class="nav-btn nav-btn-primary" id="nextBtn" onclick="navigateStep(1)">
                            <span>Continuar</span>
                            <div class="btn-icon">
                                <i class="fas fa-arrow-right"></i>
                            </div>
                        </button>
                        
                        <button type="submit" class="nav-btn nav-btn-success" id="submitBtn" style="display: none;">
                            <div class="btn-icon">
                                <i class="fas fa-user-plus"></i>
                            </div>
                            <span>Criar Usuário</span>
                            <div class="btn-spinner" style="display: none;">
                                <i class="fas fa-spinner fa-spin"></i>
                            </div>
                        </button>
                    </div>
                </form>
            </div>

            <!-- Ações Rápidas Colapsáveis -->
            <div class="quick-actions-collapsible" id="quickActionsContainer">
                <!-- Botão Recolhido (estado inicial) -->
                <div class="actions-collapsed" id="actionsCollapsed" onclick="toggleQuickActions()">
                    <div class="collapsed-icon">
                        <i class="fas fa-bolt"></i>
                        <div class="pulse-ring"></div>
                    </div>
                    <div class="collapsed-label">
                        <span>Ações Rápidas</span>
                        <small>Clique para expandir</small>
                    </div>
                </div>

                <!-- Conteúdo Expandido -->
                <div class="actions-expanded" id="actionsExpanded" style="display: none;">
                    <div class="actions-expanded-header">
                        <div class="header-content">
                            <div class="header-icon-expanded">
                                <i class="fas fa-bolt"></i>
                            </div>
                            <div class="header-text">
                                <h3>Ações Rápidas</h3>
                                <p>Ferramentas para agilizar seu trabalho</p>
                            </div>
                        </div>
                        <button class="close-actions" onclick="toggleQuickActions()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div class="actions-expanded-grid">
                        <a href="{% url 'gerenciar_usuarios' %}" class="action-card-expanded single-action">
                            <div class="action-icon-expanded">
                                <i class="fas fa-users-cog"></i>
                                <div class="icon-glow-expanded"></div>
                            </div>
                            <div class="action-content-expanded">
                                <h4>Gerenciar Usuários</h4>
                                <p>Visualize e edite todos os usuários do sistema</p>
                                <div class="action-badge-expanded">
                                    <i class="fas fa-eye"></i>
                                    <span>Visão Completa</span>
                                </div>
                            </div>
                            <div class="action-hover-effect-expanded"></div>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Sidebar Premium -->
            <aside class="sidebar-premium">
                <!-- Assistente Virtual Colapsável -->
                <div class="assistant-collapsible" id="assistantContainer">
                    <!-- Botão Recolhido (estado inicial) -->
                    <div class="assistant-collapsed" id="assistantCollapsed" onclick="toggleAssistant()">
                        <div class="collapsed-icon-assistant">
                            <i class="fas fa-robot"></i>
                            <div class="pulse-ring-assistant"></div>
                        </div>
                        <div class="collapsed-label-assistant">
                            <span>Assistente Virtual</span>
                            <small>Clique para ajuda</small>
                        </div>
                    </div>

                    <!-- Conteúdo Expandido -->
                    <div class="assistant-expanded" id="assistantExpanded" style="display: none;">
                        <div class="assistant-expanded-header">
                            <div class="header-content-assistant">
                                <div class="help-icon-container-expanded">
                                    <div class="help-avatar-expanded">
                                        <i class="fas fa-robot"></i>
                                        <div class="avatar-glow-expanded"></div>
                                    </div>
                                    <div class="help-status-expanded">
                                        <div class="status-dot-expanded"></div>
                                        <span>Online</span>
                                    </div>
                                </div>
                                <div class="header-text-assistant">
                                    <h3>Assistente Virtual</h3>
                                    <p>Precisa de ajuda? Estou aqui para guiá-lo!</p>
                                </div>
                            </div>
                            <button class="close-assistant" onclick="toggleAssistant()">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        
                        <div class="help-features-expanded">
                            <div class="feature-item-expanded">
                                <div class="feature-icon-expanded">
                                    <i class="fas fa-lightbulb"></i>
                                </div>
                                <span>Sugestões inteligentes</span>
                            </div>
                            <div class="feature-item-expanded">
                                <div class="feature-icon-expanded">
                                    <i class="fas fa-shield-alt"></i>
                                </div>
                                <span>Dicas de segurança</span>
                            </div>
                            <div class="feature-item-expanded">
                                <div class="feature-icon-expanded">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <span>Suporte 24/7</span>
                            </div>
                        </div>
                        
                        <button class="help-btn-expanded" onclick="openAssistant()">
                            <div class="btn-content-expanded">
                                <i class="fas fa-comments"></i>
                                <span>Iniciar Conversa</span>
                            </div>
                            <div class="btn-sparkle-expanded">
                                <i class="fas fa-star"></i>
                            </div>
                        </button>
                    </div>
                </div>

                <!-- Ações Rápidas removidas da sidebar -->

                <!-- Estatísticas Premium -->
                <div class="stats-card-premium">
                    <div class="stats-header">
                        <div class="header-main">
                            <div class="stats-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="header-content">
                                <h3>Estatísticas do Sistema</h3>
                                <p>Dados em tempo real do sistema</p>
                            </div>
                        </div>
                        <div class="refresh-indicator">
                            <div class="refresh-dot"></div>
                            <span>Ao vivo</span>
                        </div>
                    </div>
                    
                    <div class="stats-grid-premium">
                        <div class="stat-card-item total">
                            <div class="stat-content">
                                <div class="stat-header-item">
                                    <div class="stat-icon-item">
                                        <i class="fas fa-users"></i>
                                    </div>
                                    <div class="stat-trend positive">
                                        <i class="fas fa-arrow-up"></i>
                                    </div>
                                </div>
                                <div class="stat-number-large" id="totalUsers">-</div>
                                <div class="stat-label-item">Usuários Totais</div>
                                <div class="stat-description">Todos os usuários cadastrados</div>
                            </div>
                            <div class="stat-animation"></div>
                        </div>
                        
                        <div class="stat-card-item active">
                            <div class="stat-content">
                                <div class="stat-header-item">
                                    <div class="stat-icon-item">
                                        <i class="fas fa-user-check"></i>
                                    </div>
                                    <div class="stat-trend positive">
                                        <i class="fas fa-arrow-up"></i>
                                    </div>
                                </div>
                                <div class="stat-number-large" id="activeUsers">-</div>
                                <div class="stat-label-item">Usuários Ativos</div>
                                <div class="stat-description">Com acesso habilitado</div>
                            </div>
                            <div class="stat-animation"></div>
                        </div>
                        
                        <div class="stat-card-item admin">
                            <div class="stat-content">
                                <div class="stat-header-item">
                                    <div class="stat-icon-item">
                                        <i class="fas fa-crown"></i>
                                    </div>
                                    <div class="stat-trend stable">
                                        <i class="fas fa-minus"></i>
                                    </div>
                                </div>
                                <div class="stat-number-large" id="adminUsers">-</div>
                                <div class="stat-label-item">Administradores</div>
                                <div class="stat-description">Com privilégios elevados</div>
                            </div>
                            <div class="stat-animation"></div>
                        </div>
                        
                        <div class="stat-card-item recent">
                            <div class="stat-content">
                                <div class="stat-header-item">
                                    <div class="stat-icon-item">
                                        <i class="fas fa-clock"></i>
                                    </div>
                                    <div class="stat-trend positive">
                                        <i class="fas fa-arrow-up"></i>
                                    </div>
                                </div>
                                <div class="stat-number-large" id="recentUsers">-</div>
                                <div class="stat-label-item">Novos Usuários</div>
                                <div class="stat-description">Últimos 30 dias</div>
                            </div>
                            <div class="stat-animation"></div>
                        </div>
                    </div>
                    
                    <div class="stats-footer">
                        <div class="last-update">
                            <i class="fas fa-clock"></i>
                            <span>Atualizado agora</span>
                        </div>
                        <div class="auto-refresh">
                            <div class="refresh-icon">
                                <i class="fas fa-sync-alt"></i>
                            </div>
                            <span>Auto-refresh</span>
                        </div>
                    </div>
                </div>
            </aside>
        </div>
    </main>
</div>

<style>
/* ===== DESIGN SYSTEM PREMIUM ===== */
:root {
    /* Cores Primárias */
    --emerald-50: #ecfdf5;
    --emerald-100: #d1fae5;
    --emerald-200: #a7f3d0;
    --emerald-300: #6ee7b7;
    --emerald-400: #34d399;
    --emerald-500: #10b981;
    --emerald-600: #059669;
    --emerald-700: #047857;
    --emerald-800: #065f46;
    --emerald-900: #064e3b;
    
    /* Cores Neutras */
    --gray-50: #f9fafb;
    --gray-100: #f3f4f6;
    --gray-200: #e5e7eb;
    --gray-300: #d1d5db;
    --gray-400: #9ca3af;
    --gray-500: #6b7280;
    --gray-600: #4b5563;
    --gray-700: #374151;
    --gray-800: #1f2937;
    --gray-900: #111827;
    
    /* Sistema de Cores */
    --primary: var(--emerald-500);
    --primary-light: var(--emerald-400);
    --primary-dark: var(--emerald-600);
    --success: var(--emerald-500);
    --error: #ef4444;
    --warning: #f59e0b;
    --info: #3b82f6;
    
    /* Tipografia */
    --text-primary: var(--gray-900);
    --text-secondary: var(--gray-600);
    --text-muted: var(--gray-500);
    --text-light: var(--gray-400);
    
    /* Backgrounds */
    --bg-primary: #ffffff;
    --bg-secondary: var(--gray-50);
    --bg-tertiary: var(--gray-100);
    --bg-glass: rgba(255, 255, 255, 0.8);
    --bg-glass-dark: rgba(255, 255, 255, 0.95);
    
    /* Borders */
    --border: var(--gray-200);
    --border-light: var(--gray-100);
    --border-dark: var(--gray-300);
    
    /* Shadows */
    --shadow-xs: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    --shadow-2xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    --shadow-inner: inset 0 2px 4px 0 rgba(0, 0, 0, 0.06);
    
    /* Radius */
    --radius-xs: 4px;
    --radius-sm: 6px;
    --radius-md: 8px;
    --radius-lg: 12px;
    --radius-xl: 16px;
    --radius-2xl: 24px;
    --radius-full: 9999px;
    
    /* Transitions */
    --transition-fast: 0.15s ease;
    --transition-base: 0.2s ease;
    --transition-slow: 0.3s ease;
    --transition-slower: 0.5s ease;
    
    /* Z-Index */
    --z-dropdown: 1000;
    --z-sticky: 1020;
    --z-fixed: 1030;
    --z-modal: 1040;
    --z-popover: 1050;
    --z-tooltip: 1060;
}

/* ===== RESET PREMIUM ===== */
*,
*::before,
*::after {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

html {
    font-size: 16px;
    line-height: 1.5;
    -webkit-text-size-adjust: 100%;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    scroll-behavior: smooth;
}

body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    background: linear-gradient(135deg, var(--emerald-50) 0%, var(--emerald-100) 30%, var(--emerald-200) 100%);
    min-height: 100vh;
    color: var(--text-primary);
    overflow-x: hidden;
    position: relative;
}

/* ===== BACKGROUND PREMIUM ===== */
.premium-background {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    overflow: hidden;
    pointer-events: none;
}

.gradient-orbs {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
}

.orb {
    position: absolute;
    border-radius: 50%;
    filter: blur(60px);
    opacity: 0.7;
    animation: orbFloat 8s ease-in-out infinite;
    pointer-events: none;
}

.orb-1 {
    width: 300px;
    height: 300px;
    background: radial-gradient(circle, var(--emerald-300) 0%, var(--emerald-400) 50%, transparent 70%);
    top: -10%;
    left: -10%;
    animation-delay: 0s;
}

.orb-2 {
    width: 200px;
    height: 200px;
    background: radial-gradient(circle, var(--emerald-200) 0%, var(--emerald-300) 50%, transparent 70%);
    top: 50%;
    right: -5%;
    animation-delay: 2s;
}

.orb-3 {
    width: 250px;
    height: 250px;
    background: radial-gradient(circle, var(--emerald-100) 0%, var(--emerald-200) 50%, transparent 70%);
    bottom: -15%;
    left: 30%;
    animation-delay: 4s;
}

.orb-4 {
    width: 180px;
    height: 180px;
    background: radial-gradient(circle, var(--emerald-400) 0%, var(--emerald-300) 50%, transparent 70%);
    top: 20%;
    right: 25%;
    animation-delay: 6s;
}

.mesh-gradient {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: 
        radial-gradient(ellipse at 20% 50%, rgba(16, 185, 129, 0.15) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 20%, rgba(52, 211, 153, 0.15) 0%, transparent 50%),
        radial-gradient(ellipse at 40% 80%, rgba(167, 243, 208, 0.15) 0%, transparent 50%);
    pointer-events: none;
}

.noise-texture {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: 
        radial-gradient(circle at 25% 25%, rgba(255, 255, 255, 0.1) 1px, transparent 1px),
        radial-gradient(circle at 75% 75%, rgba(255, 255, 255, 0.05) 1px, transparent 1px);
    background-size: 50px 50px, 80px 80px;
    opacity: 0.3;
    pointer-events: none;
}

@keyframes orbFloat {
    0%, 100% {
        transform: translate(0, 0) scale(1);
        opacity: 0.7;
    }
    25% {
        transform: translate(30px, -30px) scale(1.1);
        opacity: 0.5;
    }
    50% {
        transform: translate(-20px, 20px) scale(0.9);
        opacity: 0.8;
    }
    75% {
        transform: translate(20px, 10px) scale(1.05);
        opacity: 0.6;
    }
}

/* ===== PROGRESS FLOW ===== */
.progress-flow {
    margin-bottom: 3rem;
    position: relative;
}

.flow-line {
    position: absolute;
    top: 30px;
    left: 0;
    right: 0;
    height: 2px;
    background: var(--border);
    border-radius: var(--radius-full);
    z-index: 1;
}

.flow-progress {
    height: 100%;
    background: linear-gradient(90deg, var(--primary) 0%, var(--primary-light) 100%);
    border-radius: var(--radius-full);
    transition: width var(--transition-slow);
    width: 33.33%;
    position: relative;
}

.flow-progress::after {
    content: '';
    position: absolute;
    right: -6px;
    top: -4px;
    width: 10px;
    height: 10px;
    background: var(--primary);
    border-radius: 50%;
    box-shadow: 0 0 0 3px var(--bg-primary);
}

.flow-steps {
    display: flex;
    justify-content: space-between;
    position: relative;
    z-index: 2;
}

.flow-step {
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
    cursor: pointer;
    transition: all var(--transition-base);
}

.step-circle {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: var(--bg-primary);
    border: 3px solid var(--border);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.25rem;
    color: var(--text-muted);
    transition: all var(--transition-base);
    position: relative;
    overflow: hidden;
}

.flow-step.active .step-circle {
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
    border-color: var(--primary);
    color: white;
    box-shadow: var(--shadow-lg);
}

.flow-step.completed .step-circle {
    background: var(--success);
    border-color: var(--success);
    color: white;
}

.step-ripple {
    position: absolute;
    inset: -10px;
    border-radius: 50%;
    background: var(--primary);
    opacity: 0;
    transform: scale(0);
    transition: all var(--transition-base);
}

.flow-step.active .step-ripple {
    animation: ripple 2s ease-in-out infinite;
}

@keyframes ripple {
    0% {
        transform: scale(1);
        opacity: 0.3;
    }
    100% {
        transform: scale(1.5);
        opacity: 0;
    }
}

.step-content {
    margin-top: 1rem;
    text-align: center;
}

.step-title {
    font-size: 1rem;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 0.25rem;
}

.flow-step.active .step-title {
    color: var(--primary);
}

    .step-desc {
        font-size: 0.875rem;
        color: var(--text-muted);
    }

    /* ===== FORM CONTAINER ULTRA PREMIUM ===== */
    .form-container-premium {
        background: linear-gradient(145deg, 
            rgba(255, 255, 255, 0.98) 0%, 
            rgba(248, 250, 252, 0.95) 50%,
            rgba(241, 245, 249, 0.9) 100%);
        backdrop-filter: blur(30px) saturate(1.2);
        border-radius: 32px;
        padding: 3.5rem;
        box-shadow: 
            0 40px 80px -20px rgba(0, 0, 0, 0.12),
            0 20px 50px -15px rgba(16, 185, 129, 0.15),
            inset 0 1px 0 rgba(255, 255, 255, 0.9),
            inset 0 -1px 0 rgba(0, 0, 0, 0.02);
        border: 1px solid rgba(255, 255, 255, 0.4);
        margin-bottom: 3rem;
        position: relative;
        overflow: hidden;
        transition: all 0.8s cubic-bezier(0.23, 1, 0.320, 1);
        transform: translateY(0);
        animation: formContainerEntrance 1.2s ease-out;
    }

    @keyframes formContainerEntrance {
        0% {
            opacity: 0;
            transform: translateY(40px) scale(0.95);
        }
        60% {
            opacity: 0.8;
            transform: translateY(-5px) scale(1.02);
        }
        100% {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
    }

    .form-container-premium::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 8px;
        background: linear-gradient(90deg, 
            var(--primary-color) 0%, 
            var(--primary-light) 25%,
            #34d399 50%,
            var(--primary-light) 75%,
            var(--primary-color) 100%);
        background-size: 200% 100%;
        animation: headerShimmer 4s ease-in-out infinite;
        border-radius: 32px 32px 0 0;
    }

    @keyframes headerShimmer {
        0%, 100% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
    }

    .form-container-premium::after {
        content: '';
        position: absolute;
        top: -3px;
        left: -3px;
        right: -3px;
        bottom: -3px;
        background: linear-gradient(45deg, 
            transparent 0%, 
            rgba(16, 185, 129, 0.1) 25%, 
            rgba(52, 211, 153, 0.1) 50%,
            rgba(16, 185, 129, 0.1) 75%,
            transparent 100%);
        border-radius: 35px;
        z-index: -1;
        opacity: 0;
        animation: borderGlow 6s ease-in-out infinite;
    }

    @keyframes borderGlow {
        0%, 100% { opacity: 0; transform: rotate(0deg) scale(1); }
        50% { opacity: 0.8; transform: rotate(180deg) scale(1.02); }
    }

    .form-container-premium:hover {
        transform: translateY(-2px);
        box-shadow: 
            0 50px 100px -25px rgba(0, 0, 0, 0.15),
            0 25px 60px -20px rgba(16, 185, 129, 0.2),
            inset 0 1px 0 rgba(255, 255, 255, 0.95),
            inset 0 -1px 0 rgba(0, 0, 0, 0.03);
    }

    /* ===== PROGRESS FLOW ULTRA PREMIUM ===== */
    .progress-flow {
        margin-bottom: 4rem;
        position: relative;
        padding: 2rem 0;
    }

    .flow-line {
        position: absolute;
        top: 45px;
        left: 15%;
        right: 15%;
        height: 4px;
        background: linear-gradient(90deg, 
            var(--border) 0%, 
            var(--border-light) 50%, 
            var(--border) 100%);
        border-radius: var(--radius-full);
        z-index: 1;
        overflow: hidden;
    }

    .flow-line::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, 
            transparent 0%, 
            rgba(16, 185, 129, 0.3) 50%, 
            transparent 100%);
        animation: lineShimmer 3s ease-in-out infinite;
    }

    @keyframes lineShimmer {
        0% { left: -100%; }
        100% { left: 100%; }
    }

    .flow-progress {
        height: 100%;
        background: linear-gradient(90deg, 
            var(--primary) 0%, 
            var(--primary-light) 50%,
            #34d399 100%);
        border-radius: var(--radius-full);
        transition: width 0.8s cubic-bezier(0.23, 1, 0.320, 1);
        width: 33.33%;
        position: relative;
        overflow: hidden;
        box-shadow: 0 2px 8px rgba(16, 185, 129, 0.4);
    }

    .flow-progress::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, 
            transparent 0%, 
            rgba(255, 255, 255, 0.6) 50%, 
            transparent 100%);
        animation: progressShine 2s ease-in-out infinite;
    }

    @keyframes progressShine {
        0% { left: -100%; }
        100% { left: 100%; }
    }

    .flow-progress::after {
        content: '';
        position: absolute;
        right: -8px;
        top: -6px;
        width: 16px;
        height: 16px;
        background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
        border-radius: 50%;
        box-shadow: 
            0 0 0 4px var(--bg-primary),
            0 4px 12px rgba(16, 185, 129, 0.4);
        animation: progressPulse 2s ease-in-out infinite;
    }

    @keyframes progressPulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.2); }
    }

    .flow-steps {
        display: flex;
        justify-content: space-between;
        position: relative;
        z-index: 2;
        max-width: 800px;
        margin: 0 auto;
    }

    .flow-step {
        display: flex;
        flex-direction: column;
        align-items: center;
        position: relative;
        cursor: pointer;
        transition: all 0.4s cubic-bezier(0.23, 1, 0.320, 1);
        padding: 1rem;
        border-radius: 20px;
        background: rgba(255, 255, 255, 0.3);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .flow-step:hover {
        transform: translateY(-5px);
        background: rgba(255, 255, 255, 0.5);
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
    }

    .step-circle {
        width: 70px;
        height: 70px;
        border-radius: 50%;
        background: linear-gradient(135deg, var(--bg-primary) 0%, #f8fafc 100%);
        border: 3px solid var(--border);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.4rem;
        color: var(--text-muted);
        transition: all 0.4s cubic-bezier(0.23, 1, 0.320, 1);
        position: relative;
        overflow: hidden;
    }

    .step-circle::before {
        content: '';
        position: absolute;
        inset: -3px;
        border-radius: 50%;
        background: linear-gradient(135deg, var(--primary), var(--primary-light));
        opacity: 0;
        transition: opacity 0.4s ease;
        z-index: -1;
    }

    .flow-step.active .step-circle {
        background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 50%, #34d399 100%);
        border-color: transparent;
        color: white;
        box-shadow: 
            0 15px 35px -5px rgba(16, 185, 129, 0.4),
            0 0 20px rgba(16, 185, 129, 0.3);
        transform: scale(1.1);
    }

    .flow-step.active .step-circle::before {
        opacity: 1;
        animation: circlePulse 2s ease-in-out infinite;
    }

    @keyframes circlePulse {
        0%, 100% { transform: scale(1); opacity: 0.3; }
        50% { transform: scale(1.2); opacity: 0.1; }
    }

    .flow-step.completed .step-circle {
        background: linear-gradient(135deg, var(--success) 0%, #10b981 100%);
        border-color: transparent;
        color: white;
        box-shadow: 0 10px 25px rgba(16, 185, 129, 0.3);
    }

    .step-content {
        margin-top: 1.5rem;
        text-align: center;
        transition: all 0.3s ease;
    }

    .step-title {
        font-size: 1.1rem;
        font-weight: 700;
        color: var(--text-primary);
        margin-bottom: 0.5rem;
        transition: all 0.3s ease;
    }

    .flow-step.active .step-title {
        color: var(--primary);
        text-shadow: 0 2px 4px rgba(16, 185, 129, 0.2);
    }

    .step-desc {
        font-size: 0.9rem;
        color: var(--text-muted);
        font-weight: 500;
        transition: all 0.3s ease;
    }

    .flow-step.active .step-desc {
        color: var(--text-secondary);
    }

/* ===== FORM PREMIUM ===== */
.form-premium {
    position: relative;
}

.step-panel {
    display: none;
    opacity: 0;
    transform: translateX(20px);
    transition: all var(--transition-slow);
}

.step-panel.active {
    display: block;
    opacity: 1;
    transform: translateX(0);
    animation: slideInPanel var(--transition-slow) ease-out;
}

@keyframes slideInPanel {
    from {
        opacity: 0;
        transform: translateX(20px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

    /* ===== PANEL HEADER ULTRA PREMIUM ===== */
    .panel-header {
        display: flex;
        align-items: center;
        gap: 1.5rem;
        margin-bottom: 3rem;
        padding: 2rem;
        background: linear-gradient(135deg, 
            rgba(16, 185, 129, 0.05) 0%, 
            rgba(52, 211, 153, 0.03) 100%);
        border-radius: 24px;
        border: 1px solid rgba(16, 185, 129, 0.1);
        position: relative;
        overflow: hidden;
    }

    .panel-header::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, 
            transparent 0%, 
            rgba(16, 185, 129, 0.1) 50%, 
            transparent 100%);
        animation: panelShine 3s ease-in-out infinite;
    }

    @keyframes panelShine {
        0% { left: -100%; }
        100% { left: 100%; }
    }

    .panel-icon {
        width: 70px;
        height: 70px;
        background: linear-gradient(135deg, 
            var(--primary) 0%, 
            var(--primary-light) 50%,
            #34d399 100%);
        border-radius: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 1.5rem;
        box-shadow: 
            0 15px 35px -5px rgba(16, 185, 129, 0.4),
            0 5px 15px rgba(16, 185, 129, 0.2);
        position: relative;
        overflow: hidden;
        transition: all 0.3s ease;
    }

    .panel-icon::before {
        content: '';
        position: absolute;
        inset: -2px;
        background: linear-gradient(135deg, var(--primary), var(--primary-light));
        border-radius: 22px;
        z-index: -1;
        opacity: 0;
        animation: iconGlow 2s ease-in-out infinite;
    }

    @keyframes iconGlow {
        0%, 100% { opacity: 0; transform: scale(1); }
        50% { opacity: 0.5; transform: scale(1.05); }
    }

    .panel-content {
        flex: 1;
        position: relative;
        z-index: 2;
    }

    .panel-content h2 {
        font-size: 2rem;
        font-weight: 800;
        background: linear-gradient(135deg, 
            var(--text-primary) 0%, 
            var(--primary) 50%, 
            var(--text-primary) 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 0.75rem;
        line-height: 1.2;
    }

    .panel-content p {
        color: var(--text-secondary);
        font-size: 1.1rem;
        line-height: 1.6;
        font-weight: 500;
        opacity: 0.9;
    }

/* ===== FIELDS GRID ===== */
.fields-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
}

    /* ===== FIELD GROUP ULTRA PREMIUM ===== */
    .field-group {
        position: relative;
        margin-bottom: 2rem;
        animation: fieldEntrance 0.6s ease-out;
        animation-fill-mode: both;
    }

    .field-group:nth-child(1) { animation-delay: 0.1s; }
    .field-group:nth-child(2) { animation-delay: 0.2s; }
    .field-group:nth-child(3) { animation-delay: 0.3s; }
    .field-group:nth-child(4) { animation-delay: 0.4s; }

    @keyframes fieldEntrance {
        0% {
            opacity: 0;
            transform: translateY(20px);
        }
        100% {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .field-label {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        margin-bottom: 1rem;
        font-weight: 700;
        color: var(--text-primary);
        font-size: 1rem;
        position: relative;
    }

    .label-text {
        font-size: 1rem;
        position: relative;
    }

    .label-text::after {
        content: '';
        position: absolute;
        bottom: -3px;
        left: 0;
        width: 0;
        height: 2px;
        background: linear-gradient(90deg, var(--primary), var(--primary-light));
        transition: width 0.3s ease;
    }

    .field-wrapper:focus-within + .field-feedback + .field-hint .label-text::after,
    .field-group:hover .label-text::after {
        width: 100%;
    }

    .label-required {
        color: var(--error);
        font-size: 0.9rem;
        font-weight: 800;
        animation: requiredPulse 2s ease-in-out infinite;
    }

    @keyframes requiredPulse {
        0%, 100% { opacity: 1; transform: scale(1); }
        50% { opacity: 0.7; transform: scale(1.1); }
    }

    .field-wrapper {
        position: relative;
        background: linear-gradient(145deg, 
            rgba(255, 255, 255, 0.95) 0%, 
            rgba(248, 250, 252, 0.9) 100%);
        border: 2px solid var(--border);
        border-radius: 20px;
        transition: all 0.4s cubic-bezier(0.23, 1, 0.320, 1);
        pointer-events: auto;
        z-index: 1;
        overflow: hidden;
        backdrop-filter: blur(10px);
        box-shadow: 
            0 4px 15px rgba(0, 0, 0, 0.05),
            inset 0 1px 0 rgba(255, 255, 255, 0.8);
    }

    .field-wrapper::before {
        content: '';
        position: absolute;
        inset: 0;
        background: linear-gradient(135deg, 
            rgba(16, 185, 129, 0.05) 0%, 
            rgba(52, 211, 153, 0.03) 100%);
        opacity: 0;
        transition: opacity 0.3s ease;
        border-radius: 18px;
    }

    .field-wrapper:hover {
        border-color: var(--primary);
        transform: translateY(-2px);
        box-shadow: 
            0 8px 25px rgba(0, 0, 0, 0.1),
            0 4px 15px rgba(16, 185, 129, 0.15),
            inset 0 1px 0 rgba(255, 255, 255, 0.9);
    }

    .field-wrapper:hover::before {
        opacity: 1;
    }

    .field-wrapper:focus-within {
        border-color: var(--primary);
        transform: translateY(-3px);
        box-shadow: 
            0 15px 35px rgba(0, 0, 0, 0.12),
            0 8px 25px rgba(16, 185, 129, 0.25),
            0 0 0 4px rgba(16, 185, 129, 0.1),
            inset 0 1px 0 rgba(255, 255, 255, 0.95);
    }

    .field-wrapper:focus-within::before {
        opacity: 1;
        background: linear-gradient(135deg, 
            rgba(16, 185, 129, 0.08) 0%, 
            rgba(52, 211, 153, 0.05) 100%);
    }

    /* ===== FIELD ICON & INPUT ULTRA PREMIUM ===== */
    .field-icon {
        position: absolute;
        left: 1.25rem;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text-muted);
        font-size: 1.2rem;
        z-index: 2;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 24px;
        height: 24px;
    }

    .field-wrapper:focus-within .field-icon {
        color: var(--primary);
        transform: translateY(-50%) scale(1.1);
        text-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
    }

    .field-wrapper:hover .field-icon {
        color: var(--primary);
        transform: translateY(-50%) scale(1.05);
    }

    .field-input {
        width: 100%;
        padding: 1.25rem 4rem 1.25rem 3.5rem;
        border: none;
        background: transparent;
        font-size: 1.1rem;
        color: var(--text-primary);
        outline: none;
        font-family: inherit;
        position: relative;
        z-index: 5;
        pointer-events: auto;
        font-weight: 500;
        line-height: 1.5;
        transition: all 0.3s ease;
    }
    
    /* Padding especial para campos de senha */
    #password1, #password2 {
        padding-right: 4.5rem;
    }

    .field-input::placeholder {
        color: var(--text-light);
        font-weight: 400;
        transition: all 0.3s ease;
    }

    .field-input:focus::placeholder {
        color: transparent;
        transform: translateY(-20px);
    }

    .field-input:focus {
        font-weight: 600;
        color: var(--text-primary);
    }

.field-action {
    position: absolute;
    right: 1rem;
    top: 50%;
    transform: translateY(-50%);
    background: none;
    border: none;
    color: var(--text-muted);
    cursor: pointer;
    padding: 0.5rem;
    border-radius: var(--radius-sm);
    transition: all var(--transition-base);
    z-index: 100;
    width: 40px;
    height: 40px;
    display: flex !important;
    align-items: center;
    justify-content: center;
    font-size: 16px;
    pointer-events: auto !important;
    user-select: none;
    -webkit-user-select: none;
    visibility: visible !important;
    opacity: 1 !important;
}

.field-action:hover {
    color: var(--primary);
    background: var(--emerald-50);
    transform: translateY(-50%) scale(1.1);
    box-shadow: 0 2px 8px rgba(16, 185, 129, 0.15);
}

.field-action:active {
    transform: translateY(-50%) scale(0.95);
    box-shadow: 0 1px 4px rgba(16, 185, 129, 0.2);
}

.field-action i {
    pointer-events: none;
    transition: all 0.2s ease;
}

/* Estados específicos para campos de senha */
.field-action.password-visible {
    color: var(--primary);
    background: rgba(16, 185, 129, 0.1);
}

.field-action.password-visible:hover {
    background: rgba(16, 185, 129, 0.15);
}

/* Estilos específicos para mobile */
@media (max-width: 768px) {
    .field-action {
        width: 44px;
        height: 44px;
        right: 0.5rem;
        font-size: 18px;
    }
    
    .field-action:hover {
        transform: translateY(-50%) scale(1.05);
    }
}

/* Estados de foco para acessibilidade */
.field-action:focus {
    outline: 2px solid var(--primary);
    outline-offset: 2px;
    box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.1);
}

/* Debug: Mostrar limites dos botões de ação (remover em produção) */
.field-action {
    /* border: 1px dashed rgba(255, 0, 0, 0.3) !important; */
}

.field-status {
    position: absolute;
    right: 3rem;
    top: 50%;
    transform: translateY(-50%);
    font-size: 1rem;
    z-index: 2;
}

.field-border {
    position: absolute;
    inset: 0;
    border-radius: var(--radius-lg);
    border: 2px solid transparent;
    background: linear-gradient(var(--bg-primary), var(--bg-primary)) padding-box,
                linear-gradient(135deg, var(--primary), var(--primary-light)) border-box;
    opacity: 0;
    transition: opacity var(--transition-base);
    pointer-events: none;
    z-index: -1;
}

.field-focus {
    position: absolute;
    inset: -2px;
    border-radius: var(--radius-lg);
    background: linear-gradient(135deg, var(--primary), var(--primary-light));
    opacity: 0;
    transition: opacity var(--transition-base);
    pointer-events: none;
    z-index: -1;
}

.field-input:focus ~ .field-focus {
    opacity: 0.1;
}

.field-feedback {
    margin-top: 0.5rem;
    font-size: 0.875rem;
    font-weight: 500;
    min-height: 1.25rem;
}

.field-feedback.error {
    color: var(--error);
}

.field-feedback.success {
    color: var(--success);
}

.field-hint {
    margin-top: 0.25rem;
    font-size: 0.8rem;
    color: var(--text-muted);
}

/* ===== PASSWORD STRENGTH ===== */
.password-strength {
    margin-top: 1rem;
    padding: 1rem;
    background: var(--bg-secondary);
    border-radius: var(--radius-lg);
    border: 1px solid var(--border-light);
}

.strength-header {
    display: flex;
    justify-content: between;
    align-items: center;
    margin-bottom: 0.75rem;
}

.strength-label {
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--text-secondary);
}

.strength-text {
    font-size: 0.85rem;
    color: var(--text-muted);
}

.strength-meter {
    height: 6px;
    background: var(--border-light);
    border-radius: var(--radius-full);
    overflow: hidden;
}

.strength-fill {
    height: 100%;
    border-radius: var(--radius-full);
    transition: all var(--transition-base);
    width: 0%;
}

.strength-fill.weak {
    width: 20%;
    background: var(--error);
}

.strength-fill.fair {
    width: 40%;
    background: var(--warning);
}

.strength-fill.good {
    width: 60%;
    background: var(--info);
}

.strength-fill.strong {
    width: 80%;
    background: var(--success);
}

.strength-fill.very-strong {
    width: 100%;
    background: linear-gradient(90deg, var(--success), var(--primary));
}

/* ===== SECURITY GUIDELINES ===== */
.security-guidelines {
    margin-top: 2rem;
    padding: 1.5rem;
    background: var(--bg-secondary);
    border-radius: var(--radius-xl);
    border: 1px solid var(--border-light);
}

.guidelines-header {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 1rem;
}

.guidelines-icon {
    width: 30px;
    height: 30px;
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 0.9rem;
}

.guidelines-header h3 {
    font-size: 1rem;
    font-weight: 600;
    color: var(--text-primary);
}

.guidelines-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 0.75rem;
}

.guideline-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem;
    border-radius: var(--radius-md);
    transition: all var(--transition-base);
}

.guideline-item.valid {
    background: var(--emerald-50);
    color: var(--success);
}

.guideline-item.valid .guideline-icon i {
    transform: rotate(0deg);
}

.guideline-icon {
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.8rem;
    color: var(--text-light);
}

.guideline-item.valid .guideline-icon {
    color: var(--success);
}

.guideline-item span {
    font-size: 0.85rem;
    font-weight: 500;
    color: var(--text-secondary);
}

.guideline-item.valid span {
    color: var(--success);
}

/* ===== PERMISSIONS PREMIUM ===== */
.permissions-premium {
    display: grid;
    gap: 1.5rem;
}

.permission-card {
    background: var(--bg-primary);
    border: 2px solid var(--border);
    border-radius: var(--radius-xl);
    padding: 1.5rem;
    transition: all var(--transition-base);
}

.permission-card:hover {
    border-color: var(--primary);
    box-shadow: var(--shadow-md);
}

.permission-header {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
    margin-bottom: 1rem;
}

.permission-icon {
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
    border-radius: var(--radius-lg);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.25rem;
    flex-shrink: 0;
}

.permission-icon.admin {
    background: linear-gradient(135deg, var(--warning) 0%, #f97316 100%);
}

.permission-info h3 {
    font-size: 1.125rem;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 0.5rem;
}

.permission-info p {
    font-size: 0.9rem;
    color: var(--text-secondary);
    line-height: 1.5;
}

.permission-control {
    display: flex;
    justify-content: flex-end;
}

/* ===== TOGGLE PREMIUM ===== */
.toggle-premium {
    position: relative;
}

.toggle-input {
    position: absolute;
    opacity: 0;
    pointer-events: none;
}

.toggle-label {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    cursor: pointer;
    user-select: none;
}

.toggle-track {
    width: 60px;
    height: 30px;
    background: var(--border-dark);
    border-radius: var(--radius-full);
    position: relative;
    transition: all var(--transition-base);
}

.toggle-input:checked + .toggle-label .toggle-track {
    background: var(--primary);
}

.toggle-thumb {
    width: 26px;
    height: 26px;
    background: white;
    border-radius: 50%;
    position: absolute;
    top: 2px;
    left: 2px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.7rem;
    color: var(--text-muted);
    transition: all var(--transition-base);
    box-shadow: var(--shadow-sm);
}

.toggle-input:checked + .toggle-label .toggle-thumb {
    transform: translateX(30px);
    color: var(--primary);
}

.toggle-text {
    font-size: 0.9rem;
    font-weight: 500;
    color: var(--text-secondary);
}

.toggle-input:checked + .toggle-label .toggle-text {
    color: var(--primary);
}

/* ===== USER PREVIEW PREMIUM ===== */
.user-preview-premium {
    margin-top: 2rem;
    padding: 1.5rem;
    background: var(--bg-secondary);
    border-radius: var(--radius-xl);
    border: 1px solid var(--border-light);
}

.preview-header {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 1.5rem;
}

.preview-icon {
    width: 40px;
    height: 40px;
    background: linear-gradient(135deg, var(--info) 0%, #2563eb 100%);
    border-radius: var(--radius-lg);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1rem;
}

.preview-header h3 {
    font-size: 1.125rem;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 0.25rem;
}

.preview-header p {
    font-size: 0.875rem;
    color: var(--text-secondary);
}

.preview-card {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
    background: var(--bg-primary);
    border-radius: var(--radius-lg);
    border: 1px solid var(--border);
}

.preview-avatar {
    position: relative;
}

.avatar-circle {
    width: 60px;
    height: 60px;
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.5rem;
}

.avatar-status {
    position: absolute;
    bottom: 2px;
    right: 2px;
    width: 16px;
    height: 16px;
    background: var(--success);
    border: 2px solid var(--bg-primary);
    border-radius: 50%;
}

.preview-details {
    flex: 1;
}

.preview-name {
    font-size: 1.125rem;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 0.25rem;
}

.preview-username {
    font-size: 0.9rem;
    color: var(--text-muted);
    margin-bottom: 0.25rem;
}

.preview-email {
    font-size: 0.85rem;
    color: var(--text-secondary);
    margin-bottom: 0.75rem;
}

.preview-badges {
    display: flex;
    gap: 0.5rem;
}

.preview-badge {
    padding: 0.25rem 0.75rem;
    border-radius: var(--radius-full);
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

.preview-badge.status {
    background: var(--emerald-100);
    color: var(--emerald-700);
}

.preview-badge.role {
    background: linear-gradient(135deg, #fef3c7, #fde68a);
    color: #92400e;
}

/* ===== NAVIGATION ULTRA PREMIUM ===== */
.navigation-premium {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 3rem 2rem;
    margin-top: 4rem;
    background: linear-gradient(135deg, 
        rgba(16, 185, 129, 0.03) 0%, 
        rgba(52, 211, 153, 0.02) 100%);
    border-radius: 24px;
    border: 1px solid rgba(16, 185, 129, 0.1);
    position: relative;
    overflow: hidden;
    backdrop-filter: blur(10px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
}

.navigation-premium::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, 
        transparent 0%, 
        rgba(16, 185, 129, 0.05) 50%, 
        transparent 100%);
    animation: navShine 4s ease-in-out infinite;
}

@keyframes navShine {
    0% { left: -100%; }
    100% { left: 100%; }
}

.nav-btn {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1.25rem 2rem;
    border: none;
    border-radius: 18px;
    font-size: 1.1rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.23, 1, 0.320, 1);
    text-decoration: none;
    position: relative;
    overflow: hidden;
    z-index: 2;
    min-width: 140px;
    justify-content: center;
}

.nav-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none !important;
}

.nav-btn::before {
    content: '';
    position: absolute;
    inset: 0;
    background: inherit;
    z-index: -1;
    transition: all 0.4s ease;
}

.nav-btn-secondary {
    background: linear-gradient(135deg, 
        rgba(255, 255, 255, 0.9) 0%, 
        rgba(248, 250, 252, 0.8) 100%);
    color: var(--text-secondary);
    border: 2px solid var(--border);
    backdrop-filter: blur(10px);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
}

.nav-btn-secondary:hover:not(:disabled) {
    background: linear-gradient(135deg, 
        rgba(255, 255, 255, 0.95) 0%, 
        rgba(241, 245, 249, 0.9) 100%);
    border-color: var(--primary);
    color: var(--primary);
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
}

.nav-btn-primary {
    background: linear-gradient(135deg, 
        var(--primary) 0%, 
        var(--primary-light) 50%,
        #34d399 100%);
    color: white;
    border: 2px solid transparent;
    box-shadow: 
        0 8px 25px rgba(16, 185, 129, 0.25),
        0 4px 15px rgba(16, 185, 129, 0.15);
    position: relative;
}

.nav-btn-primary::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, 
        rgba(255, 255, 255, 0.2) 0%, 
        transparent 50%,
        rgba(255, 255, 255, 0.1) 100%);
    border-radius: 16px;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.nav-btn-primary:hover:not(:disabled) {
    background: linear-gradient(135deg, 
        var(--primary-light) 0%, 
        #34d399 50%,
        var(--primary) 100%);
    transform: translateY(-4px);
    box-shadow: 
        0 15px 35px rgba(16, 185, 129, 0.35),
        0 8px 25px rgba(16, 185, 129, 0.25);
}

.nav-btn-primary:hover::after {
    opacity: 1;
}

.nav-btn-success {
    background: linear-gradient(135deg, 
        var(--success) 0%, 
        #10b981 50%,
        #059669 100%);
    color: white;
    border: 2px solid transparent;
    box-shadow: 
        0 8px 25px rgba(16, 185, 129, 0.3),
        0 4px 15px rgba(16, 185, 129, 0.2);
    position: relative;
}

.nav-btn-success::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, 
        rgba(255, 255, 255, 0.25) 0%, 
        transparent 50%,
        rgba(255, 255, 255, 0.15) 100%);
    border-radius: 16px;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.nav-btn-success:hover:not(:disabled) {
    background: linear-gradient(135deg, 
        #10b981 0%, 
        #059669 50%,
        var(--success) 100%);
    transform: translateY(-4px);
    box-shadow: 
        0 15px 35px rgba(16, 185, 129, 0.4),
        0 8px 25px rgba(16, 185, 129, 0.3);
}

.nav-btn-success:hover::after {
    opacity: 1;
}

.btn-icon {
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1rem;
    transition: all 0.3s ease;
}

.nav-btn:hover .btn-icon {
    transform: scale(1.1);
}

.btn-spinner {
    animation: spin 1s linear infinite;
}

@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

.nav-center {
    display: flex;
    align-items: center;
    gap: 1.5rem;
    background: rgba(255, 255, 255, 0.7);
    backdrop-filter: blur(10px);
    padding: 1rem 2rem;
    border-radius: 16px;
    border: 1px solid rgba(255, 255, 255, 0.3);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
}

.step-counter {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-size: 1rem;
    color: var(--text-secondary);
    font-weight: 600;
}

.current-step {
    color: var(--primary);
    font-weight: 800;
    font-size: 1.4rem;
    text-shadow: 0 2px 4px rgba(16, 185, 129, 0.3);
}

.step-separator {
    color: var(--text-light);
    margin: 0 0.5rem;
    font-size: 1.1rem;
    font-weight: 500;
}

.total-steps {
    color: var(--text-muted);
    font-weight: 700;
    font-size: 1.1rem;
}

/* ===== SIDEBAR PREMIUM ===== */
.sidebar-premium {
    display: flex;
    flex-direction: column;
    gap: 2rem;
    position: sticky;
    top: 2rem;
}

/* ===== ASSISTENTE VIRTUAL COLAPSÁVEL ===== */
.assistant-collapsible {
    margin-bottom: 2rem;
    position: relative;
}

/* Estado Colapsado */
.assistant-collapsed {
    background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
    backdrop-filter: blur(20px);
    border: 2px solid rgba(16, 185, 129, 0.2);
    border-radius: var(--radius-2xl);
    padding: 1.5rem;
    cursor: pointer;
    transition: all var(--transition-base);
    position: relative;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    box-shadow: var(--shadow-md);
    min-height: 80px;
}

.assistant-collapsed:hover {
    border-color: var(--primary);
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
}

.assistant-collapsed:hover .pulse-ring-assistant {
    animation: pulse-ring-assistant 1.5s ease-in-out infinite;
}

.collapsed-icon-assistant {
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, var(--info) 0%, #3b82f6 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.25rem;
    position: relative;
    box-shadow: var(--shadow-md);
    transition: all var(--transition-base);
}

.pulse-ring-assistant {
    position: absolute;
    inset: -8px;
    border: 2px solid var(--info);
    border-radius: 50%;
    opacity: 0;
    animation: pulse-ring-assistant 2s ease-in-out infinite;
}

@keyframes pulse-ring-assistant {
    0% {
        transform: scale(0.8);
        opacity: 1;
    }
    100% {
        transform: scale(1.4);
        opacity: 0;
    }
}

.collapsed-label-assistant {
    text-align: left;
}

.collapsed-label-assistant span {
    display: block;
    font-size: 1.125rem;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 0.25rem;
}

.collapsed-label-assistant small {
    font-size: 0.875rem;
    color: var(--text-muted);
}

/* Estado Expandido */
.assistant-expanded {
    background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(16, 185, 129, 0.2);
    border-radius: var(--radius-2xl);
    padding: 2rem;
    box-shadow: var(--shadow-xl);
    position: relative;
    overflow: hidden;
    animation: expandInAssistant 0.3s ease-out;
}

@keyframes expandInAssistant {
    from {
        opacity: 0;
        transform: scale(0.95) translateY(-10px);
    }
    to {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

.assistant-expanded::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: linear-gradient(90deg, var(--info), var(--primary), var(--info));
    animation: shimmer 3s linear infinite;
}

.assistant-expanded-header {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    margin-bottom: 1.5rem;
}

.header-content-assistant {
    text-align: center;
    flex: 1;
}

.help-icon-container-expanded {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 0.25rem;
    margin-bottom: 1rem;
}

.help-avatar-expanded {
    width: 48px;
    height: 48px;
    background: linear-gradient(135deg, var(--info) 0%, #3b82f6 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.15rem;
    color: white;
    position: relative;
    box-shadow: var(--shadow-md);
    transition: all var(--transition-base);
    margin-bottom: 0.125rem;
}

.help-avatar-expanded:hover {
    transform: scale(1.05);
    box-shadow: var(--shadow-lg);
}

/* Regra específica para garantir layout vertical perfeito na sidebar */
.assistant-expanded .help-icon-container-expanded {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
    gap: 0.25rem !important;
}

.assistant-expanded .help-status-expanded {
    margin-top: 0.125rem !important;
    text-align: center !important;
}

/* Força o texto Online na sidebar a ficar bem posicionado */
.assistant-expanded .help-status-expanded span {
    display: block !important;
    text-align: center !important;
    font-size: 0.65rem !important;
    margin-top: 0 !important;
}

.avatar-glow-expanded {
    position: absolute;
    inset: -4px;
    background: linear-gradient(135deg, var(--info), var(--primary-light));
    border-radius: 50%;
    opacity: 0.3;
    animation: pulse 2s ease-in-out infinite;
    z-index: -1;
}

.help-status-expanded {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.25rem;
    padding: 0;
    background: transparent;
    border: none;
    border-radius: 0;
    font-size: 0.65rem;
    font-weight: 400;
    color: var(--emerald-600);
    margin-top: 0;
    opacity: 0.75;
    letter-spacing: 0.02em;
}

.status-dot-expanded {
    width: 5px;
    height: 5px;
    background: #10b981;
    border-radius: 50%;
    animation: pulse 2s ease-in-out infinite;
    flex-shrink: 0;
    box-shadow: 0 0 0 1px rgba(16, 185, 129, 0.3);
}

.help-status-expanded span {
    font-size: 0.65rem;
    font-weight: 400;
    color: var(--emerald-600);
    opacity: 0.75;
    letter-spacing: 0.02em;
    line-height: 1;
}

.header-text-assistant h3 {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 0.5rem;
}

.header-text-assistant p {
    color: var(--text-secondary);
    line-height: 1.5;
    font-size: 0.9rem;
}

.close-assistant {
    width: 40px;
    height: 40px;
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-muted);
    font-size: 1rem;
    cursor: pointer;
    transition: all var(--transition-base);
    flex-shrink: 0;
}

.close-assistant:hover {
    background: var(--error);
    color: white;
    border-color: var(--error);
    transform: scale(1.1);
}

.help-features-expanded {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    margin: 1.5rem 0;
}

.feature-item-expanded {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem;
    background: var(--emerald-50);
    border-radius: var(--radius-lg);
    transition: all var(--transition-base);
}

.feature-item-expanded:hover {
    background: var(--emerald-100);
    transform: translateX(4px);
}

.feature-icon-expanded {
    width: 32px;
    height: 32px;
    background: var(--info);
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 0.875rem;
    flex-shrink: 0;
}

.feature-item-expanded span {
    font-size: 0.9rem;
    font-weight: 500;
    color: var(--text-primary);
}

.help-btn-expanded {
    width: 100%;
    background: linear-gradient(135deg, var(--info) 0%, #3b82f6 100%);
    border: none;
    border-radius: var(--radius-xl);
    padding: 1rem;
    display: flex;
    align-items: center;
    justify-content: space-between;
    cursor: pointer;
    transition: all var(--transition-base);
    position: relative;
    overflow: hidden;
    box-shadow: var(--shadow-lg);
}

.help-btn-expanded:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-xl);
}

.btn-content-expanded {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    color: white;
    font-weight: 600;
}

.btn-content-expanded i {
    font-size: 1.125rem;
}

.btn-sparkle-expanded {
    color: white;
    opacity: 0.7;
    animation: sparkle 2s ease-in-out infinite;
}

@keyframes bounce {
    0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
    40% { transform: translateY(-4px); }
    60% { transform: translateY(-2px); }
}

@keyframes sparkle {
    0%, 100% { opacity: 0.7; transform: scale(1); }
    50% { opacity: 1; transform: scale(1.2); }
}

/* ===== AÇÕES RÁPIDAS PREMIUM ===== */
.actions-card-premium {
    background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(52, 211, 153, 0.2);
    border-radius: var(--radius-2xl);
    padding: 2rem;
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    position: relative;
    overflow: hidden;
}

.actions-card-premium::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: linear-gradient(90deg, var(--primary-light), var(--primary), var(--primary-light));
    animation: shimmer 3s linear infinite;
}

.actions-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.header-icon {
    width: 40px;
    height: 40px;
    background: linear-gradient(135deg, var(--warning) 0%, #f97316 100%);
    border-radius: var(--radius-lg);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.125rem;
    animation: pulse 2s ease-in-out infinite;
}

.actions-header h3 {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--text-primary);
    margin: 0;
}

.actions-header p {
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin: 0.25rem 0 0 0;
}

.actions-grid {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.action-item-premium {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
    background: var(--bg-primary);
    border: 2px solid var(--border-light);
    border-radius: var(--radius-xl);
    text-decoration: none;
    color: inherit;
    cursor: pointer;
    transition: all var(--transition-base);
    position: relative;
    overflow: hidden;
}

.action-item-premium:hover {
    border-color: var(--primary);
    background: var(--emerald-50);
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
}

.action-icon-wrapper {
    position: relative;
    flex-shrink: 0;
}

.action-icon {
    width: 48px;
    height: 48px;
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
    border-radius: var(--radius-lg);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.125rem;
    transition: all var(--transition-base);
}

.action-glow {
    position: absolute;
    inset: -4px;
    background: linear-gradient(135deg, var(--primary), var(--primary-light));
    border-radius: var(--radius-lg);
    opacity: 0;
    transition: opacity var(--transition-base);
    z-index: -1;
}

.action-item-premium:hover .action-glow {
    opacity: 0.3;
    animation: pulse 1s ease-in-out infinite;
}

.action-details {
    flex: 1;
}

.action-details h4 {
    font-size: 1rem;
    font-weight: 600;
    color: var(--text-primary);
    margin: 0 0 0.25rem 0;
}

.action-details p {
    font-size: 0.875rem;
    color: var(--text-secondary);
    margin: 0 0 0.5rem 0;
}

.action-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.25rem 0.5rem;
    background: var(--emerald-100);
    color: var(--emerald-700);
    border-radius: var(--radius-full);
    font-size: 0.75rem;
    font-weight: 500;
}

.action-arrow {
    color: var(--text-muted);
    font-size: 1rem;
    transition: all var(--transition-base);
}

.action-item-premium:hover .action-arrow {
    color: var(--primary);
    transform: translateX(4px);
}

/* ===== ESTATÍSTICAS PREMIUM ===== */
.stats-card-premium {
    background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(16, 185, 129, 0.2);
    border-radius: var(--radius-2xl);
    padding: 2rem;
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    position: relative;
    overflow: hidden;
}

.stats-card-premium::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: linear-gradient(90deg, var(--info), var(--primary), var(--info));
    animation: shimmer 4s linear infinite;
}

.stats-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1.5rem;
}

.header-main {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.stats-icon {
    width: 48px;
    height: 48px;
    background: linear-gradient(135deg, var(--info) 0%, #3b82f6 100%);
    border-radius: var(--radius-lg);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.25rem;
    animation: pulse 2s ease-in-out infinite;
}

.header-content h3 {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--text-primary);
    margin: 0;
}

.header-content p {
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin: 0.25rem 0 0 0;
}

.refresh-indicator {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    background: var(--emerald-50);
    border: 1px solid var(--emerald-200);
    border-radius: var(--radius-full);
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--emerald-700);
}

.refresh-dot {
    width: 8px;
    height: 8px;
    background: var(--emerald-500);
    border-radius: 50%;
    animation: pulse 1.5s ease-in-out infinite;
}

.stats-grid-premium {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.stat-card-item {
    background: var(--bg-primary);
    border: 2px solid var(--border-light);
    border-radius: var(--radius-xl);
    padding: 1.5rem;
    position: relative;
    overflow: hidden;
    transition: all var(--transition-base);
}

.stat-card-item:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
}

.stat-card-item.total {
    border-color: var(--primary);
    background: linear-gradient(135deg, var(--emerald-50) 0%, #ffffff 100%);
}

.stat-card-item.active {
    border-color: var(--success);
    background: linear-gradient(135deg, var(--emerald-50) 0%, #ffffff 100%);
}

.stat-card-item.admin {
    border-color: var(--warning);
    background: linear-gradient(135deg, #fef3c7 0%, #ffffff 100%);
}

.stat-card-item.recent {
    border-color: var(--info);
    background: linear-gradient(135deg, #eff6ff 0%, #ffffff 100%);
}

.stat-content {
    position: relative;
    z-index: 2;
}

.stat-header-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1rem;
}

.stat-icon-item {
    width: 40px;
    height: 40px;
    border-radius: var(--radius-lg);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.125rem;
}

.stat-card-item.total .stat-icon-item {
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
}

.stat-card-item.active .stat-icon-item {
    background: linear-gradient(135deg, var(--success) 0%, var(--emerald-600) 100%);
}

.stat-card-item.admin .stat-icon-item {
    background: linear-gradient(135deg, var(--warning) 0%, #f97316 100%);
}

.stat-card-item.recent .stat-icon-item {
    background: linear-gradient(135deg, var(--info) 0%, #3b82f6 100%);
}

.stat-trend {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.75rem;
}

.stat-trend.positive {
    background: var(--emerald-100);
    color: var(--emerald-600);
}

.stat-trend.stable {
    background: var(--gray-100);
    color: var(--gray-600);
}

.stat-number-large {
    font-size: 2rem;
    font-weight: 700;
    color: var(--text-primary);
    line-height: 1;
    margin-bottom: 0.5rem;
}

.stat-label-item {
    font-size: 1rem;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 0.25rem;
}

.stat-description {
    font-size: 0.875rem;
    color: var(--text-secondary);
    line-height: 1.4;
}

.stat-animation {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: linear-gradient(90deg, transparent, var(--primary), transparent);
    animation: shimmer 3s linear infinite;
    opacity: 0.3;
}

.stats-footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding-top: 1rem;
    border-top: 1px solid var(--border-light);
    font-size: 0.875rem;
    color: var(--text-muted);
}

.last-update,
.auto-refresh {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.refresh-icon {
    animation: spin 2s linear infinite;
}

@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

@keyframes shimmer {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
}

/* ===== AÇÕES RÁPIDAS COLAPSÁVEIS ===== */
.quick-actions-collapsible {
    margin: 3rem 0;
    position: relative;
}

/* Estado Colapsado */
.actions-collapsed {
    background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
    backdrop-filter: blur(20px);
    border: 2px solid rgba(16, 185, 129, 0.2);
    border-radius: var(--radius-2xl);
    padding: 1.5rem;
    cursor: pointer;
    transition: all var(--transition-base);
    position: relative;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    box-shadow: var(--shadow-md);
    min-height: 80px;
}

.actions-collapsed:hover {
    border-color: var(--primary);
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
}

.actions-collapsed:hover .pulse-ring {
    animation: pulse-ring 1.5s ease-in-out infinite;
}

.collapsed-icon {
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.25rem;
    position: relative;
    box-shadow: var(--shadow-md);
    transition: all var(--transition-base);
}

.pulse-ring {
    position: absolute;
    inset: -8px;
    border: 2px solid var(--primary);
    border-radius: 50%;
    opacity: 0;
    animation: pulse-ring 2s ease-in-out infinite;
}

@keyframes pulse-ring {
    0% {
        transform: scale(0.8);
        opacity: 1;
    }
    100% {
        transform: scale(1.4);
        opacity: 0;
    }
}

.collapsed-label {
    text-align: left;
}

.collapsed-label span {
    display: block;
    font-size: 1.125rem;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 0.25rem;
}

.collapsed-label small {
    font-size: 0.875rem;
    color: var(--text-muted);
}

/* Estado Expandido */
.actions-expanded {
    background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(16, 185, 129, 0.2);
    border-radius: var(--radius-2xl);
    padding: 2rem;
    box-shadow: var(--shadow-xl);
    position: relative;
    overflow: hidden;
    animation: expandIn 0.3s ease-out;
}

@keyframes expandIn {
    from {
        opacity: 0;
        transform: scale(0.95) translateY(-10px);
    }
    to {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

.actions-expanded::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: linear-gradient(90deg, var(--primary), var(--primary-light), var(--primary));
    animation: shimmer 3s linear infinite;
}

.actions-expanded-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 2rem;
}

.header-content {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.header-icon-expanded {
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.25rem;
    box-shadow: var(--shadow-md);
}

.header-text h3 {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--text-primary);
    margin: 0 0 0.25rem 0;
    background: linear-gradient(135deg, var(--text-primary) 0%, var(--primary) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.header-text p {
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin: 0;
}

.close-actions {
    width: 40px;
    height: 40px;
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-muted);
    font-size: 1rem;
    cursor: pointer;
    transition: all var(--transition-base);
}

.close-actions:hover {
    background: var(--error);
    color: white;
    border-color: var(--error);
    transform: scale(1.1);
}

.actions-expanded-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
    align-items: stretch;
    justify-content: center;
}

/* Grid para ação única */
.actions-expanded-grid:has(.single-action) {
    display: flex;
    justify-content: center;
    align-items: center;
}

.action-card-expanded {
    background: var(--bg-primary);
    border: 2px solid var(--border-light);
    border-radius: var(--radius-2xl);
    padding: 2rem;
    text-decoration: none;
    color: inherit;
    cursor: pointer;
    transition: all var(--transition-base);
    position: relative;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    min-height: 220px;
}

.action-card-expanded:hover {
    border-color: var(--primary);
    transform: translateY(-8px);
    box-shadow: var(--shadow-2xl);
}

.action-card-expanded:hover .icon-glow-expanded {
    opacity: 0.8;
    transform: scale(1.2);
}

.action-card-expanded:hover .action-hover-effect-expanded {
    opacity: 1;
    transform: scale(1);
}

.action-icon-expanded {
    width: 80px;
    height: 80px;
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
    border-radius: var(--radius-2xl);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 2rem;
    margin-bottom: 1.5rem;
    position: relative;
    box-shadow: var(--shadow-lg);
    transition: all var(--transition-base);
}

.icon-glow-expanded {
    position: absolute;
    inset: -8px;
    background: linear-gradient(135deg, var(--primary), var(--primary-light));
    border-radius: var(--radius-2xl);
    opacity: 0;
    transition: all var(--transition-base);
    z-index: -1;
}

.action-content-expanded {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
}

.action-content-expanded h4 {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--text-primary);
    margin: 0 0 0.75rem 0;
}

.action-content-expanded p {
    font-size: 1rem;
    color: var(--text-secondary);
    line-height: 1.5;
    margin: 0 0 1rem 0;
}

.action-badge-expanded {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    background: var(--emerald-100);
    color: var(--emerald-700);
    border-radius: var(--radius-full);
    font-size: 0.875rem;
    font-weight: 600;
    border: 1px solid var(--emerald-200);
}

.action-hover-effect-expanded {
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, rgba(16, 185, 129, 0.05) 0%, rgba(52, 211, 153, 0.05) 100%);
    border-radius: var(--radius-2xl);
    opacity: 0;
    transform: scale(0.8);
    transition: all var(--transition-base);
}

/* Variações de cores para diferentes cards */
.action-card-expanded:nth-child(1) .action-icon-expanded {
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
}

.action-card-expanded:nth-child(1) .action-badge-expanded {
    background: var(--emerald-100);
    color: var(--emerald-700);
    border-color: var(--emerald-200);
}

.action-card-expanded:nth-child(2) .action-icon-expanded {
    background: linear-gradient(135deg, var(--info) 0%, #3b82f6 100%);
}

.action-card-expanded:nth-child(2) .action-badge-expanded {
    background: #eff6ff;
    color: #1d4ed8;
    border-color: #bfdbfe;
}

/* Estilo para ação única */
.action-card-expanded.single-action {
    max-width: 400px;
    margin: 0 auto;
    min-height: 250px;
    background: linear-gradient(135deg, rgba(16, 185, 129, 0.02) 0%, rgba(255, 255, 255, 0.98) 100%);
    border: 2px solid var(--emerald-200);
    box-shadow: 0 20px 40px rgba(16, 185, 129, 0.1);
}

.action-card-expanded.single-action:hover {
    border-color: var(--emerald-400);
    box-shadow: 0 25px 50px rgba(16, 185, 129, 0.15);
    transform: translateY(-10px) scale(1.02);
}

.action-card-expanded.single-action .action-icon-expanded {
    width: 90px;
    height: 90px;
    font-size: 2.2rem;
    background: linear-gradient(135deg, var(--emerald-500) 0%, var(--emerald-600) 100%);
    box-shadow: 0 15px 30px rgba(16, 185, 129, 0.3);
}

.action-card-expanded.single-action .action-content-expanded h4 {
    font-size: 1.4rem;
    margin-bottom: 1rem;
}

.action-card-expanded.single-action .action-content-expanded p {
    font-size: 1.1rem;
    margin-bottom: 1.5rem;
}

.action-card-expanded.single-action .action-badge-expanded {
    background: var(--emerald-100);
    color: var(--emerald-800);
    border-color: var(--emerald-300);
    padding: 0.75rem 1.25rem;
    font-size: 0.95rem;
}

/* ===== RESPONSIVIDADE PREMIUM ===== */
@media (max-width: 1024px) {
    .stats-grid-premium {
        grid-template-columns: 1fr;
    }
    
    .content-wrapper {
        grid-template-columns: 1fr;
        gap: 2rem;
    }
    
    .sidebar-premium {
        position: static;
        order: -1;
    }
    
    /* Hero Section Ultra Premium - Tablet */
    .hero-ultra-premium {
        min-height: 400px;
        margin-bottom: 2rem;
    }
    
    .hero-content {
        padding: 2rem 1.5rem;
    }
    
    .hero-title-ultra {
        font-size: clamp(2rem, 4vw, 3rem);
    }
    
    .stats-grid-ultra {
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1.25rem;
    }
    
    .stat-card-ultra {
        padding: 1.25rem;
    }
    
    .stat-icon-ultra {
        width: 50px;
        height: 50px;
        font-size: 1.25rem;
    }
    
    .number-value {
        font-size: 2rem;
    }
    
    .dashboard-header {
        flex-direction: column;
        gap: 1rem;
        align-items: center;
    }
    
    .action-btn-ultra {
        padding: 0.875rem 1.5rem;
        font-size: 0.9rem;
    }
    
    /* Responsividade para ações colapsáveis - tablet */
    .actions-expanded-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 1.5rem;
    }
    
    .action-card-expanded {
        min-height: 200px;
    }
    
    .collapsed-icon {
        width: 45px;
        height: 45px;
        font-size: 1.125rem;
    }
    
    .collapsed-label span {
        font-size: 1rem;
    }
    
    /* Responsividade para assistente virtual - tablet */
    .collapsed-icon-assistant {
        width: 45px;
        height: 45px;
        font-size: 1.125rem;
    }
    
    .collapsed-label-assistant span {
        font-size: 1rem;
    }
    
    .help-avatar-expanded {
        width: 50px;
        height: 50px;
        font-size: 1.25rem;
    }
}

@media (max-width: 920px) and (min-width: 769px) {
    /* Responsividade para ações colapsáveis - telas médias */
    .actions-expanded-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 1.75rem;
    }
    
    .action-card-expanded {
        min-height: 210px;
        padding: 1.75rem;
    }
    
    .actions-collapsed {
        padding: 1.25rem;
        min-height: 70px;
        gap: 0.75rem;
    }
    
    /* Responsividade para assistente virtual - telas médias */
    .assistant-collapsed {
        padding: 1.25rem;
        min-height: 70px;
        gap: 0.75rem;
    }
    
    .assistant-expanded {
        padding: 1.75rem;
    }
}

@media (max-width: 768px) {
    /* Hero Section Ultra Premium - Mobile */
    .hero-ultra-premium {
        min-height: 350px;
        margin-bottom: 1.5rem;
        border-radius: var(--radius-xl);
    }
    
    .hero-content {
        padding: 2rem 1rem;
    }
    
    .hero-badge-premium {
        padding: 0.625rem 1.25rem;
        font-size: 0.8rem;
        margin-bottom: 1.5rem;
    }
    
    .badge-icon {
        width: 16px;
        height: 16px;
        font-size: 0.75rem;
    }
    
    .hero-title-section {
        margin-bottom: 2rem;
    }
    
    .hero-title-ultra {
        font-size: clamp(1.875rem, 4vw, 2.5rem);
        margin-bottom: 1rem;
    }
    
    .title-accent {
        width: 60px;
        height: 3px;
    }
    
    .hero-subtitle-ultra {
        font-size: clamp(1rem, 2vw, 1.125rem);
        max-width: 500px;
    }
    
    .stats-dashboard-premium {
        padding: 1.5rem;
        margin-top: 1.5rem;
    }
    
    .dashboard-header {
        flex-direction: column;
        gap: 0.75rem;
        margin-bottom: 1.5rem;
        padding-bottom: 0.75rem;
    }
    
    .dashboard-title {
        font-size: 1.125rem;
    }
    
    .dashboard-title i {
        font-size: 1.25rem;
    }
    
    .stats-grid-ultra {
        grid-template-columns: 1fr;
        gap: 1rem;
        margin-bottom: 1.5rem;
    }
    
    .stat-card-ultra {
        padding: 1rem;
    }
    
    .stat-icon-ultra {
        width: 45px;
        height: 45px;
        font-size: 1.125rem;
    }
    
    .stat-header-ultra {
        margin-bottom: 0.75rem;
    }
    
    .stat-body-ultra {
        margin-bottom: 0.75rem;
    }
    
    .number-value {
        font-size: 1.875rem;
    }
    
    .label-main {
        font-size: 0.9rem;
    }
    
    .label-sub {
        font-size: 0.8rem;
    }
    
    .stat-trend {
        padding: 0.1875rem 0.375rem;
        font-size: 0.6875rem;
    }
    
    .progress-line {
        height: 4px;
    }
    
    .progress-text {
        font-size: 0.6875rem;
    }
    
    .action-btn-ultra {
        padding: 0.75rem 1.25rem;
        font-size: 0.875rem;
        gap: 0.5rem;
    }
    
    .btn-icon-ultra {
        width: 16px;
        height: 16px;
        font-size: 0.875rem;
    }
    
    /* Orbs menores para mobile */
    .hero-orb-1 {
        width: 120px;
        height: 120px;
    }
    
    .hero-orb-2 {
        width: 100px;
        height: 100px;
    }
    
    .hero-orb-3 {
        width: 110px;
        height: 110px;
    }
    
    .help-features {
        gap: 0.5rem;
    }
    
    .feature-item {
        padding: 0.5rem;
    }
    
    .actions-grid {
        gap: 0.75rem;
    }
    
    .action-item-premium {
        padding: 0.75rem;
    }
    
    .stats-card-premium {
        padding: 1.5rem;
    }
    
    .stat-card-item {
        padding: 1rem;
    }
    
    .stat-number-large {
        font-size: 1.5rem;
    }
    
    /* Responsividade para ações colapsáveis - mobile */
    .quick-actions-collapsible {
        margin: 2rem 0;
    }
    
    .actions-collapsed {
        padding: 1rem;
        min-height: 60px;
        gap: 0.75rem;
        flex-direction: column;
        text-align: center;
    }
    
    .collapsed-icon {
        width: 40px;
        height: 40px;
        font-size: 1rem;
        margin-bottom: 0.5rem;
    }
    
    .collapsed-label span {
        font-size: 0.9rem;
    }
    
    .collapsed-label small {
        font-size: 0.75rem;
    }
    
    .actions-expanded {
        padding: 1.5rem;
    }
    
    .actions-expanded-header {
        flex-direction: column;
        gap: 1rem;
        align-items: stretch;
    }
    
    .header-content {
        justify-content: center;
    }
    
    .header-icon-expanded {
        width: 40px;
        height: 40px;
        font-size: 1rem;
    }
    
    .header-text h3 {
        font-size: 1.25rem;
    }
    
    .header-text p {
        font-size: 0.875rem;
    }
    
    .close-actions {
        align-self: center;
    }
    
    .actions-expanded-grid {
        grid-template-columns: 1fr !important;
        gap: 1.5rem;
    }
    
    .actions-expanded-grid:has(.single-action) {
        display: flex;
        justify-content: center;
        align-items: center;
    }
    
    .action-card-expanded {
        padding: 1.5rem;
        min-height: 180px;
    }
    
    .action-card-expanded.single-action {
        max-width: 100%;
        min-height: 200px;
    }
    
    .action-card-expanded.single-action .action-icon-expanded {
        width: 70px;
        height: 70px;
        font-size: 1.8rem;
    }
    
    .action-card-expanded.single-action .action-content-expanded h4 {
        font-size: 1.2rem;
    }
    
    .action-card-expanded.single-action .action-content-expanded p {
        font-size: 1rem;
    }
    
    .action-icon-expanded {
        width: 60px;
        height: 60px;
        font-size: 1.5rem;
        margin-bottom: 1rem;
    }
    
    /* Responsividade para assistente virtual - mobile */
    .assistant-collapsed {
        padding: 1rem;
        min-height: 60px;
        gap: 0.75rem;
        flex-direction: column;
        text-align: center;
    }
    
    .collapsed-icon-assistant {
        width: 40px;
        height: 40px;
        font-size: 1rem;
        margin-bottom: 0.5rem;
    }
    
    .collapsed-label-assistant span {
        font-size: 0.9rem;
    }
    
    .collapsed-label-assistant small {
        font-size: 0.75rem;
    }
    
    .assistant-expanded {
        padding: 1.5rem;
    }
    
    .assistant-expanded-header {
        flex-direction: column;
        gap: 1rem;
        align-items: stretch;
    }
    
    .header-content-assistant {
        justify-content: center;
    }
    
    .help-avatar-expanded {
        width: 45px;
        height: 45px;
        font-size: 1.125rem;
    }
    
    .close-assistant {
        align-self: center;
    }
    
    .help-features-expanded {
        gap: 0.5rem;
    }
    
    .feature-item-expanded {
        padding: 0.5rem;
    }
}

/* ===== RESPONSIVIDADE EXTRA SMALL ===== */
@media (max-width: 480px) {
    /* Hero Section Ultra Premium - Extra Small */
    .hero-ultra-premium {
        min-height: 300px;
        margin-bottom: 1rem;
    }
    
    .hero-content {
        padding: 1.5rem 0.75rem;
    }
    
    .hero-badge-premium {
        padding: 0.5rem 1rem;
        font-size: 0.75rem;
        margin-bottom: 1rem;
    }
    
    .hero-title-ultra {
        font-size: clamp(1.5rem, 5vw, 2rem);
        margin-bottom: 0.75rem;
    }
    
    .title-accent {
        width: 40px;
        height: 2px;
    }
    
    .hero-subtitle-ultra {
        font-size: clamp(0.875rem, 3vw, 1rem);
        max-width: 350px;
    }
    
    .stats-dashboard-premium {
        padding: 1rem;
        margin-top: 1rem;
    }
    
    .dashboard-title {
        font-size: 1rem;
    }
    
    .stats-grid-ultra {
        gap: 0.75rem;
        margin-bottom: 1rem;
    }
    
    .stat-card-ultra {
        padding: 0.875rem;
    }
    
    .stat-icon-ultra {
        width: 40px;
        height: 40px;
        font-size: 1rem;
    }
    
    .number-value {
        font-size: 1.5rem;
    }
    
    .label-main {
        font-size: 0.8rem;
    }
    
    .label-sub {
        font-size: 0.7rem;
    }
    
    .action-btn-ultra {
        padding: 0.625rem 1rem;
        font-size: 0.8rem;
    }
    
    /* Orbs ainda menores para telas muito pequenas */
    .hero-orb-1 {
        width: 80px;
        height: 80px;
    }
    
    .hero-orb-2 {
        width: 70px;
        height: 70px;
    }
    
    .hero-orb-3 {
        width: 75px;
        height: 75px;
    }
}

.assistant-card {
    background: var(--bg-glass-dark);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: var(--radius-xl);
    padding: 2rem;
    box-shadow: var(--shadow-lg);
    text-align: center;
    position: relative;
    overflow: hidden;
}

.assistant-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 2px;
    background: linear-gradient(90deg, var(--primary), var(--primary-light), var(--primary));
    animation: shimmer 2s linear infinite;
}

@keyframes shimmer {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
}

.assistant-avatar {
    width: 80px;
    height: 80px;
    background: linear-gradient(135deg, var(--info) 0%, #3b82f6 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2rem;
    color: white;
    margin: 0 auto 1rem;
    position: relative;
    box-shadow: var(--shadow-lg);
}

.assistant-pulse {
    position: absolute;
    inset: -10px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--info), #3b82f6);
    opacity: 0.3;
    animation: pulse 2s ease-in-out infinite;
}

.assistant-content h3 {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 0.5rem;
}

.assistant-content p {
    font-size: 0.9rem;
    color: var(--text-secondary);
    line-height: 1.5;
    margin-bottom: 1.5rem;
}

.assistant-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    width: 100%;
    padding: 0.75rem 1rem;
    background: linear-gradient(135deg, var(--info) 0%, #3b82f6 100%);
    color: white;
    border: none;
    border-radius: var(--radius-lg);
    font-size: 0.9rem;
    font-weight: 600;
    cursor: pointer;
    transition: all var(--transition-base);
    box-shadow: var(--shadow-md);
}

.assistant-btn:hover {
    transform: translateY(-1px);
    box-shadow: var(--shadow-lg);
}

.actions-card {
    background: var(--bg-glass-dark);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: var(--radius-xl);
    padding: 1.5rem;
    box-shadow: var(--shadow-lg);
}

.actions-card h3 {
    font-size: 1.125rem;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 1rem;
}

.action-list {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.action-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem;
    background: var(--bg-primary);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    text-decoration: none;
    color: inherit;
    cursor: pointer;
    transition: all var(--transition-base);
}

.action-item:hover {
    border-color: var(--primary);
    background: var(--emerald-50);
    transform: translateY(-1px);
    box-shadow: var(--shadow-sm);
}

.action-icon {
    width: 40px;
    height: 40px;
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1rem;
    flex-shrink: 0;
}

.action-content {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
}

.action-title {
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 0.25rem;
}

.action-desc {
    font-size: 0.8rem;
    color: var(--text-muted);
}

.stats-card {
    background: var(--bg-glass-dark);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: var(--radius-xl);
    padding: 1.5rem;
    box-shadow: var(--shadow-lg);
}

.stats-card h3 {
    font-size: 1.125rem;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 1rem;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
}

.stat-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem;
    background: var(--bg-primary);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    transition: all var(--transition-base);
}

.stat-item:hover {
    border-color: var(--primary);
    transform: translateY(-1px);
    box-shadow: var(--shadow-sm);
}

.stat-item .stat-icon {
    width: 36px;
    height: 36px;
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 0.9rem;
    flex-shrink: 0;
}

.stat-item .stat-data {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
}

.stat-item .stat-number {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--text-primary);
    line-height: 1;
}

.stat-item .stat-label {
    font-size: 0.75rem;
    color: var(--text-muted);
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}



/* ===== RESPONSIVIDADE ===== */
@media (max-width: 1200px) {
    .content-wrapper {
        grid-template-columns: 1fr;
        gap: 2rem;
    }
    
    .sidebar-premium {
        order: -1;
        position: static;
        flex-direction: row;
        overflow-x: auto;
        padding-bottom: 1rem;
    }
    
    .sidebar-premium > * {
        min-width: 280px;
        flex-shrink: 0;
    }
    
    .stats-grid {
        grid-template-columns: repeat(4, 1fr);
    }
}

@media (max-width: 768px) {
    .premium-container {
        padding: 1rem;
    }
    
    .header-glass {
        padding: 1.5rem;
    }
    
    .hero-title {
        font-size: 2rem;
    }
    
    .hero-subtitle {
        font-size: 1rem;
    }
    
    .quick-stats {
        flex-direction: column;
        align-items: center;
    }
    
    .form-container-premium {
        padding: 2.5rem;
        border-radius: 24px;
        margin-bottom: 2rem;
    }
    
    .form-container-premium::before {
        height: 6px;
    }
    
    .panel-header {
        padding: 1.5rem;
        gap: 1rem;
        margin-bottom: 2rem;
        border-radius: 20px;
    }
    
    .panel-icon {
        width: 60px;
        height: 60px;
        font-size: 1.3rem;
        border-radius: 16px;
    }
    
    .panel-content h2 {
        font-size: 1.5rem;
    }
    
    .panel-content p {
        font-size: 1rem;
    }
    
    .progress-flow {
        margin-bottom: 3rem;
        padding: 1.5rem 0;
    }
    
    .flow-steps {
        max-width: 600px;
    }
    
    .flow-step {
        padding: 0.75rem;
        border-radius: 16px;
    }
    
    .step-circle {
        width: 60px;
        height: 60px;
        font-size: 1.2rem;
    }
    
    .step-title {
        font-size: 1rem;
    }
    
    .step-desc {
        font-size: 0.85rem;
    }
    
    .field-wrapper {
        border-radius: 16px;
    }
    
    .field-input {
        padding: 1rem 1rem 1rem 3rem;
        font-size: 1rem;
    }
    
    .field-icon {
        left: 1rem;
        font-size: 1.1rem;
    }
    
    .navigation-premium {
        padding: 2.5rem 1.5rem;
        margin-top: 3rem;
        border-radius: 20px;
    }
    
    .nav-btn {
        padding: 1rem 1.5rem;
        font-size: 1rem;
        border-radius: 16px;
        min-width: 120px;
    }
    
    .nav-center {
        padding: 0.75rem 1.5rem;
        border-radius: 14px;
    }
    
    .current-step {
        font-size: 1.2rem;
    }
    
    .step-separator {
        font-size: 1rem;
    }
    
    .total-steps {
        font-size: 1rem;
    }
    
    .fields-grid {
        grid-template-columns: 1fr;
        gap: 1.5rem;
    }
    
    .flow-steps {
        flex-direction: column;
        gap: 1rem;
    }
    
    .flow-line {
        display: none;
    }
    
    .step-circle {
        width: 50px;
        height: 50px;
        font-size: 1rem;
    }
    
    .sidebar-premium {
        flex-direction: column;
        gap: 1.5rem;
    }
    
    .sidebar-premium > * {
        min-width: unset;
    }
    
    .stats-grid {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .navigation-premium {
        flex-direction: column;
        gap: 1rem;
    }
    
    .nav-center {
        order: -1;
    }
    

}

@media (max-width: 480px) {
    .breadcrumb-premium {
        flex-wrap: wrap;
        gap: 0.5rem;
    }
    
    .breadcrumb-link,
    .breadcrumb-current {
        padding: 0.375rem 0.75rem;
        font-size: 0.8rem;
    }
    
    .form-container-premium {
        padding: 1.5rem;
        border-radius: 20px;
        margin-bottom: 1.5rem;
    }
    
    .form-container-premium::before {
        height: 4px;
    }
    
    .panel-header {
        flex-direction: column;
        text-align: center;
        gap: 1rem;
        padding: 1rem;
        margin-bottom: 1.5rem;
        border-radius: 16px;
    }
    
    .panel-icon {
        width: 50px;
        height: 50px;
        font-size: 1.2rem;
        border-radius: 14px;
    }
    
    .panel-content h2 {
        font-size: 1.3rem;
    }
    
    .panel-content p {
        font-size: 0.9rem;
    }
    
    .progress-flow {
        margin-bottom: 2rem;
        padding: 1rem 0;
    }
    
    .flow-steps {
        max-width: 100%;
        gap: 0.5rem;
    }
    
    .flow-step {
        padding: 0.5rem;
        border-radius: 12px;
        min-width: 0;
        flex: 1;
    }
    
    .step-circle {
        width: 50px;
        height: 50px;
        font-size: 1rem;
    }
    
    .step-content {
        margin-top: 0.75rem;
    }
    
    .step-title {
        font-size: 0.85rem;
    }
    
    .step-desc {
        font-size: 0.7rem;
    }
    
    .field-wrapper {
        border-radius: 14px;
    }
    
    .field-input {
        padding: 0.875rem 0.875rem 0.875rem 2.5rem;
        font-size: 0.95rem;
    }
    
    .field-icon {
        left: 0.875rem;
        font-size: 1rem;
        width: 20px;
        height: 20px;
    }
    
    .navigation-premium {
        padding: 1.5rem 1rem;
        margin-top: 2rem;
        border-radius: 16px;
        flex-direction: column;
        gap: 1rem;
    }
    
    .nav-center {
        order: -1;
        padding: 0.75rem 1rem;
        border-radius: 12px;
    }
    
    .nav-btn {
        padding: 0.875rem 1.25rem;
        font-size: 0.95rem;
        border-radius: 14px;
        min-width: 100px;
        width: 100%;
    }
    
    .current-step {
        font-size: 1.1rem;
    }
    
    .step-separator {
        font-size: 0.95rem;
    }
    
    .total-steps {
        font-size: 0.95rem;
    }
    
    .permission-header {
        flex-direction: column;
        text-align: center;
        gap: 0.75rem;
    }
    
    .preview-card {
        flex-direction: column;
        text-align: center;
        gap: 1rem;
    }
    
    .action-item {
        flex-direction: column;
        text-align: center;
        gap: 0.5rem;
    }
}

/* ===== LOADING SCREEN ===== */
.loading-screen {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, var(--emerald-500) 0%, var(--emerald-600) 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: var(--z-modal);
    opacity: 1;
    visibility: visible;
    transition: all var(--transition-slower);
}

.loading-screen.hidden {
    opacity: 0;
    visibility: hidden;
    pointer-events: none;
}

.loading-content {
    text-align: center;
    color: white;
}

.loading-logo {
    font-size: 4rem;
    margin-bottom: 1rem;
    animation: pulse 2s ease-in-out infinite;
}

.loading-text {
    font-size: 1.25rem;
    font-weight: 500;
    margin-bottom: 2rem;
    opacity: 0.9;
}

.loading-bar {
    width: 200px;
    height: 4px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: var(--radius-full);
    overflow: hidden;
    margin: 0 auto;
}

.loading-progress {
    width: 0%;
    height: 100%;
    background: white;
    border-radius: var(--radius-full);
    animation: loadingProgress 3s ease-in-out;
}

@keyframes pulse {
    0%, 100% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.1); opacity: 0.8; }
}

@keyframes loadingProgress {
    0% { width: 0%; }
    100% { width: 100%; }
}

/* ===== CONTAINER PREMIUM ===== */
.premium-container {
    max-width: 1600px;
    margin: 0 auto;
    padding: 2rem;
    position: relative;
    z-index: 1;
}

/* ===== HEADER PREMIUM ===== */
.premium-header {
    margin-bottom: 3rem;
}

.header-glass {
    background: var(--bg-glass);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: var(--radius-2xl);
    padding: 2rem;
    box-shadow: var(--shadow-2xl);
}

.breadcrumb-premium {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 2rem;
    font-size: 0.9rem;
}

.breadcrumb-link {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--text-secondary);
    text-decoration: none;
    padding: 0.5rem 1rem;
    border-radius: var(--radius-lg);
    transition: all var(--transition-base);
    font-weight: 500;
}

.breadcrumb-link:hover {
    background: rgba(16, 185, 129, 0.1);
    color: var(--primary);
    transform: translateY(-1px);
}

.breadcrumb-icon {
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.breadcrumb-separator {
    width: 16px;
    height: 16px;
    color: var(--text-light);
}

.breadcrumb-current {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--primary);
    font-weight: 600;
    padding: 0.5rem 1rem;
    background: linear-gradient(135deg, var(--emerald-50) 0%, var(--emerald-100) 100%);
    border-radius: var(--radius-lg);
    border: 1px solid var(--emerald-200);
}

/* ===== HERO SECTION ULTRA PREMIUM ===== */
.hero-ultra-premium {
    position: relative;
    background: linear-gradient(135deg, 
        var(--emerald-50) 0%, 
        var(--emerald-100) 25%,
        var(--emerald-200) 75%, 
        var(--emerald-300) 100%);
    border-radius: var(--radius-2xl);
    overflow: hidden;
    margin-bottom: 3rem;
    min-height: 500px;
    display: flex;
    align-items: center;
    box-shadow: 
        0 25px 50px -12px rgba(0, 0, 0, 0.25),
        0 0 0 1px rgba(255, 255, 255, 0.05),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

.hero-background {
    position: absolute;
    inset: 0;
    overflow: hidden;
    pointer-events: none;
}

.hero-gradient {
    position: absolute;
    inset: 0;
    background: radial-gradient(
        ellipse at 20% 50%, 
        rgba(16, 185, 129, 0.15) 0%, 
        transparent 50%
    ),
    radial-gradient(
        ellipse at 80% 20%, 
        rgba(52, 211, 153, 0.15) 0%, 
        transparent 50%
    ),
    radial-gradient(
        ellipse at 40% 80%, 
        rgba(167, 243, 208, 0.15) 0%, 
        transparent 50%
    );
}

.hero-pattern {
    position: absolute;
    inset: 0;
    background-image: 
        radial-gradient(circle at 25% 25%, rgba(255, 255, 255, 0.1) 1px, transparent 1px),
        radial-gradient(circle at 75% 75%, rgba(255, 255, 255, 0.05) 1px, transparent 1px);
    background-size: 50px 50px, 80px 80px;
    opacity: 0.4;
}

.hero-orbs {
    position: absolute;
    inset: 0;
}

.hero-orb {
    position: absolute;
    border-radius: 50%;
    filter: blur(60px);
    opacity: 0.6;
    animation: heroOrbFloat 8s ease-in-out infinite;
}

.hero-orb-1 {
    width: 200px;
    height: 200px;
    background: radial-gradient(circle, var(--emerald-300) 0%, var(--emerald-400) 50%, transparent 70%);
    top: -10%;
    left: -5%;
    animation-delay: 0s;
}

.hero-orb-2 {
    width: 150px;
    height: 150px;
    background: radial-gradient(circle, var(--emerald-200) 0%, var(--emerald-300) 50%, transparent 70%);
    top: 20%;
    right: -5%;
    animation-delay: 2s;
}

.hero-orb-3 {
    width: 180px;
    height: 180px;
    background: radial-gradient(circle, var(--emerald-400) 0%, var(--emerald-500) 50%, transparent 70%);
    bottom: -10%;
    left: 30%;
    animation-delay: 4s;
}

@keyframes heroOrbFloat {
    0%, 100% {
        transform: translate(0, 0) scale(1);
        opacity: 0.6;
    }
    25% {
        transform: translate(20px, -20px) scale(1.1);
        opacity: 0.4;
    }
    50% {
        transform: translate(-15px, 15px) scale(0.9);
        opacity: 0.8;
    }
    75% {
        transform: translate(15px, 5px) scale(1.05);
        opacity: 0.5;
    }
}

.hero-content {
    position: relative;
    z-index: 2;
    width: 100%;
    text-align: center;
    padding: 3rem 2rem;
}

/* Badge Premium */
.hero-badge-premium {
    display: inline-flex;
    align-items: center;
    gap: 0.75rem;
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
    color: white;
    padding: 0.75rem 1.5rem;
    border-radius: var(--radius-full);
    font-size: 0.9rem;
    font-weight: 600;
    margin-bottom: 2rem;
    position: relative;
    overflow: hidden;
    box-shadow: 
        0 10px 25px -3px rgba(16, 185, 129, 0.3),
        0 4px 6px -2px rgba(16, 185, 129, 0.05);
}

.badge-icon {
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.875rem;
}

.badge-glow {
    position: absolute;
    inset: -2px;
    background: linear-gradient(135deg, var(--primary), var(--primary-light));
    border-radius: var(--radius-full);
    opacity: 0;
    animation: badgeGlow 3s ease-in-out infinite;
    z-index: -1;
}

.badge-sparkle {
    position: absolute;
    inset: 0;
    pointer-events: none;
}

.sparkle {
    position: absolute;
    width: 4px;
    height: 4px;
    background: white;
    border-radius: 50%;
    opacity: 0;
    animation: sparkleAnim 2s ease-in-out infinite;
}

.sparkle:nth-child(1) {
    top: 20%;
    left: 20%;
    animation-delay: 0s;
}

.sparkle:nth-child(2) {
    top: 60%;
    right: 25%;
    animation-delay: 0.7s;
}

.sparkle:nth-child(3) {
    bottom: 30%;
    left: 60%;
    animation-delay: 1.4s;
}

@keyframes badgeGlow {
    0%, 100% { opacity: 0; transform: scale(1); }
    50% { opacity: 0.4; transform: scale(1.05); }
}

@keyframes sparkleAnim {
    0%, 100% { opacity: 0; transform: scale(0); }
    50% { opacity: 1; transform: scale(1); }
}

/* Title Section */
.hero-title-section {
    margin-bottom: 3rem;
}

.hero-title-ultra {
    font-size: clamp(2.5rem, 5vw, 4rem);
    font-weight: 800;
    line-height: 1.1;
    margin-bottom: 1.5rem;
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.title-line-1,
.title-line-2 {
    display: block;
    background: linear-gradient(135deg, var(--text-primary) 0%, var(--primary) 50%, var(--text-primary) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: titleShine 3s ease-in-out infinite;
}

.title-line-2 {
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 50%, var(--primary) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.title-accent {
    position: absolute;
    bottom: -10px;
    left: 50%;
    transform: translateX(-50%);
    width: 80px;
    height: 4px;
    background: linear-gradient(90deg, var(--primary), var(--primary-light), var(--primary));
    border-radius: 2px;
    animation: accentPulse 2s ease-in-out infinite;
}

@keyframes titleShine {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
}

@keyframes accentPulse {
    0%, 100% { opacity: 0.7; transform: translateX(-50%) scaleX(1); }
    50% { opacity: 1; transform: translateX(-50%) scaleX(1.2); }
}

.hero-subtitle-ultra {
    font-size: clamp(1.125rem, 2vw, 1.375rem);
    color: var(--text-secondary);
    max-width: 700px;
    margin: 0 auto;
    line-height: 1.6;
    font-weight: 400;
}

.subtitle-highlight {
    color: var(--primary);
    font-weight: 600;
    position: relative;
}

.subtitle-highlight::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 2px;
    background: var(--primary);
    border-radius: 1px;
    opacity: 0.3;
}

/* Stats Dashboard Premium */
.stats-dashboard-premium {
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: var(--radius-2xl);
    padding: 2rem;
    margin-top: 2rem;
    box-shadow: 
        0 20px 25px -5px rgba(0, 0, 0, 0.1),
        0 10px 10px -5px rgba(0, 0, 0, 0.04);
}

.dashboard-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 2rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid rgba(16, 185, 129, 0.1);
}

.dashboard-title {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--text-primary);
}

.dashboard-title i {
    color: var(--primary);
    font-size: 1.375rem;
}

.dashboard-live {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    background: var(--emerald-50);
    border: 1px solid var(--emerald-200);
    border-radius: var(--radius-full);
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--emerald-700);
}

.live-indicator {
    width: 8px;
    height: 8px;
    background: var(--emerald-500);
    border-radius: 50%;
    animation: livePulse 1.5s ease-in-out infinite;
}

@keyframes livePulse {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.5; transform: scale(1.2); }
}

.stats-grid-ultra {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.stat-card-ultra {
    background: var(--bg-primary);
    border: 2px solid var(--border-light);
    border-radius: var(--radius-xl);
    padding: 1.5rem;
    position: relative;
    overflow: hidden;
    transition: all var(--transition-base);
    cursor: help;
}

.stat-card-ultra:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-xl);
}

.stat-card-ultra.primary {
    border-color: var(--primary);
    background: linear-gradient(135deg, var(--emerald-50) 0%, #ffffff 100%);
}

.stat-card-ultra.success {
    border-color: var(--success);
    background: linear-gradient(135deg, var(--emerald-50) 0%, #ffffff 100%);
}

.stat-card-ultra.warning {
    border-color: var(--warning);
    background: linear-gradient(135deg, #fef3c7 0%, #ffffff 100%);
}

.stat-background {
    position: absolute;
    inset: 0;
    opacity: 0.1;
}

.stat-pattern {
    position: absolute;
    inset: 0;
    background-image: 
        radial-gradient(circle at 25% 25%, currentColor 1px, transparent 1px),
        radial-gradient(circle at 75% 75%, currentColor 0.5px, transparent 0.5px);
    background-size: 20px 20px, 30px 30px;
}

.stat-gradient {
    position: absolute;
    inset: 0;
    background: radial-gradient(ellipse at center, currentColor 0%, transparent 70%);
}

.stat-header-ultra {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1rem;
}

.stat-icon-ultra {
    width: 60px;
    height: 60px;
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
    border-radius: var(--radius-lg);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.5rem;
    position: relative;
    box-shadow: var(--shadow-md);
}

.stat-card-ultra.success .stat-icon-ultra {
    background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
}

.stat-card-ultra.warning .stat-icon-ultra {
    background: linear-gradient(135deg, var(--warning) 0%, #d97706 100%);
}

.icon-ripple {
    position: absolute;
    inset: -8px;
    border: 2px solid currentColor;
    border-radius: var(--radius-lg);
    opacity: 0;
    animation: iconRipple 2s ease-in-out infinite;
}

@keyframes iconRipple {
    0% { transform: scale(0.8); opacity: 1; }
    100% { transform: scale(1.3); opacity: 0; }
}

.stat-trend {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.25rem 0.5rem;
    border-radius: var(--radius-sm);
    font-size: 0.75rem;
    font-weight: 600;
}

.stat-trend.positive {
    background: rgba(34, 197, 94, 0.1);
    color: var(--success);
}

.stat-trend.stable {
    background: rgba(156, 163, 175, 0.1);
    color: var(--text-muted);
}

.stat-body-ultra {
    margin-bottom: 1rem;
}

.stat-number-ultra {
    position: relative;
    margin-bottom: 0.5rem;
}

.number-value {
    font-size: 2.5rem;
    font-weight: 800;
    color: var(--text-primary);
    line-height: 1;
    display: block;
}

.number-animation {
    position: absolute;
    inset: 0;
    background: linear-gradient(90deg, transparent 0%, rgba(16, 185, 129, 0.3) 50%, transparent 100%);
    animation: numberShine 3s ease-in-out infinite;
    pointer-events: none;
}

@keyframes numberShine {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
}

.stat-label-ultra {
    display: flex;
    flex-direction: column;
}

.label-main {
    font-size: 1rem;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 0.125rem;
}

.label-sub {
    font-size: 0.875rem;
    color: var(--text-muted);
    font-weight: 400;
}

.stat-footer-ultra {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.progress-line {
    width: 100%;
    height: 6px;
    background: var(--border-light);
    border-radius: 3px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--primary) 0%, var(--primary-light) 100%);
    border-radius: 3px;
    transition: width var(--transition-slow);
    position: relative;
}

.stat-card-ultra.success .progress-fill {
    background: linear-gradient(90deg, var(--success) 0%, #34d399 100%);
}

.stat-card-ultra.warning .progress-fill {
    background: linear-gradient(90deg, var(--warning) 0%, #fbbf24 100%);
}

.progress-fill::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(90deg, transparent 0%, rgba(255, 255, 255, 0.4) 50%, transparent 100%);
    animation: progressShine 2s ease-in-out infinite;
}

@keyframes progressShine {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
}

.progress-text {
    font-size: 0.75rem;
    color: var(--text-muted);
    font-weight: 500;
}

/* Action Button Ultra */
.dashboard-action {
    display: flex;
    justify-content: center;
    margin-top: 1rem;
}

.action-btn-ultra {
    background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
    border: none;
    border-radius: var(--radius-xl);
    padding: 1rem 2rem;
    color: white;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    position: relative;
    overflow: hidden;
    transition: all var(--transition-base);
    display: flex;
    align-items: center;
    gap: 0.75rem;
    box-shadow: 
        0 10px 25px -3px rgba(16, 185, 129, 0.3),
        0 4px 6px -2px rgba(16, 185, 129, 0.05);
}

.action-btn-ultra:hover {
    transform: translateY(-2px);
    box-shadow: 
        0 20px 25px -5px rgba(16, 185, 129, 0.4),
        0 10px 10px -5px rgba(16, 185, 129, 0.1);
}

.btn-icon-ultra {
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1rem;
}

.btn-shine {
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent 0%, rgba(255, 255, 255, 0.3) 50%, transparent 100%);
    animation: btnShine 3s ease-in-out infinite;
}

@keyframes btnShine {
    0% { left: -100%; }
    100% { left: 100%; }
}

.btn-particles {
    position: absolute;
    inset: 0;
    pointer-events: none;
}

.particle {
    position: absolute;
    width: 2px;
    height: 2px;
    background: white;
    border-radius: 50%;
    opacity: 0;
    animation: particleFloat 3s ease-in-out infinite;
}

.particle:nth-child(1) {
    top: 20%;
    left: 20%;
    animation-delay: 0s;
}

.particle:nth-child(2) {
    top: 60%;
    left: 50%;
    animation-delay: 1s;
}

.particle:nth-child(3) {
    top: 30%;
    right: 25%;
    animation-delay: 2s;
}

@keyframes particleFloat {
    0%, 100% { opacity: 0; transform: translateY(0); }
    50% { opacity: 1; transform: translateY(-10px); }
}

/* ===== MAIN CONTENT ===== */
.main-content {
    position: relative;
}

.content-wrapper {
    display: grid;
    grid-template-columns: 1fr 320px;
    gap: 3rem;
    align-items: start;
}

/* ===== HEADER MODERNO ===== */
.page-header-modern {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
    border-radius: var(--radius-xl);
    padding: 2rem;
    margin-bottom: 2rem;
    color: white;
    box-shadow: var(--shadow-xl);
    position: relative;
    overflow: hidden;
}

.page-header-modern::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="50" cy="50" r="1" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
    opacity: 0.5;
}

.header-content {
    position: relative;
    z-index: 2;
}

.breadcrumb-nav {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 1.5rem;
    font-size: 0.9rem;
}

.breadcrumb-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: rgba(255, 255, 255, 0.8);
    text-decoration: none;
    padding: 0.5rem 0.75rem;
    border-radius: var(--radius-md);
    transition: all 0.2s ease;
}

.breadcrumb-item:hover {
    background: rgba(255, 255, 255, 0.15);
    color: white;
}

.breadcrumb-separator {
    color: rgba(255, 255, 255, 0.5);
    font-size: 0.8rem;
}

.breadcrumb-current {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: white;
    font-weight: 600;
    padding: 0.5rem 0.75rem;
    background: rgba(255, 255, 255, 0.2);
    border-radius: var(--radius-md);
    backdrop-filter: blur(10px);
}

.header-hero {
    display: flex;
    align-items: center;
    gap: 1.5rem;
}

.hero-icon {
    width: 80px;
    height: 80px;
    background: rgba(255, 255, 255, 0.15);
    border-radius: var(--radius-xl);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2.5rem;
    backdrop-filter: blur(10px);
}

.hero-text h1 {
    font-size: 2.5rem;
    font-weight: 700;
    margin: 0 0 0.5rem 0;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.hero-text p {
    font-size: 1.1rem;
    opacity: 0.9;
    margin: 0;
}

/* ===== MAIN CONTAINER ===== */
.main-container {
    display: grid;
    grid-template-columns: 1fr 300px;
    gap: 2rem;
    align-items: start;
}

/* ===== FORM WRAPPER ===== */
.form-wrapper {
    background: var(--bg-primary);
    border-radius: var(--radius-xl);
    padding: 2rem;
    box-shadow: var(--shadow-xl);
    border: 1px solid var(--border-light);
    backdrop-filter: blur(20px);
}

/* ===== PROGRESS STEPS ===== */
.progress-steps {
    display: flex;
    justify-content: space-between;
    margin-bottom: 2rem;
    position: relative;
}

.progress-steps::before {
    content: '';
    position: absolute;
    top: 20px;
    left: 10%;
    right: 10%;
    height: 2px;
    background: var(--border-color);
    z-index: 1;
}

.step {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
    position: relative;
    z-index: 2;
    cursor: pointer;
    transition: all 0.3s ease;
}

.step-number {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: var(--bg-tertiary);
    color: var(--text-secondary);
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    border: 2px solid var(--border-color);
    transition: all 0.3s ease;
}

.step-label {
    font-size: 0.85rem;
    color: var(--text-secondary);
    font-weight: 500;
    text-align: center;
    transition: all 0.3s ease;
}

.step.active .step-number {
    background: var(--primary-color);
    color: white;
    border-color: var(--primary-color);
    transform: scale(1.1);
}

.step.active .step-label {
    color: var(--primary-color);
    font-weight: 600;
}

.step.completed .step-number {
    background: var(--success-color);
    color: white;
    border-color: var(--success-color);
}

.step.completed .step-number::before {
    content: '✓';
    font-size: 1rem;
}

/* ===== FORM STEPS ===== */
.form-step {
    display: none;
    animation: fadeInUp 0.5s ease;
}

.form-step.active {
    display: block;
}

.step-header {
    text-align: center;
    margin-bottom: 2rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--border-light);
}

.step-header h3 {
    color: var(--text-primary);
    margin: 0 0 0.5rem 0;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
    font-size: 1.5rem;
    font-weight: 600;
}

.step-header p {
    color: var(--text-secondary);
    margin: 0;
    font-size: 1rem;
}

/* ===== GRID DE FORMULÁRIO ===== */
.form-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.form-group {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.form-label {
    font-weight: 600;
    color: var(--text-primary);
    font-size: 0.9rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.form-label i {
    color: var(--primary-color);
    width: 16px;
}

.required {
    color: var(--error-color);
    font-weight: 700;
}

.form-input {
    width: 100%;
    padding: 0.75rem 1rem;
    border: 2px solid var(--border-color);
    border-radius: var(--radius-md);
    font-size: 1rem;
    transition: all 0.3s ease;
    background: var(--bg-primary);
}

.form-input:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
    transform: translateY(-1px);
}

.form-input.valid {
    border-color: var(--success-color);
}

.form-input.invalid {
    border-color: var(--error-color);
}

.form-feedback {
    font-size: 0.8rem;
    margin-top: 0.25rem;
    min-height: 1rem;
}

.form-feedback.valid {
    color: var(--success-color);
}

.form-feedback.invalid {
    color: var(--error-color);
}

.form-help {
    font-size: 0.8rem;
    color: var(--text-light);
    margin-top: 0.25rem;
}

/* ===== PASSWORD INPUT ===== */
.password-input-wrapper {
    position: relative;
}

.password-toggle {
    position: absolute;
    right: 0.75rem;
    top: 50%;
    transform: translateY(-50%);
    background: none;
    border: none;
    color: var(--text-secondary);
    cursor: pointer;
    padding: 0.25rem;
    border-radius: var(--radius-sm);
    transition: all 0.2s ease;
}

.password-toggle:hover {
    color: var(--primary-color);
    background: rgba(16, 185, 129, 0.1);
}

/* ===== PASSWORD STRENGTH ===== */
.password-strength {
    margin-top: 0.5rem;
}

.strength-bar {
    width: 100%;
    height: 4px;
    background: var(--border-color);
    border-radius: 2px;
    overflow: hidden;
    margin-bottom: 0.5rem;
}

.strength-fill {
    height: 100%;
    width: 0%;
    transition: all 0.3s ease;
    border-radius: 2px;
}

.strength-text {
    font-size: 0.8rem;
    font-weight: 500;
}

/* Força da senha */
.strength-weak .strength-fill {
    width: 25%;
    background: var(--error-color);
}

.strength-fair .strength-fill {
    width: 50%;
    background: var(--warning-color);
}

.strength-good .strength-fill {
    width: 75%;
    background: var(--info-color);
}

.strength-strong .strength-fill {
    width: 100%;
    background: var(--success-color);
}

/* ===== DICAS DE SEGURANÇA ===== */
.security-tips {
    background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
    border: 1px solid #f59e0b;
    border-radius: var(--radius-lg);
    padding: 1.5rem;
    margin-top: 1rem;
}

.security-tips h4 {
    color: #92400e;
    margin: 0 0 1rem 0;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 1rem;
}

.tips-list {
    list-style: none;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0.5rem;
}

.tip-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.85rem;
    color: #92400e;
    padding: 0.25rem 0;
}

.tip-item i {
    color: #ef4444;
    transition: all 0.3s ease;
}

.tip-item.valid i {
    color: var(--success-color);
}

/* ===== PERMISSÕES ===== */
.permissions-grid {
    display: grid;
    gap: 1.5rem;
    margin-bottom: 2rem;
}

.permission-card {
    background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-primary) 100%);
    border: 2px solid var(--border-light);
    border-radius: var(--radius-lg);
    padding: 1.5rem;
    display: flex;
    align-items: flex-start;
    gap: 1rem;
    transition: all 0.3s ease;
}

.permission-card:hover {
    border-color: var(--primary-color);
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
}

.permission-icon {
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
    border-radius: var(--radius-lg);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.25rem;
    color: white;
    flex-shrink: 0;
}

.permission-icon.admin {
    background: linear-gradient(135deg, var(--warning-color) 0%, #d97706 100%);
}

.permission-content {
    flex: 1;
}

.permission-content h4 {
    color: var(--text-primary);
    margin: 0 0 0.5rem 0;
    font-size: 1.1rem;
    font-weight: 600;
}

.permission-content p {
    color: var(--text-secondary);
    margin: 0 0 1rem 0;
    font-size: 0.9rem;
    line-height: 1.4;
}

/* ===== TOGGLE SWITCH ===== */
.toggle-switch {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.toggle-input {
    display: none;
}

.toggle-label {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    cursor: pointer;
    font-weight: 500;
    color: var(--text-primary);
}

.toggle-slider {
    width: 50px;
    height: 24px;
    background: var(--border-color);
    border-radius: 12px;
    position: relative;
    transition: all 0.3s ease;
}

.toggle-slider::before {
    content: '';
    position: absolute;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background: white;
    top: 2px;
    left: 2px;
    transition: all 0.3s ease;
    box-shadow: var(--shadow-sm);
}

.toggle-input:checked + .toggle-label .toggle-slider {
    background: var(--primary-color);
}

.toggle-input:checked + .toggle-label .toggle-slider::before {
    transform: translateX(26px);
}

/* ===== USER PREVIEW ===== */
.user-preview {
    background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
    border: 1px solid var(--border-light);
    border-radius: var(--radius-lg);
    padding: 1.5rem;
    margin-top: 2rem;
}

.user-preview h4 {
    color: var(--text-primary);
    margin: 0 0 1rem 0;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 1.1rem;
}

.preview-card {
    background: white;
    border-radius: var(--radius-lg);
    padding: 1.5rem;
    display: flex;
    align-items: center;
    gap: 1rem;
    box-shadow: var(--shadow-sm);
}

.preview-avatar {
    width: 60px;
    height: 60px;
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    color: white;
}

.preview-info {
    flex: 1;
}

.preview-name {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 0.25rem;
}

.preview-username {
    font-size: 0.9rem;
    color: var(--primary-color);
    font-weight: 500;
    margin-bottom: 0.25rem;
}

.preview-email {
    font-size: 0.85rem;
    color: var(--text-secondary);
    margin-bottom: 0.5rem;
}

.preview-badges {
    display: flex;
    gap: 0.5rem;
}

.preview-badge {
    padding: 0.25rem 0.75rem;
    border-radius: var(--radius-md);
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

.preview-badge.active {
    background: #ecfdf5;
    color: var(--success-color);
}

.preview-badge.admin {
    background: #fef3c7;
    color: var(--warning-color);
}

/* ===== NAVEGAÇÃO DO FORM ===== */
.form-navigation {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-top: 2rem;
    border-top: 1px solid var(--border-light);
    margin-top: 2rem;
}

.nav-center {
    text-align: center;
}

.step-indicator {
    font-size: 0.9rem;
    color: var(--text-secondary);
    font-weight: 500;
}

/* ===== BOTÕES ===== */
.btn {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.5rem;
    border: 2px solid transparent;
    border-radius: var(--radius-md);
    font-size: 0.9rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    text-decoration: none;
    position: relative;
    overflow: hidden;
}

.btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s ease;
}

.btn:hover::before {
    left: 100%;
}

.btn-primary {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%);
    color: white;
    border-color: var(--primary-color);
}

.btn-primary:hover {
    background: linear-gradient(135deg, var(--primary-dark) 0%, #047857 100%);
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
}

.btn-secondary {
    background: var(--bg-tertiary);
    color: var(--text-secondary);
    border-color: var(--border-color);
}

.btn-secondary:hover {
    background: var(--border-color);
    color: var(--text-primary);
}

.btn-success {
    background: linear-gradient(135deg, var(--success-color) 0%, var(--primary-dark) 100%);
    color: white;
    border-color: var(--success-color);
}

.btn-success:hover {
    background: linear-gradient(135deg, var(--primary-dark) 0%, #047857 100%);
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
}

/* ===== SIDEBAR DE AJUDA ===== */
.help-sidebar {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.help-card,
.stats-card {
    background: var(--bg-primary);
    border-radius: var(--radius-xl);
    padding: 1.5rem;
    box-shadow: var(--shadow-lg);
    border: 1px solid var(--border-light);
}

.help-card {
    background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
    border-color: #f59e0b;
    animation: pulse-glow 3s ease-in-out infinite;
}

.help-icon {
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, var(--warning-color) 0%, #d97706 100%);
    border-radius: var(--radius-lg);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.25rem;
    color: white;
    margin-bottom: 1rem;
}

.help-card h4 {
    color: #92400e;
    margin: 0 0 0.5rem 0;
    font-size: 1.1rem;
    font-weight: 600;
}

.help-card p {
    color: #92400e;
    margin: 0 0 1rem 0;
    font-size: 0.9rem;
    line-height: 1.4;
}

.help-list {
    list-style: none;
    margin: 0 0 1.5rem 0;
}

.help-list li {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: #92400e;
    font-size: 0.85rem;
    margin-bottom: 0.5rem;
}

.help-list i {
    color: var(--success-color);
    font-size: 0.8rem;
}

.help-button {
    width: 100%;
    padding: 0.75rem 1rem;
    background: linear-gradient(135deg, var(--warning-color) 0%, #d97706 100%);
    color: white;
    border: none;
    border-radius: var(--radius-md);
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.help-button:hover {
    background: linear-gradient(135deg, #d97706 0%, #b45309 100%);
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
}

/* ===== STATS CARD ===== */
.stats-card h4 {
    color: var(--text-primary);
    margin: 0 0 1rem 0;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 1.1rem;
}

.stat-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem 0;
    border-bottom: 1px solid var(--border-light);
}

.stat-item:last-child {
    border-bottom: none;
}

.stat-number {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--primary-color);
}

.stat-label {
    font-size: 0.85rem;
    color: var(--text-secondary);
    font-weight: 500;
}



/* ===== ANIMAÇÕES ===== */
@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes slideInRight {
    from {
        opacity: 0;
        transform: translateX(100%);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

@keyframes pulse-glow {
    0%, 100% {
        box-shadow: var(--shadow-lg);
    }
    50% {
        box-shadow: 0 10px 25px -5px rgba(245, 158, 11, 0.3), 0 0 20px rgba(245, 158, 11, 0.2);
    }
}

/* ===== RESPONSIVIDADE ===== */
@media (max-width: 1200px) {
    .main-container {
        grid-template-columns: 1fr 280px;
        gap: 1.5rem;
    }
}

@media (max-width: 992px) {
    .main-container {
        grid-template-columns: 1fr;
        gap: 2rem;
    }
    
    .help-sidebar {
        order: -1;
        flex-direction: row;
    }
    
    .help-card,
    .stats-card {
        flex: 1;
    }
}

@media (max-width: 768px) {
    .criar-usuario-container {
        padding: 1rem;
    }
    
    .hero-text h1 {
        font-size: 2rem;
    }
    
    .hero-icon {
        width: 60px;
        height: 60px;
        font-size: 2rem;
    }
    
    .form-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
    }
    
    .tips-list {
        grid-template-columns: 1fr;
    }
    
    .permissions-grid {
        grid-template-columns: 1fr;
    }
    
    .progress-steps {
        flex-direction: column;
        gap: 1rem;
    }
    
    .progress-steps::before {
        display: none;
    }
    
    .step {
        flex-direction: row;
        justify-content: flex-start;
        padding: 1rem;
        background: var(--bg-secondary);
        border-radius: var(--radius-lg);
    }
    
    .form-navigation {
        flex-direction: column;
        gap: 1rem;
    }
    
    .nav-center {
        order: -1;
    }
    
    .help-sidebar {
        flex-direction: column;
    }
    
    .breadcrumb-nav {
        flex-wrap: wrap;
    }
    

}

@media (max-width: 480px) {
    .form-wrapper {
        padding: 1.5rem;
    }
    
    .page-header-modern {
        padding: 1.5rem;
    }
    
    .header-hero {
        flex-direction: column;
        text-align: center;
        gap: 1rem;
    }
    
    .hero-text h1 {
        font-size: 1.75rem;
    }
    
    .permission-card {
        flex-direction: column;
        text-align: center;
    }
    
    .preview-card {
        flex-direction: column;
        text-align: center;
    }
}

/* ===== MODO ESCURO (OPCIONAL) ===== */
@media (prefers-color-scheme: dark) {
    :root {
        --text-primary: #f9fafb;
        --text-secondary: #d1d5db;
        --text-light: #9ca3af;
        --bg-primary: #1f2937;
        --bg-secondary: #111827;
        --bg-tertiary: #374151;
        --border-color: #374151;
        --border-light: #4b5563;
    }
    
    body {
        background: linear-gradient(135deg, #111827 0%, #1f2937 50%, #374151 100%);
    }
    
    .animated-background .shape {
        background: linear-gradient(45deg, rgba(16, 185, 129, 0.15), rgba(52, 211, 153, 0.08));
    }
}

/* ===== UTILIDADES ===== */
.sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}

.loading {
    pointer-events: none;
    opacity: 0.6;
}

.loading::after {
    content: '';
    position: absolute;
    width: 16px;
    height: 16px;
    margin: auto;
    border: 2px solid transparent;
    border-top-color: var(--primary-color);
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    0% {
        transform: rotate(0deg);
    }
    100% {
        transform: rotate(360deg);
    }
}
</style>

<script>
// ===== VARIÁVEIS GLOBAIS =====
let currentStep = 1;
const totalSteps = 3;
let formData = {};

// INICIALIZAÇÃO REMOVIDA - MANTIDA VERSÃO MAIS COMPLETA NO FINAL

// ===== NAVEGAÇÃO ENTRE STEPS =====
function navigateStep(direction) {
    const newStep = currentStep + direction;
    
    if (newStep < 1 || newStep > totalSteps) return;
    
    if (direction > 0 && !validateCurrentStep()) {
        console.log('Por favor, preencha todos os campos obrigatórios.');
        return;
    }
    
    // Esconder step atual
    const currentStepEl = document.querySelector(`.step-panel[data-step="${currentStep}"]`);
    if (currentStepEl) {
        currentStepEl.classList.remove('active');
    }
    
    // Atualizar currentStep
    currentStep = newStep;
    
    // Mostrar novo step
    const newStepEl = document.querySelector(`.step-panel[data-step="${currentStep}"]`);
    if (newStepEl) {
        newStepEl.classList.add('active');
    }
    
    // Atualizar progresso
    updateProgressFlow();
    updateNavigationButtons();
    
    // Foco no primeiro input do novo step
    setTimeout(() => {
        const firstInput = newStepEl.querySelector('.field-input');
        if (firstInput) {
            firstInput.focus();
        }
    }, 200);
}

// FUNÇÕES REMOVIDAS - MANTIDAS VERSÕES MAIS COMPLETAS NO FINAL

// FUNÇÃO REMOVIDA - MANTIDA VERSÃO MAIS COMPLETA NO FINAL

// FUNÇÃO REMOVIDA - DUPLICATA

// FUNÇÕES DUPLICADAS REMOVIDAS - MANTIDAS VERSÕES MAIS COMPLETAS NO FINAL

// ===== CARREGAR ESTATÍSTICAS REAIS =====
async function loadUserStats() {
    try {
        // Primeiro, usar dados do contexto se disponíveis
        {% if estatisticas_usuarios %}
            updateStatsDisplay({{ estatisticas_usuarios.total_usuarios }}, {{ estatisticas_usuarios.usuarios_ativos }}, {{ estatisticas_usuarios.usuarios_admins }}, {{ estatisticas_usuarios.usuarios_recentes }});
            console.log('✅ Estatísticas iniciais carregadas do contexto');
        {% endif %}
        
        // Depois, buscar dados atualizados via API
        await fetchLatestStats();
        
    } catch (error) {
        console.error('❌ Erro ao carregar estatísticas:', error);
        
        // Fallback para placeholders em caso de erro
        document.getElementById('totalUsersHeader').textContent = '---';
        document.getElementById('activeUsersHeader').textContent = '---';
        document.getElementById('adminUsersHeader').textContent = '---';
    }
}

// ===== BUSCAR ESTATÍSTICAS ATUALIZADAS VIA API =====
async function fetchLatestStats() {
    try {
        console.log('🔄 Buscando estatísticas atualizadas...');
        
        const response = await fetch('/accounts/api/estatisticas-usuarios/', {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': getCsrfToken(),
            },
        });
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        
        if (data.success) {
            const stats = data.data.estatisticas_gerais;
            updateStatsDisplay(stats.total_usuarios, stats.usuarios_ativos, stats.usuarios_admins, stats.usuarios_recentes);
            
            console.log('✅ Estatísticas atualizadas via API:', stats);
            
            // Atualizar timestamp da última atualização
            updateLastRefresh();
        } else {
            console.warn('⚠️ API retornou erro:', data.message);
        }
        
    } catch (error) {
        console.error('❌ Erro ao buscar estatísticas via API:', error);
    }
}

// ===== ATUALIZAR DISPLAY DAS ESTATÍSTICAS =====
function updateStatsDisplay(total, ativos, admins, recentes) {
    // Estatísticas do hero section ultra premium (novos elementos)
    animateNumberWithClass('totalUsersHeader', total, '.number-value');
    animateNumberWithClass('activeUsersHeader', ativos, '.number-value');
    animateNumberWithClass('adminUsersHeader', admins, '.number-value');
    
    // Estatísticas da sidebar (elementos antigos para compatibilidade)
    animateNumber('totalUsers', total);
    animateNumber('activeUsers', ativos);
    animateNumber('adminUsers', admins);
    animateNumber('recentUsers', recentes);
}

// ===== ANIMAÇÃO DE NÚMEROS =====
function animateNumber(elementId, targetValue) {
    const element = document.getElementById(elementId);
    if (!element) return;
    
    const currentValue = parseInt(element.textContent) || 0;
    const duration = 800; // ms
    const steps = 20;
    const stepValue = (targetValue - currentValue) / steps;
    let currentStep = 0;
    
    const interval = setInterval(() => {
        currentStep++;
        const newValue = Math.round(currentValue + (stepValue * currentStep));
        element.textContent = newValue;
        
        if (currentStep >= steps) {
            element.textContent = targetValue;
            clearInterval(interval);
        }
    }, duration / steps);
}

// ===== ANIMAÇÃO DE NÚMEROS COM CLASSE =====
function animateNumberWithClass(elementId, targetValue, selector) {
    const container = document.getElementById(elementId);
    if (!container) return;
    
    const element = container.querySelector(selector);
    if (!element) return;
    
    const currentValue = parseInt(element.textContent) || 0;
    const duration = 1200; // ms - mais lento para efeito premium
    const steps = 30;
    const stepValue = (targetValue - currentValue) / steps;
    let currentStep = 0;
    
    // Adicionar efeito visual durante a animação
    const animationElement = container.querySelector('.number-animation');
    if (animationElement) {
        animationElement.style.opacity = '1';
    }
    
    const interval = setInterval(() => {
        currentStep++;
        const newValue = Math.round(currentValue + (stepValue * currentStep));
        element.textContent = newValue;
        
        if (currentStep >= steps) {
            element.textContent = targetValue;
            clearInterval(interval);
            
            // Remover efeito visual após animação
            if (animationElement) {
                setTimeout(() => {
                    animationElement.style.opacity = '0';
                }, 500);
            }
        }
    }, duration / steps);
}

// ===== ATUALIZAR TIMESTAMP =====
function updateLastRefresh() {
    const now = new Date();
    const timeString = now.toLocaleTimeString('pt-BR');
    console.log(`🕒 Última atualização: ${timeString}`);
}

// ===== AUTO-REFRESH PERIÓDICO =====
function startAutoRefresh() {
    // Atualizar estatísticas a cada 2 minutos
    setInterval(fetchLatestStats, 120000);
    console.log('🔄 Auto-refresh ativado (2 minutos)');
}

// ===== FUNÇÃO PARA OBTER CSRF TOKEN =====
function getCsrfToken() {
    const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]');
    return csrfToken ? csrfToken.value : '';
}



// ===== MODAL DE AJUDA =====
function openHelpModal() {
    console.log('Modal de ajuda será implementado em breve!');
}

// ===== SUBMIT DO FORMULÁRIO =====
function initializeFormSubmit() {
    const form = document.getElementById('createUserForm');
    if (!form) return;
    
    form.addEventListener('submit', function(e) {
        e.preventDefault();
        
        if (!validateCurrentStep()) {
            console.log('Por favor, corrija os erros antes de continuar.');
            return;
        }
        
        // Mostrar loading
        const submitBtn = document.getElementById('submitBtn');
        if (!submitBtn) return;
        
        const spinner = submitBtn.querySelector('.btn-spinner');
        const textSpan = submitBtn.querySelector('span');
        let originalText = 'Criar Usuário';
        
        if (textSpan) {
            originalText = textSpan.textContent;
            textSpan.textContent = 'Criando...';
        }
        
        if (spinner) spinner.style.display = 'inline-block';
        submitBtn.disabled = true;
        
        // Submit real do formulário
        const formData = new FormData(this);
        
        fetch(window.location.href, {
            method: 'POST',
            body: formData,
            headers: {
                'X-CSRFToken': getCsrfToken(),
            },
        })
        .then(response => {
            if (response.ok && response.redirected) {
                // Usuário criado com sucesso, atualizar estatísticas antes de redirecionar
                console.log('Usuário criado com sucesso! Atualizando estatísticas...');
                
                // Atualizar estatísticas
                fetchLatestStats().then(() => {
                    // Redirecionar após atualizar estatísticas
                    setTimeout(() => {
                        window.location.href = response.url;
                    }, 1500);
                });
                
            } else {
                // Recarregar página para mostrar erros
                window.location.reload();
            }
        })
        .catch(error => {
            console.error('Erro ao enviar formulário:', error);
            
            // Restaurar botão
            if (textSpan) textSpan.textContent = originalText;
            if (spinner) spinner.style.display = 'none';
            submitBtn.disabled = false;
            
            console.log('Erro ao criar usuário. Tente novamente.');
        });
    });
}

// ===== ANIMAÇÕES CSS ADICIONAIS =====
const additionalStyles = `
    @keyframes fadeOut {
        from {
            opacity: 1;
            transform: translateY(0);
        }
        to {
            opacity: 0;
            transform: translateY(-20px);
        }
    }
    
    @keyframes slideOutRight {
        from {
            opacity: 1;
            transform: translateX(0);
        }
        to {
            opacity: 0;
            transform: translateX(100%);
        }
    }
    
    .inactive {
        background: #f3f4f6 !important;
        color: #6b7280 !important;
    }
`;

// Adicionar estilos ao documento
const styleSheet = document.createElement('style');
styleSheet.textContent = additionalStyles;
document.head.appendChild(styleSheet);

// ===== FUNCÕES PREMIUM DA SIDEBAR =====
function generateStrongPassword() {
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*';
    let password = '';
    
    // Garantir pelo menos um de cada tipo
    password += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'[Math.floor(Math.random() * 26)];
    password += 'abcdefghijklmnopqrstuvwxyz'[Math.floor(Math.random() * 26)];
    password += '0123456789'[Math.floor(Math.random() * 10)];
    password += '!@#$%^&*'[Math.floor(Math.random() * 8)];
    
    // Completar com caracteres aleatórios
    for (let i = 4; i < 12; i++) {
        password += chars[Math.floor(Math.random() * chars.length)];
    }
    
    // Embaralhar
    password = password.split('').sort(() => Math.random() - 0.5).join('');
    
    // Inserir nos campos
    document.getElementById('password1').value = password;
    document.getElementById('password2').value = password;
    
    // Atualizar validação
    validateField(document.getElementById('password1'));
    validateField(document.getElementById('password2'));
    
    console.log('Senha forte gerada com sucesso!');
}

// Função importFromCSV removida - funcionalidade não disponível

function openAssistant() {
    console.log('🤖 Abrindo Assistente Virtual...');
    
    // Verificar se o modal já existe
    let modal = document.getElementById('assistantModal');
    if (!modal) {
        createAssistantModal();
        modal = document.getElementById('assistantModal');
    }
    
    // Mostrar modal
    modal.style.display = 'flex';
    setTimeout(() => {
        modal.classList.add('show');
    }, 10);
    
    // Carregar preferências do usuário
    setTimeout(() => {
        loadUserPreferences();
    }, 100);
    
    // Inicializar conversa
    initializeAssistantChat();
    
    // Melhorar interações do robô
    setTimeout(() => {
        enhanceRobotInteractions();
    }, 200);
    
    // Foco no input
    setTimeout(() => {
        const input = document.getElementById('assistantInput');
        if (input) input.focus();
    }, 300);
}

function createAssistantModal() {
    const modal = document.createElement('div');
    modal.id = 'assistantModal';
    modal.className = 'assistant-modal';
    
    modal.innerHTML = `
        <div class="assistant-modal-overlay" onclick="closeAssistant()"></div>
        <div class="assistant-modal-content">
            <div class="assistant-header">
                <div class="assistant-avatar">
                    <div class="avatar-icon">
                        <div class="robot-face">
                            <div class="robot-head-structure"></div>
                            <div class="robot-particles">
                                <div class="robot-particle"></div>
                                <div class="robot-particle"></div>
                                <div class="robot-particle"></div>
                                <div class="robot-particle"></div>
                            </div>
                            <div class="robot-eyes">
                                <div class="robot-eye left-eye"></div>
                                <div class="robot-eye right-eye"></div>
                            </div>
                            <div class="robot-mouth"></div>
                            <div class="robot-cheeks left-cheek"></div>
                            <div class="robot-cheeks right-cheek"></div>
                            <div class="robot-antenna"></div>
                        </div>
                    </div>
                    <div class="avatar-status" id="assistantStatus">
                        <div class="status-indicator">
                            <div class="status-dot"></div>
                            <div class="status-ripple"></div>
                        </div>
                        <span class="status-text">Online</span>
                        <div class="status-click-hint">👆</div>
                        <div class="status-tooltip">O assistente está disponível agora</div>
                    </div>
                </div>
                <div class="assistant-info">
                    <h3>Assistente Virtual</h3>
                    <p id="assistantStatusMessage">Como posso ajudá-lo hoje?</p>
                </div>
                
                <div class="assistant-controls">
                    <button class="voice-btn" onclick="toggleVoiceReading()" title="Ativar/Desativar leitura por voz" aria-label="Controle de voz">
                        <i class="fas fa-volume-up" id="voiceIcon"></i>
                    </button>
                    <button class="voice-btn" onclick="toggleAccessibilityMode()" title="Modo de alta acessibilidade" aria-label="Modo acessibilidade">
                        <i class="fas fa-universal-access" id="accessibilityIcon"></i>
                    </button>
                </div>
                
                <button class="close-btn" onclick="closeAssistant()" aria-label="Fechar assistente">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="assistant-chat" id="assistantChat">
                <div class="welcome-message">
                    <div class="message-avatar">
                        <div class="robot-face-small">
                            <div class="robot-eyes-small">
                                <div class="robot-eye-small left-eye-small"></div>
                                <div class="robot-eye-small right-eye-small"></div>
                            </div>
                            <div class="robot-mouth-small"></div>
                            <div class="robot-antenna-small"></div>
                        </div>
                    </div>
                                         <div class="message-content">
                         <div class="message-bubble assistant">
                             <div class="assistant-welcome-header">
                                 <h3>👋 Olá! Eu sou o assistente virtual do sistema de registro de chamadas core.</h3>
                                 <p class="assistant-intro">Precisa de ajuda para criar um novo usuário? Posso te ajudar com:</p>
                             </div>
                             
                             <div class="assistant-capabilities">
                                 <ul class="capabilities-list">
                                     <li class="capability-item">
                                         <span class="capability-icon">📝</span>
                                         <div class="capability-content">
                                             <strong>Explicação dos campos do formulário</strong>
                                             <small>Entenda cada campo obrigatório e opcional</small>
                                         </div>
                                     </li>
                                     <li class="capability-item">
                                         <span class="capability-icon">🔐</span>
                                         <div class="capability-content">
                                             <strong>Dicas para criar uma senha segura</strong>
                                             <small>Como gerar senhas fortes e usar o sistema</small>
                                         </div>
                                     </li>
                                     <li class="capability-item">
                                         <span class="capability-icon">✅</span>
                                         <div class="capability-content">
                                             <strong>Validações obrigatórias</strong>
                                             <small>O que precisa ser preenchido corretamente</small>
                                         </div>
                                     </li>
                                     <li class="capability-item">
                                         <span class="capability-icon">🤔</span>
                                         <div class="capability-content">
                                             <strong>Dúvidas sobre o sistema</strong>
                                             <small>Funcionalidades e navegação geral</small>
                                         </div>
                                     </li>
                                 </ul>
                             </div>
                             
                             <div class="assistant-cta">
                                 <p>👉 <strong>O que você gostaria de fazer agora?</strong></p>
                             </div>
                         </div>
                         <div class="message-time">Agora</div>
                     </div>
                </div>
            </div>
            
            <div class="assistant-suggestions">
                <div class="suggestion-btn" onclick="askAssistant('Como criar uma senha forte?')" title="Gerar senhas seguras automaticamente">
                    <i class="fas fa-key"></i>
                    <span class="btn-text">🔐 Criar senha segura</span>
                </div>
                <div class="suggestion-btn" onclick="askAssistant('O que significa usuário administrador?')" title="Entender privilégios de administrador">
                    <i class="fas fa-user-shield"></i>
                    <span class="btn-text">👤 Atribuir perfil admin</span>
                </div>
                <div class="suggestion-btn" onclick="askAssistant('Como preencher o formulário?')" title="Guia dos campos obrigatórios">
                    <i class="fas fa-clipboard-check"></i>
                    <span class="btn-text">✅ Ver campos obrigatórios</span>
                </div>
                <div class="suggestion-btn" onclick="askAssistant('Ajuda geral')" title="Guia geral de uso">
                    <i class="fas fa-question-circle"></i>
                    <span class="btn-text">💡 Ajuda geral</span>
                </div>
            </div>
            
            <div class="assistant-input-area">
                <div class="input-container">
                    <input type="text" id="assistantInput" placeholder="Digite o que precisa fazer..." onkeypress="handleAssistantKeyPress(event)">
                    <button onclick="sendAssistantMessage()" class="send-btn">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    `;
    
    document.body.appendChild(modal);
    
    // Adicionar estilos CSS
    const styles = document.createElement('style');
    styles.textContent = `
        .assistant-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10000;
            display: none;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .assistant-modal.show {
            opacity: 1;
        }
        
        .assistant-modal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }
        
        .assistant-modal-content {
            position: relative;
            width: 90%;
            max-width: 600px;
            height: 80vh;
            background: white;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transform: scale(0.9) translateY(20px);
            transition: transform 0.3s ease;
        }
        
        .assistant-modal.show .assistant-modal-content {
            transform: scale(1) translateY(0);
        }
        
        .assistant-header {
            padding: 20px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            display: flex;
            align-items: center;
            gap: 15px;
            position: relative;
            min-height: 80px;
        }
        
        .assistant-controls {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: auto;
        }
        
        .voice-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        .voice-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
            transform: scale(1.05);
        }
        
        .voice-btn.active {
            background: rgba(34, 197, 94, 0.3);
            border-color: rgba(34, 197, 94, 0.5);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .assistant-avatar {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            min-width: 70px;
        }
        
        .avatar-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #4DA6FF 0%, #6B73FF 100%);
            border: 3px solid rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            position: relative;
            z-index: 2;
            flex-shrink: 0;
            transition: all 0.3s ease;
            box-shadow: 
                0 6px 20px rgba(77, 166, 255, 0.4),
                0 2px 8px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.5);
            animation: assistantGlow 3s ease-in-out infinite;
        }
        
        .avatar-icon:hover {
            transform: scale(1.08) translateY(-2px);
            box-shadow: 
                0 8px 25px rgba(77, 166, 255, 0.6),
                0 4px 12px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.6);
            animation: assistantHoverGlow 1.5s ease-in-out infinite;
        }
        
        .avatar-icon::before {
            content: '';
            position: absolute;
            top: -3px;
            left: -3px;
            right: -3px;
            bottom: -3px;
            background: linear-gradient(135deg, rgba(77, 166, 255, 0.3), rgba(107, 115, 255, 0.3));
            border-radius: 50%;
            z-index: -1;
            opacity: 0;
            transition: all 0.3s ease;
            filter: blur(4px);
        }
        
        .avatar-icon:hover::before {
            opacity: 1;
        }
        
        .avatar-icon i {
            color: white;
            filter: drop-shadow(0 1px 3px rgba(0, 0, 0, 0.3));
            transition: all 0.3s ease;
            position: relative;
        }
        
        /* Estilos para o robô customizado PREMIUM */
        .robot-face {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            animation: robotBreathing 4s ease-in-out infinite;
        }
        
        /* Antena sofisticada com sinal */
        .robot-antenna {
            position: absolute;
            top: -6px;
            left: 50%;
            transform: translateX(-50%);
            width: 3px;
            height: 12px;
            background: linear-gradient(to top, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.95));
            border-radius: 3px;
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.5);
        }
        
        .robot-antenna::before {
            content: '';
            position: absolute;
            top: -5px;
            left: 50%;
            transform: translateX(-50%);
            width: 6px;
            height: 6px;
            background: radial-gradient(circle, rgba(255, 255, 255, 1) 0%, rgba(77, 166, 255, 0.8) 100%);
            border-radius: 50%;
            animation: antennaSignal 2s ease-in-out infinite;
            box-shadow: 
                0 0 12px rgba(255, 255, 255, 0.8),
                0 0 20px rgba(77, 166, 255, 0.4);
        }
        
        .robot-antenna::after {
            content: '';
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 2px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            animation: antennaSignalWaves 3s ease-in-out infinite;
            box-shadow: 
                0 0 6px rgba(255, 255, 255, 0.6),
                0 0 12px rgba(77, 166, 255, 0.3);
        }
        
        /* Estrutura facial mais detalhada */
        .robot-head-structure {
            position: absolute;
            width: 36px;
            height: 36px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
            backdrop-filter: blur(2px);
            z-index: -1;
        }
        
        .robot-head-structure::before {
            content: '';
            position: absolute;
            top: 2px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 1px;
            background: linear-gradient(to right, transparent, rgba(255, 255, 255, 0.3), transparent);
        }
        
        /* Olhos super expressivos */
        .robot-eyes {
            display: flex;
            gap: 10px;
            margin-bottom: 6px;
            position: relative;
            z-index: 2;
        }
        
        .robot-eye {
            width: 10px;
            height: 10px;
            background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 1) 0%, rgba(230, 240, 255, 0.95) 60%, rgba(200, 220, 255, 0.8) 100%);
            border: 1px solid rgba(255, 255, 255, 0.6);
            border-radius: 50%;
            position: relative;
            animation: eyeShine 4s ease-in-out infinite;
            box-shadow: 
                0 0 8px rgba(255, 255, 255, 0.4),
                inset 0 1px 2px rgba(255, 255, 255, 0.8);
            overflow: hidden;
        }
        
        /* Pupilas inteligentes */
        .robot-eye::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 5px;
            height: 5px;
            background: radial-gradient(circle, #1e40af 0%, #2563eb 50%, #3b82f6 100%);
            border-radius: 50%;
            animation: pupilIntelligent 6s ease-in-out infinite;
            box-shadow: 
                0 0 4px rgba(30, 64, 175, 0.6),
                inset 0 1px 1px rgba(255, 255, 255, 0.3);
        }
        
        /* Reflexo nos olhos */
        .robot-eye::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 3px;
            width: 3px;
            height: 2px;
            background: linear-gradient(45deg, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.5));
            border-radius: 50%;
            animation: eyeReflection 3s ease-in-out infinite;
        }
        
        /* Cílios/sobrancelhas expressivas */
        .robot-eye.left-eye::before {
            animation: pupilLeft 6s ease-in-out infinite;
        }
        
        .robot-eye.right-eye::before {
            animation: pupilRight 6s ease-in-out infinite;
        }
        
        /* Boca super expressiva */
        .robot-mouth {
            width: 14px;
            height: 7px;
            border: 2px solid rgba(255, 255, 255, 0.9);
            border-top: none;
            border-radius: 0 0 14px 14px;
            margin-top: 3px;
            position: relative;
            background: linear-gradient(to bottom, transparent 0%, rgba(255, 255, 255, 0.1) 100%);
            animation: mouthExpressive 6s ease-in-out infinite;
            box-shadow: 
                0 2px 4px rgba(0, 0, 0, 0.1),
                inset 0 -1px 2px rgba(255, 255, 255, 0.3);
        }
        
        /* Dentes do robô */
        .robot-mouth::before {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 50%;
            transform: translateX(-50%);
            width: 8px;
            height: 1px;
            background: linear-gradient(to right, transparent, rgba(255, 255, 255, 0.6), transparent);
            border-radius: 1px;
        }
        
        /* Bochechas para expressão */
        .robot-cheeks {
            position: absolute;
            width: 4px;
            height: 4px;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.3), transparent);
            border-radius: 50%;
            animation: cheekGlow 5s ease-in-out infinite;
        }
        
        .robot-cheeks.left-cheek {
            top: 50%;
            left: 8px;
            transform: translateY(-50%);
        }
        
        .robot-cheeks.right-cheek {
            top: 50%;
            right: 8px;
            transform: translateY(-50%);
        }
        
        /* Partículas de energia ao redor */
        .robot-particles {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }
        
        .robot-particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: rgba(77, 166, 255, 0.6);
            border-radius: 50%;
            animation: particleFloat 8s ease-in-out infinite;
        }
        
        .robot-particle:nth-child(1) {
            top: 10%;
            left: 20%;
            animation-delay: 0s;
        }
        
        .robot-particle:nth-child(2) {
            top: 30%;
            right: 15%;
            animation-delay: 2s;
        }
        
        .robot-particle:nth-child(3) {
            bottom: 20%;
            left: 25%;
            animation-delay: 4s;
        }
        
        .robot-particle:nth-child(4) {
            bottom: 15%;
            right: 20%;
            animation-delay: 6s;
        }
        
        .avatar-icon:hover .robot-eye {
            animation: robotBlink 2s ease-in-out infinite;
        }
        
        .avatar-icon:hover .robot-mouth {
            animation: mouthHappy 1s ease-in-out infinite;
        }
        
        @keyframes antennaGlow {
            0%, 100% { 
                box-shadow: 0 0 4px rgba(255, 255, 255, 0.5); 
            }
            50% { 
                box-shadow: 0 0 8px rgba(255, 255, 255, 0.8); 
            }
        }
        
        @keyframes eyeGlow {
            0%, 100% { 
                box-shadow: 0 0 4px rgba(255, 255, 255, 0.3); 
            }
            50% { 
                box-shadow: 0 0 8px rgba(255, 255, 255, 0.6); 
            }
        }
        
        @keyframes pupilMove {
            0%, 100% { 
                transform: translate(-50%, -50%); 
            }
            25% { 
                transform: translate(-30%, -50%); 
            }
            75% { 
                transform: translate(-70%, -50%); 
            }
        }
        
        @keyframes mouthSmile {
            0%, 100% { 
                transform: scaleY(1); 
            }
            50% { 
                transform: scaleY(1.2); 
            }
        }
        
        @keyframes mouthHappy {
            0%, 100% { 
                border-radius: 0 0 12px 12px;
                transform: scaleX(1);
            }
            50% { 
                border-radius: 0 0 16px 16px;
                transform: scaleX(1.1);
            }
        }
        
        /* Animações para o ícone do assistente */
        @keyframes assistantGlow {
            0%, 100% { 
                box-shadow: 
                    0 6px 20px rgba(77, 166, 255, 0.4),
                    0 2px 8px rgba(0, 0, 0, 0.1),
                    inset 0 1px 0 rgba(255, 255, 255, 0.5);
            }
            50% { 
                box-shadow: 
                    0 8px 25px rgba(77, 166, 255, 0.6),
                    0 4px 12px rgba(0, 0, 0, 0.15),
                    inset 0 2px 0 rgba(255, 255, 255, 0.7);
            }
        }
        
        @keyframes assistantHoverGlow {
            0%, 100% { 
                box-shadow: 
                    0 8px 25px rgba(77, 166, 255, 0.6),
                    0 4px 12px rgba(0, 0, 0, 0.15),
                    inset 0 1px 0 rgba(255, 255, 255, 0.6);
            }
            50% { 
                box-shadow: 
                    0 12px 35px rgba(77, 166, 255, 0.8),
                    0 6px 16px rgba(0, 0, 0, 0.2),
                    inset 0 2px 0 rgba(255, 255, 255, 0.8);
            }
        }
        
        @keyframes robotBlink {
            0%, 85%, 100% { 
                transform: scaleY(1);
                opacity: 1; 
            }
            90%, 95% { 
                transform: scaleY(0.1);
                opacity: 0.3; 
            }
        }
        
        /* === ANIMAÇÕES PREMIUM DO ROBÔ === */
        @keyframes robotBreathing {
            0%, 100% { 
                transform: scale(1) translateY(0);
            }
            50% { 
                transform: scale(1.02) translateY(-1px);
            }
        }
        
        @keyframes antennaSignal {
            0%, 100% { 
                opacity: 1;
                transform: translateX(-50%) scale(1);
                box-shadow: 
                    0 0 12px rgba(255, 255, 255, 0.8),
                    0 0 20px rgba(77, 166, 255, 0.4);
            }
            25% { 
                opacity: 0.8;
                transform: translateX(-50%) scale(1.1);
                box-shadow: 
                    0 0 16px rgba(255, 255, 255, 1),
                    0 0 25px rgba(77, 166, 255, 0.6);
            }
            50% { 
                opacity: 1;
                transform: translateX(-50%) scale(1.2);
                box-shadow: 
                    0 0 20px rgba(255, 255, 255, 1.2),
                    0 0 30px rgba(77, 166, 255, 0.8);
            }
            75% { 
                opacity: 0.9;
                transform: translateX(-50%) scale(1.05);
                box-shadow: 
                    0 0 14px rgba(255, 255, 255, 0.9),
                    0 0 22px rgba(77, 166, 255, 0.5);
            }
        }
        
        @keyframes antennaSignalWaves {
            0%, 100% { 
                opacity: 0.8;
                transform: translateX(-50%) scale(1);
            }
            33% { 
                opacity: 1;
                transform: translateX(-50%) scale(1.5);
            }
            66% { 
                opacity: 0.6;
                transform: translateX(-50%) scale(2);
            }
        }
        
        @keyframes eyeShine {
            0%, 100% { 
                box-shadow: 
                    0 0 8px rgba(255, 255, 255, 0.4),
                    inset 0 1px 2px rgba(255, 255, 255, 0.8);
            }
            50% { 
                box-shadow: 
                    0 0 12px rgba(255, 255, 255, 0.6),
                    inset 0 2px 4px rgba(255, 255, 255, 1);
            }
        }
        
        @keyframes pupilIntelligent {
            0%, 100% { 
                transform: translate(-50%, -50%) scale(1);
                box-shadow: 
                    0 0 4px rgba(30, 64, 175, 0.6),
                    inset 0 1px 1px rgba(255, 255, 255, 0.3);
            }
            25% { 
                transform: translate(-30%, -50%) scale(1.1);
                box-shadow: 
                    0 0 6px rgba(30, 64, 175, 0.8),
                    inset 0 1px 2px rgba(255, 255, 255, 0.5);
            }
            50% { 
                transform: translate(-50%, -30%) scale(1);
                box-shadow: 
                    0 0 8px rgba(30, 64, 175, 1),
                    inset 0 2px 3px rgba(255, 255, 255, 0.7);
            }
            75% { 
                transform: translate(-70%, -50%) scale(0.9);
                box-shadow: 
                    0 0 5px rgba(30, 64, 175, 0.7),
                    inset 0 1px 1px rgba(255, 255, 255, 0.4);
            }
        }
        
        @keyframes pupilLeft {
            0%, 100% { 
                transform: translate(-50%, -50%);
            }
            20% { 
                transform: translate(-30%, -40%);
            }
            40% { 
                transform: translate(-60%, -60%);
            }
            60% { 
                transform: translate(-40%, -40%);
            }
            80% { 
                transform: translate(-70%, -50%);
            }
        }
        
        @keyframes pupilRight {
            0%, 100% { 
                transform: translate(-50%, -50%);
            }
            20% { 
                transform: translate(-70%, -40%);
            }
            40% { 
                transform: translate(-40%, -60%);
            }
            60% { 
                transform: translate(-60%, -40%);
            }
            80% { 
                transform: translate(-30%, -50%);
            }
        }
        
        @keyframes eyeReflection {
            0%, 100% { 
                opacity: 0.9;
                transform: scale(1);
            }
            50% { 
                opacity: 1;
                transform: scale(1.2);
            }
        }
        
        @keyframes mouthExpressive {
            0%, 100% { 
                transform: scaleX(1) scaleY(1);
                border-radius: 0 0 14px 14px;
            }
            25% { 
                transform: scaleX(1.1) scaleY(1.2);
                border-radius: 0 0 16px 16px;
            }
            50% { 
                transform: scaleX(1.2) scaleY(1.1);
                border-radius: 0 0 18px 18px;
            }
            75% { 
                transform: scaleX(1.05) scaleY(1.3);
                border-radius: 0 0 15px 15px;
            }
        }
        
        @keyframes cheekGlow {
            0%, 100% { 
                opacity: 0.3;
                transform: translateY(-50%) scale(1);
            }
            50% { 
                opacity: 0.6;
                transform: translateY(-50%) scale(1.2);
            }
        }
        
        @keyframes particleFloat {
            0%, 100% { 
                opacity: 0.6;
                transform: translateY(0) scale(1);
            }
            25% { 
                opacity: 1;
                transform: translateY(-10px) scale(1.2);
            }
            50% { 
                opacity: 0.8;
                transform: translateY(-5px) scale(0.8);
            }
            75% { 
                opacity: 0.4;
                transform: translateY(-15px) scale(1.5);
            }
        }
        
        /* Estados especiais do robô */
        .avatar-icon:hover .robot-eye {
            animation: eyeExcited 1.5s ease-in-out infinite;
        }
        
        .avatar-icon:hover .robot-mouth {
            animation: mouthHappy 1s ease-in-out infinite;
        }
        
        .avatar-icon:hover .robot-antenna::before {
            animation: antennaExcited 1s ease-in-out infinite;
        }
        
        @keyframes eyeExcited {
            0%, 100% { 
                transform: scaleY(1) scaleX(1);
            }
            50% { 
                transform: scaleY(1.3) scaleX(1.1);
            }
        }
        
        @keyframes antennaExcited {
            0%, 100% { 
                box-shadow: 
                    0 0 12px rgba(255, 255, 255, 0.8),
                    0 0 20px rgba(77, 166, 255, 0.4);
            }
            50% { 
                box-shadow: 
                    0 0 20px rgba(255, 255, 255, 1.2),
                    0 0 35px rgba(77, 166, 255, 0.8);
            }
        }
        
        .avatar-status {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 12px;
            opacity: 0.98;
            font-weight: 500;
            margin-top: 12px;
            line-height: 1.2;
            position: relative;
            z-index: 1;
            width: 100%;
            text-align: center;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.3) 0%, rgba(255, 255, 255, 0.2) 100%);
            border: 2px solid rgba(255, 255, 255, 0.5);
            border-radius: 20px;
            padding: 8px 16px;
            backdrop-filter: blur(20px);
            box-shadow: 
                0 6px 16px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.5);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .status-indicator {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 12px;
            height: 12px;
        }
        
        .status-ripple {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 8px;
            height: 8px;
            background: rgba(0, 255, 136, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            animation: statusRipple 2s ease-out infinite;
            z-index: -1;
        }
        
        .status-text {
            font-weight: 600;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            color: rgba(255, 255, 255, 0.98);
            text-shadow: 
                0 1px 3px rgba(0, 0, 0, 0.3),
                0 0 10px rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }
        
        .status-tooltip {
            position: absolute;
            bottom: -35px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 11px;
            font-weight: 400;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 10;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .status-tooltip::before {
            content: '';
            position: absolute;
            top: -4px;
            left: 50%;
            transform: translateX(-50%);
            width: 8px;
            height: 8px;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-bottom: none;
            border-right: none;
            transform: translateX(-50%) rotate(45deg);
        }
        
        .status-click-hint {
            position: absolute;
            top: -12px;
            right: -8px;
            font-size: 8px;
            opacity: 0.7;
            animation: clickHint 3s ease-in-out infinite;
            pointer-events: none;
        }
        
        @keyframes clickHint {
            0%, 70%, 100% { 
                opacity: 0;
                transform: translateY(0px);
            }
            75%, 95% { 
                opacity: 0.7;
                transform: translateY(-2px);
            }
        }
        
        .avatar-status span {
            text-align: center;
            font-size: 11px;
            font-weight: 700;
            white-space: nowrap;
            overflow: visible;
            color: rgba(255, 255, 255, 0.98);
            display: block;
            text-shadow: 
                0 1px 3px rgba(0, 0, 0, 0.3),
                0 0 8px rgba(255, 255, 255, 0.2);
            letter-spacing: 0.5px;
            text-transform: uppercase;
            transition: all 0.3s ease;
        }
        
        .avatar-status:hover {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.4) 0%, rgba(255, 255, 255, 0.3) 100%);
            border-color: rgba(255, 255, 255, 0.7);
            transform: scale(1.08) translateY(-2px);
            box-shadow: 
                0 8px 20px rgba(0, 0, 0, 0.25),
                inset 0 2px 0 rgba(255, 255, 255, 0.6);
        }
        
        .avatar-status:hover .status-text {
            color: rgba(255, 255, 255, 1);
            text-shadow: 
                0 1px 4px rgba(0, 0, 0, 0.4),
                0 0 16px rgba(255, 255, 255, 0.5);
            letter-spacing: 1px;
        }
        
        .avatar-status:hover .status-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(-5px);
        }
        
        .avatar-status:hover .status-dot {
            animation: statusPulseHover 1.5s ease-in-out infinite;
            box-shadow: 
                0 0 24px rgba(0, 255, 136, 0.9), 
                0 4px 8px rgba(0, 0, 0, 0.2),
                inset 0 2px 0 rgba(255, 255, 255, 0.8);
        }
        
        .avatar-status:hover .status-ripple {
            animation: statusRippleHover 1.2s ease-out infinite;
        }
        
        /* Estados dinâmicos - Online/Offline */
        .avatar-status.online .status-text {
            color: rgba(255, 255, 255, 0.98);
        }
        
        .avatar-status.offline {
            background: linear-gradient(135deg, rgba(128, 128, 128, 0.3) 0%, rgba(128, 128, 128, 0.2) 100%);
            border-color: rgba(255, 255, 255, 0.3);
        }
        
        .avatar-status.offline .status-dot {
            background: linear-gradient(135deg, #ff6b6b 0%, #d63031 100%);
            box-shadow: 
                0 0 16px rgba(255, 107, 107, 0.7), 
                0 3px 6px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.6);
            animation: statusPulseOffline 3s ease-in-out infinite;
        }
        
        .avatar-status.offline .status-text {
            color: rgba(255, 255, 255, 0.8);
        }
        
        .avatar-status.offline .status-ripple {
            background: rgba(255, 107, 107, 0.3);
            animation: statusRippleOffline 3s ease-out infinite;
        }
        
        /* Regras específicas e forçadas para o modal do assistente */
        .assistant-modal .assistant-header .assistant-avatar {
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
            justify-content: center !important;
            gap: 12px !important;
            min-height: 80px !important;
            padding: 8px !important;
            min-width: 90px !important;
            transition: all 0.3s ease !important;
        }
        
        .assistant-modal .assistant-header .assistant-avatar:hover {
            transform: translateY(-2px) !important;
        }
        
        .assistant-modal .assistant-header .avatar-icon {
            margin: 0 !important;
            display: block !important;
            position: static !important;
        }
        
        .assistant-modal .assistant-header .avatar-status {
            margin: 0 !important;
            margin-top: 10px !important;
            padding: 5px 10px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            text-align: center !important;
            width: auto !important;
            min-width: 60px !important;
            position: static !important;
            background: rgba(255, 255, 255, 0.15) !important;
            border: 1px solid rgba(255, 255, 255, 0.25) !important;
            border-radius: 14px !important;
            backdrop-filter: blur(12px) !important;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.15) !important;
            transition: all 0.3s ease !important;
        }
        
        .assistant-modal .assistant-header .avatar-status:hover {
            background: rgba(255, 255, 255, 0.2) !important;
            border-color: rgba(255, 255, 255, 0.35) !important;
            transform: scale(1.05) !important;
        }
        
        .assistant-modal .assistant-header .avatar-status span {
            display: block !important;
            text-align: center !important;
            width: auto !important;
            margin: 0 !important;
            padding: 0 !important;
            font-size: 11px !important;
            font-weight: 600 !important;
            color: rgba(255, 255, 255, 0.95) !important;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3) !important;
            letter-spacing: 0.4px !important;
            white-space: nowrap !important;
        }
        
        .status-dot {
            width: 10px;
            height: 10px;
            background: linear-gradient(135deg, #00ff88 0%, #00d166 100%);
            border: 2px solid rgba(255, 255, 255, 0.95);
            border-radius: 50%;
            animation: statusPulse 2.5s ease-in-out infinite;
            flex-shrink: 0;
            box-shadow: 
                0 0 16px rgba(0, 255, 136, 0.7), 
                0 3px 6px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.6);
            position: relative;
            z-index: 2;
        }
        
        .status-dot::before {
            content: '';
            position: absolute;
            top: -4px;
            left: -4px;
            right: -4px;
            bottom: -4px;
            background: radial-gradient(circle, rgba(0, 255, 136, 0.4) 0%, rgba(0, 255, 136, 0.1) 50%, transparent 70%);
            border-radius: 50%;
            z-index: -1;
            animation: statusGlow 2.5s ease-in-out infinite;
            filter: blur(2px);
        }
        
        .status-dot::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 4px;
            height: 4px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            animation: statusShine 3s ease-in-out infinite;
        }
        
        .assistant-modal .assistant-header .status-dot {
            width: 7px !important;
            height: 7px !important;
            margin-right: 4px !important;
        }
        
        @keyframes statusPulse {
            0%, 100% { 
                opacity: 1; 
                transform: scale(1);
                box-shadow: 
                    0 0 12px rgba(0, 255, 136, 0.6), 
                    0 2px 4px rgba(0, 0, 0, 0.1),
                    inset 0 1px 0 rgba(255, 255, 255, 0.5);
            }
            50% { 
                opacity: 0.8; 
                transform: scale(1.15);
                box-shadow: 
                    0 0 20px rgba(0, 255, 136, 0.8), 
                    0 4px 8px rgba(0, 0, 0, 0.15),
                    inset 0 2px 0 rgba(255, 255, 255, 0.7);
            }
        }
        
        @keyframes statusGlow {
            0%, 100% { 
                opacity: 0.4;
                transform: scale(1);
            }
            50% { 
                opacity: 0.8;
                transform: scale(1.2);
            }
        }
        
        @keyframes statusShine {
            0%, 80%, 100% { 
                opacity: 0.8;
                transform: translate(-50%, -50%) scale(1);
            }
            90% { 
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.3);
            }
        }
        
        @keyframes statusRipple {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 0.8;
            }
            50% {
                opacity: 0.4;
            }
            100% {
                transform: translate(-50%, -50%) scale(3);
                opacity: 0;
            }
        }
        
        @keyframes statusRippleHover {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 1;
            }
            50% {
                opacity: 0.6;
            }
            100% {
                transform: translate(-50%, -50%) scale(2.5);
                opacity: 0;
            }
        }
        
        @keyframes statusRippleOffline {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 0.6;
            }
            50% {
                opacity: 0.3;
            }
            100% {
                transform: translate(-50%, -50%) scale(2);
                opacity: 0;
            }
        }
        
        @keyframes statusPulseHover {
            0%, 100% { 
                opacity: 1; 
                transform: scale(1);
                box-shadow: 
                    0 0 24px rgba(0, 255, 136, 0.9), 
                    0 4px 8px rgba(0, 0, 0, 0.2),
                    inset 0 2px 0 rgba(255, 255, 255, 0.8);
            }
            50% { 
                opacity: 0.9; 
                transform: scale(1.2);
                box-shadow: 
                    0 0 32px rgba(0, 255, 136, 1), 
                    0 6px 12px rgba(0, 0, 0, 0.25),
                    inset 0 3px 0 rgba(255, 255, 255, 0.9);
            }
        }
        
        @keyframes statusPulseOffline {
            0%, 100% { 
                opacity: 1; 
                transform: scale(1);
                box-shadow: 
                    0 0 16px rgba(255, 107, 107, 0.7), 
                    0 3px 6px rgba(0, 0, 0, 0.15),
                    inset 0 1px 0 rgba(255, 255, 255, 0.6);
            }
            50% { 
                opacity: 0.7; 
                transform: scale(1.1);
                box-shadow: 
                    0 0 20px rgba(255, 107, 107, 0.8), 
                    0 4px 8px rgba(0, 0, 0, 0.2),
                    inset 0 2px 0 rgba(255, 255, 255, 0.7);
            }
        }
        
        .assistant-info {
            flex: 1;
        }
        
        .assistant-info h3 {
            margin: 0;
            font-size: 20px;
            font-weight: 600;
        }
        
        .assistant-info p {
            margin: 5px 0 0 0;
            opacity: 0.8;
            font-size: 14px;
        }
        
        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            padding: 10px;
            border-radius: 50%;
            transition: all 0.2s ease;
        }
        
        .close-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .assistant-chat {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .welcome-message, .chat-message {
            display: flex;
            gap: 10px;
            align-items: flex-start;
        }
        
        .message-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #4DA6FF 0%, #6B73FF 100%);
            border: 2px solid rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 16px;
            flex-shrink: 0;
            box-shadow: 0 4px 12px rgba(77, 166, 255, 0.3);
        }
        
        /* Robô pequeno para mensagens - PREMIUM */
        .robot-face-small {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            scale: 0.8;
            animation: robotBreathing 4s ease-in-out infinite;
        }
        
        .robot-antenna-small {
            position: absolute;
            top: -2px;
            left: 50%;
            transform: translateX(-50%);
            width: 1px;
            height: 4px;
            background: linear-gradient(to top, rgba(255, 255, 255, 0.6), rgba(255, 255, 255, 0.95));
            border-radius: 1px;
        }
        
        .robot-antenna-small::before {
            content: '';
            position: absolute;
            top: -2px;
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 2px;
            background: radial-gradient(circle, rgba(255, 255, 255, 1) 0%, rgba(77, 166, 255, 0.8) 100%);
            border-radius: 50%;
            animation: antennaSignal 2s ease-in-out infinite;
            box-shadow: 
                0 0 4px rgba(255, 255, 255, 0.6),
                0 0 8px rgba(77, 166, 255, 0.3);
        }
        
        .robot-eyes-small {
            display: flex;
            gap: 5px;
            margin-bottom: 3px;
        }
        
        .robot-eye-small {
            width: 6px;
            height: 6px;
            background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 1) 0%, rgba(230, 240, 255, 0.95) 60%, rgba(200, 220, 255, 0.8) 100%);
            border: 0.5px solid rgba(255, 255, 255, 0.6);
            border-radius: 50%;
            position: relative;
            animation: eyeShine 4s ease-in-out infinite;
            box-shadow: 
                0 0 4px rgba(255, 255, 255, 0.3),
                inset 0 1px 1px rgba(255, 255, 255, 0.6);
        }
        
        .robot-eye-small::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 3px;
            height: 3px;
            background: radial-gradient(circle, #1e40af 0%, #2563eb 50%, #3b82f6 100%);
            border-radius: 50%;
            animation: pupilIntelligent 6s ease-in-out infinite;
            box-shadow: 
                0 0 2px rgba(30, 64, 175, 0.4),
                inset 0 0.5px 0.5px rgba(255, 255, 255, 0.2);
        }
        
        .robot-eye-small::after {
            content: '';
            position: absolute;
            top: 1px;
            left: 2px;
            width: 1.5px;
            height: 1px;
            background: linear-gradient(45deg, rgba(255, 255, 255, 0.8), rgba(255, 255, 255, 0.4));
            border-radius: 50%;
            animation: eyeReflection 3s ease-in-out infinite;
        }
        
        .robot-eye-small.left-eye-small::before {
            animation: pupilLeft 6s ease-in-out infinite;
        }
        
        .robot-eye-small.right-eye-small::before {
            animation: pupilRight 6s ease-in-out infinite;
        }
        
        .robot-mouth-small {
            width: 10px;
            height: 5px;
            border: 1px solid rgba(255, 255, 255, 0.9);
            border-top: none;
            border-radius: 0 0 10px 10px;
            margin-top: 2px;
            position: relative;
            background: linear-gradient(to bottom, transparent 0%, rgba(255, 255, 255, 0.1) 100%);
            animation: mouthExpressive 6s ease-in-out infinite;
            box-shadow: 
                0 1px 2px rgba(0, 0, 0, 0.1),
                inset 0 -0.5px 1px rgba(255, 255, 255, 0.2);
        }
        
        .robot-mouth-small::before {
            content: '';
            position: absolute;
            bottom: -0.5px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 0.5px;
            background: linear-gradient(to right, transparent, rgba(255, 255, 255, 0.4), transparent);
            border-radius: 0.5px;
        }
        
        .user-message .message-avatar {
            background: var(--gray-400);
            order: 2;
        }
        
        .user-message {
            flex-direction: row-reverse;
        }
        
        .message-content {
            flex: 1;
            max-width: 80%;
        }
        
        .user-message .message-content {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }
        
        .message-bubble {
            background: var(--gray-100);
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 5px;
            position: relative;
            word-wrap: break-word;
        }
        
        .message-bubble.assistant {
            background: #f0fdf4;
            border: 1px solid #bbf7d0;
            color: #1f2937;
            line-height: 1.6;
        }
        
        /* ===== ESTILOS PARA INTERFACE MELHORADA DO ASSISTENTE ===== */
        .assistant-welcome-header h3 {
            margin: 0 0 12px 0;
            font-size: 18px;
            font-weight: 700;
            color: #059669;
            line-height: 1.4;
        }
        
        .assistant-intro {
            margin: 0 0 20px 0;
            font-size: 14px;
            color: #4b5563;
            line-height: 1.5;
            font-weight: 400;
        }
        
        .assistant-capabilities h4 {
            margin: 0 0 16px 0;
            font-size: 16px;
            font-weight: 600;
            color: #047857;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .capabilities-list {
            list-style: none;
            padding: 0;
            margin: 0 0 20px 0;
        }
        
        .capability-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 12px;
            margin-bottom: 8px;
            background: rgba(16, 185, 129, 0.05);
            border: 1px solid rgba(16, 185, 129, 0.1);
            border-radius: 12px;
            transition: all 0.2s ease;
        }
        
        .capability-item:hover {
            background: rgba(16, 185, 129, 0.08);
            border-color: rgba(16, 185, 129, 0.2);
            transform: translateX(4px);
        }
        
        .capability-icon {
            font-size: 20px;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(16, 185, 129, 0.1);
            border-radius: 8px;
            flex-shrink: 0;
        }
        
        .capability-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        
        .capability-content strong {
            font-size: 14px;
            font-weight: 600;
            color: #1f2937;
            line-height: 1.3;
        }
        
        .capability-content small {
            font-size: 12px;
            color: #6b7280;
            line-height: 1.4;
            margin-top: 2px;
        }
        
        .assistant-cta {
            margin-top: 16px;
            padding: 16px;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.1) 0%, rgba(52, 211, 153, 0.1) 100%);
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: 12px;
            text-align: center;
        }
        
        .assistant-cta p {
            margin: 0;
            font-size: 14px;
            color: #1f2937;
            line-height: 1.5;
        }
        
        .assistant-cta strong {
            color: #047857;
            font-weight: 600;
        }
        
        /* Melhorar contraste dos botões de sugestão */
        .suggestion-btn {
            background: #ffffff;
            border: 2px solid #10b981;
            color: #047857;
            padding: 12px 16px;
            border-radius: 16px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 2px 4px rgba(16, 185, 129, 0.1);
            min-height: 48px;
            flex: 1;
            justify-content: flex-start;
            text-align: left;
            position: relative;
            overflow: hidden;
        }
        
        .suggestion-btn:hover {
            background: #10b981;
            color: #ffffff;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
            border-color: #059669;
        }
        
        .suggestion-btn i {
            font-size: 16px;
            width: 20px;
            text-align: center;
            flex-shrink: 0;
        }
        
        .suggestion-btn .btn-text {
            flex: 1;
            font-weight: 600;
            line-height: 1.3;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .suggestion-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s ease;
        }
        
        .suggestion-btn:hover::before {
            left: 100%;
        }
        
        /* Melhorar layout dos botões */
        .assistant-suggestions {
            padding: 15px 20px;
            border-top: 1px solid var(--border);
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);
        }
        
        /* Melhorar a área de input */
        .assistant-input-area {
            padding: 20px;
            border-top: 2px solid #e5e7eb;
            background: linear-gradient(135deg, #f9fafb 0%, #ffffff 100%);
        }
        
        .input-container input {
            flex: 1;
            padding: 14px 18px;
            border: 2px solid #d1d5db;
            border-radius: 28px;
            font-size: 14px;
            outline: none;
            transition: all 0.3s ease;
            background: #ffffff;
            color: #1f2937;
        }
        
        .input-container input:focus {
            border-color: #10b981;
            box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.1);
        }
        
        .input-container input::placeholder {
            color: #9ca3af;
            font-weight: 400;
        }
        
        .send-btn {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }
        
        .send-btn:hover {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            transform: scale(1.05);
            box-shadow: 0 6px 16px rgba(16, 185, 129, 0.4);
        }
        
        /* ===== MELHORAR FORMATAÇÃO DAS RESPOSTAS DO ASSISTENTE ===== */
        .message-bubble.assistant p {
            margin: 0 0 12px 0;
            line-height: 1.6;
        }
        
        .message-bubble.assistant p:last-child {
            margin-bottom: 0;
        }
        
        .message-bubble.assistant ul {
            margin: 12px 0;
            padding-left: 20px;
            list-style-type: none;
        }
        
        .message-bubble.assistant li {
            margin: 8px 0;
            padding-left: 24px;
            position: relative;
            line-height: 1.5;
        }
        
        .message-bubble.assistant li::before {
            content: '✓';
            position: absolute;
            left: 0;
            top: 0;
            color: #10b981;
            font-weight: bold;
            font-size: 14px;
        }
        
        .message-bubble.assistant strong {
            color: #047857;
            font-weight: 600;
        }
        
        .message-bubble.assistant em {
            color: #059669;
            font-style: italic;
            font-weight: 500;
        }
        
        /* Melhorar títulos nas respostas */
        .message-bubble.assistant h3,
        .message-bubble.assistant h4 {
            color: #047857;
            margin: 0 0 12px 0;
            font-weight: 600;
            line-height: 1.3;
        }
        
        .message-bubble.assistant h3 {
            font-size: 16px;
        }
        
        .message-bubble.assistant h4 {
            font-size: 14px;
        }
        
        /* Estilos para botões de ação das mensagens */
        .message-actions {
            margin-top: 12px;
            padding-top: 8px;
            border-top: 1px solid rgba(16, 185, 129, 0.1);
            display: flex;
            justify-content: flex-end;
            gap: 8px;
        }
        
        .voice-read-btn {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.2);
            color: #047857;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            transition: all 0.3s ease;
        }
        
        .voice-read-btn:hover {
            background: #10b981;
            color: white;
            border-color: #059669;
            transform: scale(1.1);
        }
        
        .voice-read-btn.playing {
            background: #ef4444;
            color: white;
            border-color: #dc2626;
            animation: reading-pulse 1s infinite;
        }
        
        @keyframes reading-pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        /* Modo de alta acessibilidade */
        .accessibility-mode {
            font-size: 16px !important;
            line-height: 1.8 !important;
            contrast: 150% !important;
        }
        
        .accessibility-mode .message-bubble {
            font-size: 16px !important;
            line-height: 1.8 !important;
            padding: 20px !important;
        }
        
        .accessibility-mode .suggestion-btn {
            font-size: 16px !important;
            padding: 16px 20px !important;
            min-height: 56px !important;
        }
        
        .accessibility-mode .voice-btn {
            width: 44px !important;
            height: 44px !important;
            font-size: 16px !important;
        }
        
        /* Melhorar responsividade do modal */
        @media (max-width: 768px) {
            .assistant-modal-content {
                width: 95%;
                height: 90vh;
                margin: 10px;
            }
            
            .assistant-header {
                padding: 15px;
                min-height: 60px;
            }
            
            .avatar-icon {
                width: 40px;
                height: 40px;
                font-size: 18px;
            }
            
            .assistant-info h3 {
                font-size: 16px;
            }
            
            .assistant-info p {
                font-size: 12px;
            }
            
            .capability-item {
                padding: 10px;
            }
            
            .capability-icon {
                font-size: 16px;
                width: 24px;
                height: 24px;
            }
            
            .suggestion-btn {
                font-size: 12px;
                padding: 8px 12px;
            }
            
            .assistant-controls {
                gap: 6px;
            }
            
            .voice-btn {
                width: 32px;
                height: 32px;
                font-size: 12px;
            }
            
            .avatar-status {
                gap: 6px;
                font-size: 11px;
                padding: 6px 12px;
                border-radius: 16px;
                margin-top: 8px;
            }
            
            .status-text {
                font-size: 11px;
                letter-spacing: 0.6px;
            }
            
            .status-dot {
                width: 8px;
                height: 8px;
            }
            
            .status-indicator {
                width: 10px;
                height: 10px;
            }
            
            .status-tooltip {
                font-size: 10px;
                padding: 4px 8px;
                bottom: -30px;
            }
        }
        
        .message-bubble.user {
            background: var(--primary);
            color: white;
        }
        
        .message-bubble ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        
        .message-bubble li {
            margin: 5px 0;
        }
        
        .message-time {
            font-size: 12px;
            color: var(--gray-500);
            margin-top: 5px;
        }
        
        .assistant-suggestions {
            padding: 15px 20px;
            border-top: 1px solid var(--border);
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .suggestion-btn {
            background: var(--emerald-50);
            border: 1px solid var(--emerald-200);
            color: var(--emerald-700);
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .suggestion-btn:hover {
            background: var(--emerald-100);
            border-color: var(--emerald-300);
        }
        
        .assistant-input-area {
            padding: 20px;
            border-top: 1px solid var(--border);
            background: var(--gray-50);
        }
        
        .input-container {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .input-container input {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid var(--border);
            border-radius: 25px;
            font-size: 14px;
            outline: none;
            transition: all 0.2s ease;
        }
        
        .input-container input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }
        
        .send-btn {
            width: 40px;
            height: 40px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }
        
        .send-btn:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        @media (max-width: 768px) {
            .assistant-modal-content {
                width: 95%;
                height: 90vh;
                margin: 20px;
            }
            
            .suggestion-btn {
                font-size: 11px;
                padding: 6px 10px;
            }
        }
    `;
    
    document.head.appendChild(styles);
}

function closeAssistant() {
    // Parar qualquer síntese de voz em andamento
    stopSpeaking();
    
    const modal = document.getElementById('assistantModal');
    if (modal) {
        modal.classList.remove('show');
        setTimeout(() => {
            modal.style.display = 'none';
        }, 300);
    }
}

function initializeAssistantChat() {
    // Já inicializado com a mensagem de boas-vindas no HTML
    console.log('💬 Chat do assistente inicializado');
}

function handleAssistantKeyPress(event) {
    if (event.key === 'Enter') {
        sendAssistantMessage();
    }
}

function sendAssistantMessage() {
    const input = document.getElementById('assistantInput');
    const message = input.value.trim();
    
    if (!message) return;
    
    // Adicionar mensagem do usuário
    addChatMessage(message, 'user');
    
    // Limpar input
    input.value = '';
    
    // Responder após delay
    setTimeout(() => {
        const response = getAssistantResponse(message);
        addChatMessage(response, 'assistant');
    }, 1000);
}

function askAssistant(question) {
    const input = document.getElementById('assistantInput');
    input.value = question;
    sendAssistantMessage();
}

function addChatMessage(message, sender) {
    const chat = document.getElementById('assistantChat');
    const messageDiv = document.createElement('div');
    messageDiv.className = `chat-message ${sender}-message`;
    
    const avatarIcon = sender === 'assistant' ? 'fas fa-robot' : 'fas fa-user';
    const now = new Date().toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
    const formattedMessage = formatMessage(message);
    
    const avatarContent = sender === 'assistant' ? `
        <div class="robot-face-small">
            <div class="robot-eyes-small">
                <div class="robot-eye-small"></div>
                <div class="robot-eye-small"></div>
            </div>
            <div class="robot-mouth-small"></div>
        </div>
    ` : `<i class="${avatarIcon}"></i>`;
    
    messageDiv.innerHTML = `
        <div class="message-avatar">
            ${avatarContent}
        </div>
        <div class="message-content">
            <div class="message-bubble ${sender}" role="article" aria-live="polite">
                ${formattedMessage}
                ${sender === 'assistant' ? `
                    <div class="message-actions">
                        <button class="voice-read-btn" onclick="speakMessage(this)" title="Ler mensagem em voz alta" aria-label="Ler esta mensagem">
                            <i class="fas fa-play"></i>
                        </button>
                    </div>
                ` : ''}
            </div>
            <div class="message-time">${now}</div>
        </div>
    `;
    
    chat.appendChild(messageDiv);
    
    // Animação de entrada suave
    messageDiv.style.opacity = '0';
    messageDiv.style.transform = 'translateY(10px)';
    requestAnimationFrame(() => {
        messageDiv.style.transition = 'all 0.3s ease';
        messageDiv.style.opacity = '1';
        messageDiv.style.transform = 'translateY(0)';
    });
    
    // Auto-scroll suave
    setTimeout(() => {
        chat.scrollTo({
            top: chat.scrollHeight,
            behavior: 'smooth'
        });
    }, 100);
    
    // Leitura automática se habilitada
    if (sender === 'assistant' && window.voiceReadingEnabled) {
        setTimeout(() => speakText(message.replace(/[*#]/g, '')), 300);
    }
}

function formatMessage(message) {
    // Converter quebras de linha em <br> e listas em HTML com melhor formatação
    return message
        .replace(/\n/g, '<br>')
        .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
        .replace(/\*(.*?)\*/g, '<em>$1</em>')
        .replace(/(?:^|\n)###\s(.*?)(?=\n|$)/g, '<h4>$1</h4>')
        .replace(/(?:^|\n)##\s(.*?)(?=\n|$)/g, '<h3>$1</h3>')
        .replace(/(?:^|\n)#\s(.*?)(?=\n|$)/g, '<h3>$1</h3>');
}

function getAssistantResponse(message) {
    const lowerMessage = message.toLowerCase();
    
    // Respostas baseadas em palavras-chave
    if (lowerMessage.includes('senha') || lowerMessage.includes('password')) {
        return `🔐 ## Crie uma senha forte agora:

**Faça isso:**
• Clique no botão "Gerar Senha" ao lado do campo
• Ou digite pelo menos 8 caracteres misturando letras, números e símbolos
• Veja o medidor de força ficar verde antes de continuar

**Ação rápida:** Use o gerador automático - ele cria senhas seguras em 1 clique!

*Observe a barra de força enquanto digita. Verde = senha aprovada! ✅*`;
    }
    
    if (lowerMessage.includes('administrador') || lowerMessage.includes('admin') || lowerMessage.includes('staff')) {
        return `👑 ## Decidindo sobre privilégios de admin:

**O que um admin pode fazer:**
• Criar, editar e desativar outros usuários
• Acessar todas as configurações do sistema
• Ver e exportar todos os relatórios
• Gerenciar unidades de saúde
• Fazer backup dos dados

**🎯 Sua decisão:** Marque "Administrador" apenas se esta pessoa precisa gerenciar o sistema.

**⚠️ Regra de ouro:** Quando em dúvida, não marque. Você pode alterar isso depois!`;
    }
    
    if (lowerMessage.includes('formulário') || lowerMessage.includes('preencher') || lowerMessage.includes('campo')) {
        return `📝 ## Preencha o formulário assim:

### ✅ Campos obrigatórios - preencha primeiro:
• **Nome:** Digite o nome completo da pessoa
• **Nome de usuário:** Crie um login único *(só letras, números e _)*
• **Senha:** Use o gerador ou digite 8+ caracteres fortes
• **Confirmar senha:** Repita a senha exatamente igual

### 🔧 Campos opcionais - pode pular:
• **Sobrenome:** Complete o nome se quiser
• **Email:** Adicione para recuperação de senha

### ⚙️ Configurações - decida agora:
• **Usuário ativo:** ✅ Deixe marcado para permitir login
• **Administrador:** 👑 Só marque se for gestor do sistema

**🚀 Próximo passo:** Clique em "Criar Usuário" quando tudo estiver preenchido!`;
    }
    
    if (lowerMessage.includes('ativo') || lowerMessage.includes('inativo')) {
        return `✅ ## Configure o status do usuário:

**Marque "Usuário Ativo"** → A pessoa pode fazer login imediatamente

**Desmarque "Usuário Ativo"** → A pessoa não consegue entrar no sistema (útil para contas temporárias)

**🎯 Recomendação:** Deixe sempre marcado, a menos que seja uma conta de teste.

**💡 Flexibilidade:** Você pode ativar/desativar usuários a qualquer momento depois!`;
    }
    
    if (lowerMessage.includes('username') || lowerMessage.includes('login')) {
        return `🆔 ## Crie o nome de usuário (login):

**Digite assim:**
• Só letras minúsculas, números e underscore (_)
• Pelo menos 3 caracteres
• Sem espaços nem acentos

**Exemplos que funcionam:**
• joao_silva, maria123, admin_sistema

**🔍 Verificação automática:** O sistema te avisa se o nome já existe enquanto você digita!

**✅ Quando aparecer a marca verde** → nome está livre para usar!`;
    }
    
    if (lowerMessage.includes('email')) {
        return `📧 ## Configure o email do usuário:

**Pode preencher ou pular** - é opcional

**Se preencheu:**
• Use um email que a pessoa realmente acessa
• Será usado para recuperar senha esquecida
• Cada email só pode ser usado uma vez no sistema

**🎯 Recomendação:** Sempre coloque se souber o email - facilita muito se a pessoa esquecer a senha!

**✅ Validação automática:** Sistema verifica se o formato está correto!`;
    }
    
    if (lowerMessage.includes('ajuda') || lowerMessage.includes('help') || lowerMessage.includes('dúvida')) {
        return `🤝 ## Escolha o que precisa fazer:

**🎯 Ações rápidas:**
• **Clique em "Senha Forte"** → para gerar senhas seguras
• **Clique em "Admin"** → para entender privilégios 
• **Clique em "Formulário"** → para guia completo de preenchimento

**💬 Ou digite diretamente:**
• "Como criar senha?" 
• "O que é administrador?"
• "Campo obrigatório"

**🚀 Próxima ação:** Use os botões coloridos abaixo ou digite sua dúvida específica!`;
    }
    
    if (lowerMessage.includes('obrigado') || lowerMessage.includes('valeu') || lowerMessage.includes('thanks')) {
        return `😊 ## Por nada! Continue criando o usuário:

**🚀 Próximos passos:**
• **Continue preenchendo** os campos do formulário
• **Clique em "Criar Usuário"** quando terminar
• **Teste o login** com o novo usuário criado

**💬 Precisa de mais alguma coisa?** Digite aqui ou use os botões rápidos!

**🤖 Estou sempre aqui** para ajudar com qualquer dúvida do sistema!`;
    }
    
    // Resposta padrão
    return `🤔 Entendi! Sobre "${message}" posso te ajudar assim:

**🎯 Faça isso agora:**
• **Clique em "Formulário"** → guia completo de preenchimento
• **Clique em "Senha Forte"** → criar senhas seguras rapidamente
• **Clique em "Admin"** → entender permissões de administrador
• **Clique em "Ajuda"** → ver todas as opções

**💡 Ou seja mais específico:** Digite uma pergunta mais detalhada sobre o que precisa fazer!

**⚡ Ação rápida:** Use os botões coloridos abaixo - são mais rápidos!`;
}

// ===== LOADING SCREEN =====
function hideLoadingScreen() {
    const loadingScreen = document.getElementById('loadingScreen');
    if (loadingScreen) {
        loadingScreen.classList.add('hidden');
        setTimeout(() => {
            loadingScreen.style.display = 'none';
        }, 500);
    }
}

// ===== VALIDAÇÃO PREMIUM PARA NOVOS CAMPOS =====
function validateCurrentStep() {
    const currentStepEl = document.querySelector(`.step-panel[data-step="${currentStep}"]`);
    if (!currentStepEl) return true;
    
    const requiredFields = currentStepEl.querySelectorAll('input[required]');
    let isValid = true;
    
    requiredFields.forEach(field => {
        if (!validateField(field)) {
            isValid = false;
        }
    });
    
    return isValid;
}

function validateField(field) {
    const value = field.value.trim();
    const feedback = document.getElementById(field.id + '_feedback');
    let isValid = true;
    let message = '';
    
    // Limpar classes anteriores
    field.classList.remove('valid', 'invalid');
    field.parentElement.classList.remove('valid', 'invalid');
    
    switch (field.id) {
        case 'first_name':
            if (!value) {
                isValid = false;
                message = 'Nome é obrigatório';
            } else if (value.length < 2) {
                isValid = false;
                message = 'Nome deve ter pelo menos 2 caracteres';
            } else {
                message = 'Nome válido ✓';
            }
            break;
            
        case 'username':
            if (!value) {
                isValid = false;
                message = 'Nome de usuário é obrigatório';
            } else if (value.length < 3) {
                isValid = false;
                message = 'Nome de usuário deve ter pelo menos 3 caracteres';
            } else if (!/^[a-z0-9_]+$/.test(value)) {
                isValid = false;
                message = 'Apenas letras minúsculas, números e underscore';
            } else {
                message = 'Nome de usuário válido ✓';
                
                // Atualizar status visual
                const statusEl = document.getElementById('username_status');
                if (statusEl) {
                    statusEl.innerHTML = '<i class="fas fa-check" style="color: var(--success);"></i>';
                }
            }
            break;
            
        case 'email':
            if (value && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(value)) {
                isValid = false;
                message = 'Email inválido';
            } else if (value) {
                message = 'Email válido ✓';
            }
            break;
            
        case 'password1':
            const strength = calculatePasswordStrength(value);
            updatePasswordStrength(strength);
            updateSecurityGuidelines(value);
            
            if (!value) {
                isValid = false;
                message = 'Senha é obrigatória';
            } else if (value.length < 8) {
                isValid = false;
                message = 'Senha deve ter pelo menos 8 caracteres';
            } else if (strength.score < 3) {
                isValid = false;
                message = 'Senha muito fraca - use mais critérios de segurança';
            } else {
                message = 'Senha válida ✓';
            }
            break;
            
        case 'password2':
            const password1 = document.getElementById('password1').value;
            if (!value) {
                isValid = false;
                message = 'Confirmação de senha é obrigatória';
            } else if (value !== password1) {
                isValid = false;
                message = 'Senhas não coincidem';
            } else {
                message = 'Senhas coincidem ✓';
            }
            break;
    }
    
    // Aplicar validação visual
    field.parentElement.classList.add(isValid ? 'valid' : 'invalid');
    if (feedback) {
        feedback.textContent = message;
        feedback.className = `field-feedback ${isValid ? 'success' : 'error'}`;
    }
    
    // Atualizar preview em tempo real
    updatePreview();
    
    return isValid;
}

function updateSecurityGuidelines(password) {
    const guidelines = {
        'guideline-length': password.length >= 8,
        'guideline-lowercase': /[a-z]/.test(password),
        'guideline-uppercase': /[A-Z]/.test(password),
        'guideline-number': /\d/.test(password),
        'guideline-special': /[^A-Za-z0-9]/.test(password)
    };
    
    Object.entries(guidelines).forEach(([guidelineId, isValid]) => {
        const guidelineEl = document.getElementById(guidelineId);
        if (guidelineEl) {
            guidelineEl.classList.toggle('valid', isValid);
            const icon = guidelineEl.querySelector('.guideline-icon i');
            icon.className = isValid ? 'fas fa-check' : 'fas fa-times';
        }
    });
}

function calculatePasswordStrength(password) {
    let score = 0;
    let feedback = 'Digite uma senha';
    
    if (!password) {
        return { score: 0, feedback };
    }
    
    // Critérios de força
    const criteria = {
        length: password.length >= 8,
        lowercase: /[a-z]/.test(password),
        uppercase: /[A-Z]/.test(password),
        numbers: /\d/.test(password),
        special: /[^A-Za-z0-9]/.test(password)
    };
    
    // Calcular score
    Object.values(criteria).forEach(met => {
        if (met) score++;
    });
    
    // Feedback baseado no score
    const feedbacks = ['Muito fraca', 'Fraca', 'Razoável', 'Boa', 'Muito forte'];
    feedback = feedbacks[Math.min(score, 4)];
    
    return { score, feedback, criteria };
}

function updatePasswordStrength(strength) {
    const strengthFill = document.getElementById('strengthFill');
    const strengthText = document.getElementById('strengthText');
    
    if (strengthFill && strengthText) {
        // Remover classes anteriores
        strengthFill.className = 'strength-fill';
        
        // Adicionar nova classe baseada no score
        const strengthClasses = ['weak', 'weak', 'fair', 'good', 'strong', 'very-strong'];
        strengthFill.classList.add(strengthClasses[strength.score]);
        
        // Atualizar texto
        strengthText.textContent = strength.feedback;
    }
}



// ===== KEYBOARD NAVIGATION PREMIUM =====
document.addEventListener('keydown', function(e) {
    if (e.key === 'Enter' && e.target.classList.contains('field-input')) {
        e.preventDefault();
        const nextBtn = document.getElementById('nextBtn');
        const submitBtn = document.getElementById('submitBtn');
        
        if (currentStep < totalSteps && nextBtn.style.display !== 'none') {
            navigateStep(1);
        } else if (currentStep === totalSteps && submitBtn.style.display !== 'none') {
            submitBtn.click();
        }
    }
});

// ===== FUNÇÃO updatePreview IMPLEMENTADA =====
function updatePreview() {
    const firstName = document.getElementById('first_name').value || 'Novo';
    const lastName = document.getElementById('last_name').value || 'Usuário';
    const username = document.getElementById('username').value || 'usuario';
    const email = document.getElementById('email').value || 'usuario@exemplo.com';
    const isActive = document.getElementById('is_active').checked;
    const isStaff = document.getElementById('is_staff').checked;
    
    // Atualizar preview
    const previewName = document.getElementById('previewName');
    const previewUsername = document.getElementById('previewUsername');
    const previewEmail = document.getElementById('previewEmail');
    
    if (previewName) previewName.textContent = `${firstName} ${lastName}`;
    if (previewUsername) previewUsername.textContent = `@${username}`;
    if (previewEmail) previewEmail.textContent = email;
    
    // Atualizar badges
    const statusBadge = document.getElementById('previewStatus');
    const typeBadge = document.getElementById('previewRole');
    
    if (statusBadge) {
        statusBadge.textContent = isActive ? 'Ativo' : 'Inativo';
        statusBadge.className = `preview-badge ${isActive ? 'active' : 'inactive'}`;
    }
    
    if (typeBadge) {
        if (isStaff) {
            typeBadge.style.display = 'inline-block';
            typeBadge.textContent = 'Administrador';
        } else {
            typeBadge.style.display = 'none';
        }
    }
}

// ===== FUNÇÃO updateProgressFlow IMPLEMENTADA =====
function updateProgressFlow() {
    const progressBar = document.getElementById('flowProgress');
    if (progressBar) {
        const percentage = ((currentStep - 1) / (totalSteps - 1)) * 100;
        progressBar.style.width = `${percentage}%`;
    }
    
    // Atualizar steps visuais
    document.querySelectorAll('.flow-step').forEach((step, index) => {
        const stepNum = index + 1;
        step.classList.remove('active', 'completed');
        
        if (stepNum < currentStep) {
            step.classList.add('completed');
        } else if (stepNum === currentStep) {
            step.classList.add('active');
        }
    });
}

// ===== FUNÇÃO updateNavigationButtons IMPLEMENTADA =====
function updateNavigationButtons() {
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const submitBtn = document.getElementById('submitBtn');
    
    if (prevBtn) {
        prevBtn.style.display = currentStep === 1 ? 'none' : 'flex';
    }
    
    if (currentStep === totalSteps) {
        if (nextBtn) nextBtn.style.display = 'none';
        if (submitBtn) submitBtn.style.display = 'flex';
    } else {
        if (nextBtn) nextBtn.style.display = 'flex';
        if (submitBtn) submitBtn.style.display = 'none';
    }
}

// ===== FUNÇÃO togglePassword MELHORADA =====
function togglePassword(inputId) {
    console.log(`🔍 [DEBUG] Tentando alternar visibilidade da senha para: ${inputId}`);
    
    const input = document.getElementById(inputId);
    if (!input) {
        console.error(`❌ [DEBUG] Input com ID '${inputId}' não encontrado`);
        return;
    }
    
    console.log(`✅ [DEBUG] Input encontrado: ${input.type}`);
    
    const button = input.parentElement.querySelector('.field-action');
    if (!button) {
        console.error(`❌ [DEBUG] Botão .field-action não encontrado para input ${inputId}`);
        return;
    }
    
    console.log(`✅ [DEBUG] Botão encontrado`);
    
    const icon = button.querySelector('i');
    if (!icon) {
        console.error(`❌ [DEBUG] Ícone não encontrado no botão para input ${inputId}`);
        return;
    }
    
    console.log(`✅ [DEBUG] Ícone encontrado: ${icon.className}`);
    
    // Alternar visibilidade
    if (input.type === 'password') {
        input.type = 'text';
        icon.className = 'fas fa-eye-slash';
        console.log(`👁️ [DEBUG] Senha ${inputId} agora está VISÍVEL`);
    } else {
        input.type = 'password';
        icon.className = 'fas fa-eye';
        console.log(`🙈 [DEBUG] Senha ${inputId} agora está OCULTA`);
    }
    
    // Feedback visual adicional
    button.style.color = input.type === 'text' ? 'var(--primary)' : 'var(--text-muted)';
    
    // Vibração sutil no mobile (se suportado)
    if (navigator.vibrate) {
        navigator.vibrate(50);
    }
}

// ===== FUNÇÃO TOGGLE AÇÕES RÁPIDAS =====
function toggleQuickActions() {
    const collapsed = document.getElementById('actionsCollapsed');
    const expanded = document.getElementById('actionsExpanded');
    
    if (!collapsed || !expanded) return;
    
    if (expanded.style.display === 'none') {
        // Expandir
        collapsed.style.display = 'none';
        expanded.style.display = 'block';
        
        // Animação suave
        expanded.style.opacity = '0';
        expanded.style.transform = 'scale(0.95) translateY(-10px)';
        
        requestAnimationFrame(() => {
            expanded.style.transition = 'all 0.3s ease-out';
            expanded.style.opacity = '1';
            expanded.style.transform = 'scale(1) translateY(0)';
        });
        
        // Log informativo
        console.log('Ações rápidas expandidas!');
        
    } else {
        // Recolher
        expanded.style.transition = 'all 0.3s ease-in';
        expanded.style.opacity = '0';
        expanded.style.transform = 'scale(0.95) translateY(-10px)';
        
        setTimeout(() => {
            expanded.style.display = 'none';
            collapsed.style.display = 'flex';
            
            // Animação do botão recolhido
            collapsed.style.opacity = '0';
            collapsed.style.transform = 'scale(0.95)';
            
            requestAnimationFrame(() => {
                collapsed.style.transition = 'all 0.3s ease-out';
                collapsed.style.opacity = '1';
                collapsed.style.transform = 'scale(1)';
            });
        }, 300);
        
        // Log informativo
        console.log('Ações rápidas recolhidas!');
    }
}

// ===== FUNCIONALIDADES DE VOZ E ACESSIBILIDADE =====
window.voiceReadingEnabled = false;
window.accessibilityMode = false;
window.currentSpeech = null;

function toggleVoiceReading() {
    window.voiceReadingEnabled = !window.voiceReadingEnabled;
    const voiceIcon = document.getElementById('voiceIcon');
    const voiceBtn = voiceIcon?.parentElement;
    
    if (window.voiceReadingEnabled) {
        voiceIcon.className = 'fas fa-volume-up';
        voiceBtn?.classList.add('active');
        speakText('Leitura por voz ativada. Suas mensagens serão lidas automaticamente.');
        
        // Salvar preferência
        localStorage.setItem('voiceReadingEnabled', 'true');
    } else {
        voiceIcon.className = 'fas fa-volume-off';
        voiceBtn?.classList.remove('active');
        stopSpeaking();
        
        // Salvar preferência
        localStorage.setItem('voiceReadingEnabled', 'false');
    }
}

function toggleAccessibilityMode() {
    window.accessibilityMode = !window.accessibilityMode;
    const accessibilityIcon = document.getElementById('accessibilityIcon');
    const accessibilityBtn = accessibilityIcon?.parentElement;
    const modal = document.querySelector('.assistant-modal-content');
    
    if (window.accessibilityMode) {
        accessibilityIcon.className = 'fas fa-universal-access';
        accessibilityBtn?.classList.add('active');
        modal?.classList.add('accessibility-mode');
        speakText('Modo de alta acessibilidade ativado. Interface otimizada para leitores de tela.');
        
        // Salvar preferência
        localStorage.setItem('accessibilityMode', 'true');
    } else {
        accessibilityIcon.className = 'fas fa-universal-access';
        accessibilityBtn?.classList.remove('active');
        modal?.classList.remove('accessibility-mode');
        
        // Salvar preferência
        localStorage.setItem('accessibilityMode', 'false');
    }
}

function speakText(text) {
    // Verificar se o navegador suporta síntese de voz
    if (!('speechSynthesis' in window)) {
        console.log('Síntese de voz não suportada neste navegador');
        return;
    }
    
    // Parar qualquer fala em andamento
    stopSpeaking();
    
    // Limpar texto de markdown e HTML
    const cleanText = text
        .replace(/[*#]/g, '')
        .replace(/<[^>]*>/g, '')
        .replace(/&[^;]+;/g, ' ')
        .trim();
    
    if (!cleanText) return;
    
    // Criar nova síntese de voz
    window.currentSpeech = new SpeechSynthesisUtterance(cleanText);
    
    // Configurar voz
    window.currentSpeech.lang = 'pt-BR';
    window.currentSpeech.rate = 0.9;
    window.currentSpeech.pitch = 1;
    window.currentSpeech.volume = 0.8;
    
    // Eventos da síntese
    window.currentSpeech.onstart = function() {
        console.log('🎤 Iniciando leitura:', cleanText.substring(0, 50) + '...');
    };
    
    window.currentSpeech.onend = function() {
        console.log('🎤 Leitura finalizada');
        window.currentSpeech = null;
    };
    
    window.currentSpeech.onerror = function(event) {
        console.error('❌ Erro na síntese de voz:', event.error);
        window.currentSpeech = null;
    };
    
    // Iniciar síntese
    window.speechSynthesis.speak(window.currentSpeech);
}

function stopSpeaking() {
    if (window.speechSynthesis.speaking) {
        window.speechSynthesis.cancel();
    }
    window.currentSpeech = null;
    
    // Remover estado de "lendo" de todos os botões
    document.querySelectorAll('.voice-read-btn.playing').forEach(btn => {
        btn.classList.remove('playing');
        btn.querySelector('i').className = 'fas fa-play';
    });
}

function speakMessage(button) {
    const messageElement = button.closest('.message-bubble');
    if (!messageElement) return;
    
    // Se já está falando esta mensagem, parar
    if (button.classList.contains('playing')) {
        stopSpeaking();
        return;
    }
    
    // Parar qualquer fala em andamento
    stopSpeaking();
    
    // Obter texto da mensagem
    const messageText = messageElement.textContent || messageElement.innerText;
    
    // Atualizar interface do botão
    button.classList.add('playing');
    button.querySelector('i').className = 'fas fa-stop';
    
    // Configurar evento de fim da fala
    const originalOnEnd = window.currentSpeech?.onend;
    
    // Falar o texto
    speakText(messageText);
    
    if (window.currentSpeech) {
        window.currentSpeech.onend = function() {
            button.classList.remove('playing');
            button.querySelector('i').className = 'fas fa-play';
            if (originalOnEnd) originalOnEnd();
        };
    }
}

// Carregar preferências salvas ao abrir o assistente
function loadUserPreferences() {
    // Carregar preferência de voz
    const voiceEnabled = localStorage.getItem('voiceReadingEnabled') === 'true';
    if (voiceEnabled !== window.voiceReadingEnabled) {
        toggleVoiceReading();
    }
    
    // Carregar preferência de acessibilidade
    const accessibilityEnabled = localStorage.getItem('accessibilityMode') === 'true';
    if (accessibilityEnabled !== window.accessibilityMode) {
        toggleAccessibilityMode();
    }
    
    // Inicializar estado online do assistente
    initializeAssistantStatus();
}

// ===== GERENCIAMENTO DE STATUS DO ASSISTENTE =====
let assistantOnlineStatus = true;

function initializeAssistantStatus() {
    const statusElement = document.getElementById('assistantStatus');
    if (statusElement) {
        statusElement.classList.add('online');
        updateStatusDisplay(true);
        
        // Adicionar evento de clique para demonstrar estados
        statusElement.addEventListener('click', toggleAssistantStatus);
    }
}

function toggleAssistantStatus() {
    assistantOnlineStatus = !assistantOnlineStatus;
    updateStatusDisplay(assistantOnlineStatus);
    
    // Feedback por voz
    if (window.voiceReadingEnabled) {
        const message = assistantOnlineStatus ? 
            'Assistente online e disponível' : 
            'Assistente temporariamente indisponível';
        speakText(message);
    }
    
    console.log(`🤖 Assistente agora está: ${assistantOnlineStatus ? 'ONLINE' : 'OFFLINE'}`);
}

function updateStatusDisplay(isOnline) {
    const statusElement = document.getElementById('assistantStatus');
    const statusText = statusElement?.querySelector('.status-text');
    const statusTooltip = statusElement?.querySelector('.status-tooltip');
    const statusMessage = document.getElementById('assistantStatusMessage');
    
    if (statusElement && statusText && statusTooltip) {
        // Remover classes antigas
        statusElement.classList.remove('online', 'offline');
        
        if (isOnline) {
            // Estado Online
            statusElement.classList.add('online');
            statusText.textContent = 'Online';
            statusTooltip.textContent = '🟢 O assistente está disponível agora - Clique para alternar';
            
            if (statusMessage) {
                statusMessage.textContent = 'Como posso ajudá-lo hoje?';
                statusMessage.style.opacity = '0.8';
            }
        } else {
            // Estado Offline
            statusElement.classList.add('offline');
            statusText.textContent = 'Indisponível';
            statusTooltip.textContent = '🔴 Assistente temporariamente indisponível - Clique para conectar';
            
            if (statusMessage) {
                statusMessage.textContent = 'Reconectando... Aguarde um momento.';
                statusMessage.style.opacity = '0.6';
            }
        }
    }
}

function simulateConnectionLoss() {
    // Simular perda de conexão por 5 segundos
    updateStatusDisplay(false);
    
    setTimeout(() => {
        updateStatusDisplay(true);
        if (window.voiceReadingEnabled) {
            speakText('Conexão restaurada. Assistente online novamente.');
        }
    }, 5000);
}

// Adicionar listener para demonstrar estados em desenvolvimento
document.addEventListener('keydown', function(e) {
    // Pressione Alt + S para alternar status (apenas para demonstração)
    if (e.altKey && e.key === 's') {
        e.preventDefault();
        toggleAssistantStatus();
    }
    
    // Pressione Alt + D para simular desconexão (apenas para demonstração)
    if (e.altKey && e.key === 'd') {
        e.preventDefault();
        simulateConnectionLoss();
    }
});

// ===== FUNÇÃO TOGGLE ASSISTENTE VIRTUAL =====
function toggleAssistant() {
    const collapsed = document.getElementById('assistantCollapsed');
    const expanded = document.getElementById('assistantExpanded');
    
    if (!collapsed || !expanded) return;
    
    if (expanded.style.display === 'none') {
        // Expandir
        collapsed.style.display = 'none';
        expanded.style.display = 'block';
        
        // Animação suave
        expanded.style.opacity = '0';
        expanded.style.transform = 'scale(0.95) translateY(-10px)';
        
        requestAnimationFrame(() => {
            expanded.style.transition = 'all 0.3s ease-out';
            expanded.style.opacity = '1';
            expanded.style.transform = 'scale(1) translateY(0)';
        });
        
        // Log informativo
        console.log('Assistente virtual ativado!');
        
    } else {
        // Recolher
        expanded.style.transition = 'all 0.3s ease-in';
        expanded.style.opacity = '0';
        expanded.style.transform = 'scale(0.95) translateY(-10px)';
        
        setTimeout(() => {
            expanded.style.display = 'none';
            collapsed.style.display = 'flex';
            
            // Animação do botão recolhido
            collapsed.style.opacity = '0';
            collapsed.style.transform = 'scale(0.95)';
            
            requestAnimationFrame(() => {
                collapsed.style.transition = 'all 0.3s ease-out';
                collapsed.style.opacity = '1';
                collapsed.style.transform = 'scale(1)';
            });
        }, 300);
        
        // Log informativo
        console.log('Assistente virtual recolhido!');
    }
}

// ===== FUNÇÃO SCROLL TO FORM =====
function scrollToForm() {
    const formContainer = document.querySelector('.form-container-premium');
    if (formContainer) {
        formContainer.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
        });
        
        // Log informativo
        console.log('Redirecionando para o formulário!');
        
        // Foco no primeiro campo após o scroll
        setTimeout(() => {
            const firstInput = document.querySelector('.field-input');
            if (firstInput) {
                firstInput.focus();
            }
        }, 1000);
    }
}

// ===== MELHORIAS PREMIUM DO ROBÔ =====
function enhanceRobotInteractions() {
    const avatarIcon = document.querySelector('.avatar-icon');
    const robotFace = document.querySelector('.robot-face');
    
    if (avatarIcon && robotFace) {
        console.log('🤖 Aplicando melhorias premium do robô...');
        
        // Efeito de "curiosidade" - robô segue o cursor
        avatarIcon.addEventListener('mousemove', (e) => {
            const rect = avatarIcon.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            
            const mouseX = e.clientX;
            const mouseY = e.clientY;
            
            const deltaX = mouseX - centerX;
            const deltaY = mouseY - centerY;
            
            // Mover pupilas sutilmente na direção do cursor
            const maxMove = 2; // pixels
            
            const moveX = Math.max(-maxMove, Math.min(maxMove, deltaX / 20));
            const moveY = Math.max(-maxMove, Math.min(maxMove, deltaY / 20));
            
            // Adicionar estilo dinâmico
            const style = document.createElement('style');
            style.textContent = `
                .robot-eye::before {
                    transform: translate(calc(-50% + ${moveX}px), calc(-50% + ${moveY}px)) !important;
                    transition: transform 0.2s ease !important;
                }
            `;
            
            // Remover estilo anterior se existir
            const oldStyle = document.getElementById('robot-cursor-style');
            if (oldStyle) oldStyle.remove();
            
            style.id = 'robot-cursor-style';
            document.head.appendChild(style);
        });
        
        // Restaurar posição normal quando mouse sair
        avatarIcon.addEventListener('mouseleave', () => {
            const oldStyle = document.getElementById('robot-cursor-style');
            if (oldStyle) oldStyle.remove();
        });
        
        // Efeito de "felicidade" no clique
        avatarIcon.addEventListener('click', (e) => {
            e.preventDefault();
            robotFace.style.animation = 'none';
            robotFace.offsetHeight; // trigger reflow
            robotFace.style.animation = 'robotBreathing 1s ease-in-out 3';
            
            // Efeito de partículas especiais no clique
            createHappinessParticles(avatarIcon);
            
            console.log('🎉 Robô ficou feliz!');
        });
    }
}

// Criar partículas de felicidade premium
function createHappinessParticles(element) {
    const rect = element.getBoundingClientRect();
    const centerX = rect.left + rect.width / 2;
    const centerY = rect.top + rect.height / 2;
    
    const emojis = ['✨', '💫', '⭐', '🌟', '💎'];
    
    for (let i = 0; i < 12; i++) {
        const particle = document.createElement('div');
        const isEmoji = i % 3 === 0;
        
        if (isEmoji) {
            particle.textContent = emojis[Math.floor(Math.random() * emojis.length)];
            particle.style.cssText = `
                position: fixed;
                font-size: 12px;
                pointer-events: none;
                z-index: 10001;
                left: ${centerX}px;
                top: ${centerY}px;
                user-select: none;
            `;
        } else {
            particle.style.cssText = `
                position: fixed;
                width: 6px;
                height: 6px;
                background: linear-gradient(45deg, #4DA6FF, #6B73FF, #00ff88);
                border-radius: 50%;
                pointer-events: none;
                z-index: 10001;
                left: ${centerX}px;
                top: ${centerY}px;
                box-shadow: 0 0 8px rgba(77, 166, 255, 0.8);
            `;
        }
        
        document.body.appendChild(particle);
        
        // Animar partícula com movimento mais orgânico
        const angle = (i / 12) * Math.PI * 2;
        const distance = 40 + Math.random() * 30;
        const endX = centerX + Math.cos(angle) * distance;
        const endY = centerY + Math.sin(angle) * distance - Math.random() * 20;
        
        particle.animate([
            { 
                left: centerX + 'px', 
                top: centerY + 'px',
                opacity: 1,
                transform: 'scale(0) rotate(0deg)'
            },
            { 
                left: endX + 'px', 
                top: endY + 'px',
                opacity: 0,
                transform: 'scale(1.2) rotate(360deg)'
            }
        ], {
            duration: 1200 + Math.random() * 400,
            easing: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)'
        }).onfinish = () => {
            if (document.body.contains(particle)) {
                document.body.removeChild(particle);
            }
        };
    }
    
    // Som de feedback suave (se disponível)
    if ('speechSynthesis' in window && window.voiceReadingEnabled) {
        const utterance = new SpeechSynthesisUtterance('Olá!');
        utterance.rate = 2;
        utterance.pitch = 1.5;
        utterance.volume = 0.2;
        window.speechSynthesis.speak(utterance);
    }
}

// ===== INICIALIZAÇÃO PREMIUM =====
document.addEventListener('DOMContentLoaded', function() {
    console.log('🚀 Iniciando sistema de criação de usuários...');
    
    // Esconder loading screen após delay
    setTimeout(hideLoadingScreen, 1500);
    
    // Inicializar validação em tempo real
    document.querySelectorAll('.field-input').forEach(input => {
        if (input) {
            input.addEventListener('input', () => {
                validateField(input);
                updatePreview();
            });
            input.addEventListener('blur', () => validateField(input));
        }
    });
    
    // Inicializar toggles
    document.querySelectorAll('.toggle-input').forEach(toggle => {
        if (toggle) {
            toggle.addEventListener('change', updatePreview);
        }
    });
    
    // Inicializar formulário
    initializeFormSubmit();
    
    // Carregar estatísticas iniciais
    loadUserStats();
    
    // Inicializar auto-refresh das estatísticas
    startAutoRefresh();
    
    // Inicializar progress flow
    updateProgressFlow();
    updateNavigationButtons();
    
    // Preview inicial
    updatePreview();
    
    // Foco inicial
    const firstInput = document.querySelector('.field-input');
    if (firstInput) {
        setTimeout(() => firstInput.focus(), 500);
    }
    
    console.log('✅ Sistema de criação de usuários inicializado com sucesso!');
});
</script>

<!-- ===== SCRIPT ESPECÍFICO PARA CORREÇÃO DOS BOTÕES DE SENHA ===== -->
<script>
// Correção DEFINITIVA dos botões de toggle de senha
(function() {
    'use strict';
    
    console.log('🔐 [SENHA] Iniciando correção definitiva dos botões...');
    
    // Função principal de toggle - SIMPLES E DIRETA
    function togglePasswordWorking(inputId) {
        console.log(`👁️ [SENHA] Alterando visibilidade: ${inputId}`);
        
        const input = document.getElementById(inputId);
        const wrapper = input?.parentElement;
        const button = wrapper?.querySelector('.field-action');
        const icon = button?.querySelector('i');
        
        if (!input || !button || !icon) {
            console.error(`❌ [SENHA] Elementos não encontrados para ${inputId}`);
            return false;
        }
        
        // Alternar tipo do input
        if (input.type === 'password') {
            input.type = 'text';
            icon.className = 'fas fa-eye-slash';
            button.title = 'Ocultar senha';
            console.log(`✅ [SENHA] ${inputId} agora VISÍVEL`);
        } else {
            input.type = 'password';
            icon.className = 'fas fa-eye';
            button.title = 'Mostrar senha';
            console.log(`✅ [SENHA] ${inputId} agora OCULTO`);
        }
        
        // Feedback visual
        button.style.color = (input.type === 'text') ? '#10b981' : '#6b7280';
        
        return true;
    }
    
    // Registrar função globalmente SOBRESCREVENDO
    window.togglePassword = togglePasswordWorking;
    
    // Função de inicialização DOS BOTÕES
    function setupPasswordButtons() {
        console.log('🔄 [SENHA] Configurando botões...');
        
        const fieldIds = ['password1', 'password2'];
        let setupCount = 0;
        
        fieldIds.forEach(fieldId => {
            const input = document.getElementById(fieldId);
            if (!input) {
                console.warn(`⚠️ [SENHA] Campo ${fieldId} não encontrado ainda`);
                return;
            }
            
            const wrapper = input.parentElement;
            const button = wrapper.querySelector('.field-action');
            
            if (!button) {
                console.warn(`⚠️ [SENHA] Botão não encontrado para ${fieldId}`);
                return;
            }
            
            // LIMPAR TODOS OS EVENT LISTENERS EXISTENTES
            const newButton = button.cloneNode(true);
            button.parentNode.replaceChild(newButton, button);
            
            // CONFIGURAR ÚNICO EVENT LISTENER
            newButton.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                
                console.log(`🖱️ [SENHA] Clique em ${fieldId}`);
                togglePasswordWorking(fieldId);
            }, { passive: false });
            
            // Configurar atributos de acessibilidade
            newButton.setAttribute('type', 'button');
            newButton.setAttribute('tabindex', '0');
            newButton.setAttribute('aria-label', 'Alternar visibilidade da senha');
            newButton.title = 'Mostrar senha';
            
            // Garantir que seja clicável
            newButton.style.cssText += `
                pointer-events: auto !important;
                cursor: pointer !important;
                user-select: none !important;
                position: absolute !important;
                right: 15px !important;
                top: 50% !important;
                transform: translateY(-50%) !important;
                width: 20px !important;
                height: 20px !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                background: transparent !important;
                border: none !important;
                padding: 0 !important;
                z-index: 10 !important;
            `;
            
            setupCount++;
            console.log(`✅ [SENHA] Botão ${fieldId} configurado com sucesso`);
        });
        
        console.log(`📊 [SENHA] Total configurados: ${setupCount}/2`);
        return setupCount;
    }
    
    // Tentativas de inicialização COM RETRIES
    function attemptSetup(attempt = 1, maxAttempts = 5) {
        console.log(`🔄 [SENHA] Tentativa ${attempt}/${maxAttempts}`);
        
        const setupCount = setupPasswordButtons();
        
        if (setupCount === 2) {
            console.log('🎉 [SENHA] Todos os botões configurados com sucesso!');
            return;
        }
        
        if (attempt < maxAttempts) {
            console.log(`⏳ [SENHA] Tentando novamente em 1 segundo...`);
            setTimeout(() => attemptSetup(attempt + 1, maxAttempts), 1000);
        } else {
            console.error('❌ [SENHA] Falha na configuração após todas as tentativas');
        }
    }
    
    // INICIAR CONFIGURAÇÃO
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => attemptSetup(), 1000);
        });
    } else {
        setTimeout(() => attemptSetup(), 1000);
    }
    
    // OBSERVER para detectar mudanças no DOM
    const observer = new MutationObserver(function(mutations) {
        let shouldReinitialize = false;
        
        mutations.forEach(function(mutation) {
            if (mutation.type === 'childList') {
                mutation.addedNodes.forEach(node => {
                    if (node.nodeType === 1) {
                        if (node.id === 'password1' || node.id === 'password2' ||
                            (node.querySelector && (node.querySelector('#password1') || node.querySelector('#password2')))) {
                            shouldReinitialize = true;
                        }
                    }
                });
            }
        });
        
        if (shouldReinitialize) {
            console.log('🔄 [SENHA] Campos de senha detectados, reinicializando...');
            setTimeout(() => attemptSetup(), 500);
        }
    });
    
    observer.observe(document.body, { childList: true, subtree: true });
    
    // FUNÇÃO DE DEBUG GLOBAL
    window.debugPasswordButtons = function() {
        console.group('🔍 [DEBUG] Diagnóstico dos botões de senha');
        
        ['password1', 'password2'].forEach(id => {
            const input = document.getElementById(id);
            const button = input?.parentElement?.querySelector('.field-action');
            const icon = button?.querySelector('i');
            
            console.log(`${id}:`, {
                input: !!input,
                inputType: input?.type,
                button: !!button,
                icon: !!icon,
                iconClass: icon?.className
            });
            
            if (button) {
                console.log(`  Botão ${id} clicável:`, window.getComputedStyle(button).pointerEvents !== 'none');
            }
        });
        
        console.groupEnd();
        
        // Reinicializar após debug
        console.log('🔄 Reinicializando após debug...');
        setupPasswordButtons();
    };
    
    console.log('✅ [SENHA] Sistema de correção ativo');
    console.log('💡 Digite debugPasswordButtons() no console para diagnóstico');
})();
</script>

<!-- ===== SCRIPT ADICIONAL DE FORÇA BRUTA PARA GARANTIR FUNCIONAMENTO ===== -->
<script>
// Script adicional para forçar funcionamento dos botões de senha
document.addEventListener('DOMContentLoaded', function() {
    console.log('🔨 [FORÇA] Aplicando correção adicional...');
    
    // Aguardar um pouco e então forçar correção
    setTimeout(function() {
        // Localizar campos de senha diretamente
        const fields = document.querySelectorAll('#password1, #password2');
        
        fields.forEach(function(input) {
            if (!input) return;
            
            const wrapper = input.parentElement;
            const button = wrapper?.querySelector('.field-action');
            
            if (button) {
                console.log(`🔨 [FORÇA] Forçando botão para ${input.id}`);
                
                // Remover todos os event listeners antigos
                const newButton = button.cloneNode(true);
                button.parentNode.replaceChild(newButton, button);
                
                // Aplicar estilos forçados
                newButton.style.cssText = `
                    position: absolute !important;
                    right: 15px !important;
                    top: 50% !important;
                    transform: translateY(-50%) !important;
                    width: 24px !important;
                    height: 24px !important;
                    display: flex !important;
                    align-items: center !important;
                    justify-content: center !important;
                    background: transparent !important;
                    border: none !important;
                    cursor: pointer !important;
                    pointer-events: auto !important;
                    z-index: 100 !important;
                    color: #6b7280 !important;
                    transition: color 0.2s ease !important;
                `;
                
                // Event listener simplificado
                newButton.onclick = function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    console.log(`👁️ [FORÇA] Alternando ${input.id}`);
                    
                    const icon = newButton.querySelector('i');
                    
                    if (input.type === 'password') {
                        input.type = 'text';
                        if (icon) icon.className = 'fas fa-eye-slash';
                        newButton.style.color = '#10b981';
                        newButton.title = 'Ocultar senha';
                        console.log(`✅ [FORÇA] ${input.id} VISÍVEL`);
                    } else {
                        input.type = 'password';
                        if (icon) icon.className = 'fas fa-eye';
                        newButton.style.color = '#6b7280';
                        newButton.title = 'Mostrar senha';
                        console.log(`✅ [FORÇA] ${input.id} OCULTO`);
                    }
                };
                
                // Configurar atributos
                newButton.setAttribute('type', 'button');
                newButton.setAttribute('tabindex', '0');
                newButton.title = 'Mostrar senha';
                
                console.log(`✅ [FORÇA] Botão ${input.id} configurado com força bruta`);
            }
        });
        
        console.log('🎯 [FORÇA] Correção adicional aplicada!');
    }, 1500);
    
    // Aplicar novamente após mais tempo para casos extremos
    setTimeout(function() {        
        console.log('🔄 [FORÇA] Verificação final...');
        
        const password1Button = document.querySelector('#password1')?.parentElement?.querySelector('.field-action');
        const password2Button = document.querySelector('#password2')?.parentElement?.querySelector('.field-action');
        
        if (!password1Button?.onclick || !password2Button?.onclick) {
            console.log('⚠️ [FORÇA] Alguns botões ainda sem evento, reaplicando...');
            
            [password1Button, password2Button].forEach((btn, index) => {
                if (btn && !btn.onclick) {
                    const fieldId = index === 0 ? 'password1' : 'password2';
                    const input = document.getElementById(fieldId);
                    
                    btn.onclick = function(e) {
                        e.preventDefault();
                        console.log(`👁️ [FINAL] Alternando ${fieldId}`);
                        
                        const icon = btn.querySelector('i');
                        
                        if (input.type === 'password') {
                            input.type = 'text';
                            if (icon) icon.className = 'fas fa-eye-slash';
                            btn.style.color = '#10b981';
                        } else {
                            input.type = 'password';
                            if (icon) icon.className = 'fas fa-eye';
                            btn.style.color = '#6b7280';
                        }
                    };
                    
                    console.log(`🎯 [FINAL] Botão ${fieldId} corrigido na verificação final`);
                }
            });
        } else {
            console.log('✅ [FORÇA] Todos os botões funcionando corretamente!');
        }
    }, 3000);
});
</script>
{% endblock %} 