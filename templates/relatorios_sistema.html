{% extends 'base.html' %}
{% load static %}
{% load custom_filters %}

{% block content %}
<!-- Estilos específicos para Top Usuários Mais Ativos -->
<style>
/* Dropdown de filtros moderno */
.filter-dropdown-modern {
    position: relative;
    display: inline-block;
}

.filter-btn-modern {
    background: white;
    border: 2px solid #e2e8f0;
    border-radius: 8px;
    padding: 10px 16px;
    font-size: 14px;
    font-weight: 600;
    color: #374151;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.3s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
}

.filter-btn-modern:hover {
    border-color: #3b82f6;
    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
    transform: translateY(-1px);
}

.filter-btn-modern.active {
    border-color: #3b82f6;
    background: #eff6ff;
    color: #3b82f6;
}

.filter-dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 12px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    padding: 12px;
    min-width: 220px;
    z-index: 1000;
    opacity: 0;
    visibility: hidden;
    transform: translateY(-10px);
    transition: all 0.3s ease;
    margin-top: 8px;
}

.filter-dropdown-menu.show {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
}

.filter-option-modern {
    display: flex;
    align-items: center;
    padding: 10px 12px;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    margin-bottom: 4px;
}

.filter-option-modern:last-child {
    margin-bottom: 0;
}

.filter-option-modern:hover {
    background: #f8fafc;
}

.filter-option-modern input[type="checkbox"] {
    width: 18px;
    height: 18px;
    accent-color: #3b82f6;
    cursor: pointer;
    margin-right: 12px;
}

.filter-option-modern label {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    font-weight: 500;
    color: #374151;
    cursor: pointer;
    margin: 0;
    flex: 1;
}

.filter-option-modern label i {
    font-size: 16px;
    color: #6b7280;
    min-width: 20px;
}

.filter-option-modern input[type="checkbox"]:checked + label {
    color: #3b82f6;
    font-weight: 600;
}

.filter-option-modern input[type="checkbox"]:checked + label i {
    color: #3b82f6;
}

/* Melhorias responsivas */
@media (max-width: 768px) {
    .filter-group {
        flex-direction: column;
        align-items: flex-start;
        gap: 16px;
    }
    
    .filter-options {
        gap: 16px;
    }
    
    .filter-option {
        padding: 12px 16px;
    }
}

/* Estilos removidos - agora usando .search-box-modern */

/* Melhorias na tabela */
.table-row-premium {
    transition: all 0.3s ease;
}

.table-row-premium:hover {
    background: #f8fafc;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

/* Contador de resultados */
.section-count {
    font-weight: 600;
    color: #374151;
    font-size: 14px;
}

/* Estilos removidos - agora usando .export-btn-modern */

/* Animação para linhas da tabela */
.table-row-premium {
    animation: fadeInUp 0.3s ease;
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Estilos para indicadores de atividade */
.activity-indicator.active {
    color: #22c55e;
}

.activity-indicator.inactive {
    color: #94a3b8;
}

/* Badges de nível com cores mais vibrantes */
.level-badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.level-badge.gold {
    background: linear-gradient(135deg, #ffd700 0%, #ffb300 100%);
    color: #1a1a1a;
}

.level-badge.silver {
    background: linear-gradient(135deg, #c0c0c0 0%, #a0a0a0 100%);
    color: #1a1a1a;
}

.level-badge.bronze {
    background: linear-gradient(135deg, #cd7f32 0%, #b8671f 100%);
    color: white;
}

.level-badge.blue {
    background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
    color: white;
}

/* Efeitos de busca modernos */
.search-box-modern.searching {
    border-color: #f59e0b;
    box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.1);
}

.search-box-modern.searching::after {
    content: '';
    position: absolute;
    right: 16px;
    top: 50%;
    transform: translateY(-50%);
    width: 16px;
    height: 16px;
    border: 2px solid #f59e0b;
    border-top: 2px solid transparent;
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    0% { transform: translateY(-50%) rotate(0deg); }
    100% { transform: translateY(-50%) rotate(360deg); }
}

/* Melhorias no layout da tabela */
.users-table-premium {
    background: white;
    border-radius: 12px;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.05);
    overflow: hidden;
    border: 1px solid #e2e8f0;
}

.table-header-premium {
    background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
    border-bottom: 2px solid #e2e8f0;
    padding: 16px;
    font-weight: 600;
}

/* Indicadores de status melhorados */
.online-indicator {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    color: #22c55e;
}

.pulse-dot {
    width: 8px;
    height: 8px;
    background: #22c55e;
    border-radius: 50%;
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0% {
        transform: scale(0.95);
        box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7);
    }
    70% {
        transform: scale(1);
        box-shadow: 0 0 0 8px rgba(34, 197, 94, 0);
    }
    100% {
        transform: scale(0.95);
        box-shadow: 0 0 0 0 rgba(34, 197, 94, 0);
    }
}

/* Tooltips informativos */
.tooltip {
    position: relative;
    cursor: help;
}

.tooltip::before {
    content: attr(data-tooltip);
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    background: #1f2937;
    color: white;
    padding: 8px 12px;
    border-radius: 6px;
    font-size: 12px;
    white-space: nowrap;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    z-index: 1000;
}

.tooltip:hover::before {
    opacity: 1;
    visibility: visible;
    transform: translateX(-50%) translateY(-4px);
}

/* Melhorias responsivas para tabela */
@media (max-width: 1024px) {
    .col-metrics-premium {
        display: none;
    }
    
    .col-performance-premium {
        display: none;
    }
}

@media (max-width: 768px) {
    .table-header-premium {
        font-size: 14px;
    }
    
    .users-table-premium {
        font-size: 14px;
    }
}

/* Animações de entrada para filtros modernos */
.filter-option-modern {
    opacity: 0;
    transform: translateX(-10px);
    animation: filterModernAppear 0.3s ease forwards;
}

.filter-option-modern:nth-child(1) { animation-delay: 0.1s; }
.filter-option-modern:nth-child(2) { animation-delay: 0.2s; }
.filter-option-modern:nth-child(3) { animation-delay: 0.3s; }
.filter-option-modern:nth-child(4) { animation-delay: 0.4s; }

@keyframes filterModernAppear {
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

/* Indicador de filtro ativo */
.filter-option-modern.active {
    background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
    border-left: 3px solid #3b82f6;
}

/* Melhorias no chevron do botão de filtros */
.filter-btn-modern i.fa-chevron-down {
    transition: transform 0.3s ease;
}

.filter-btn-modern.active i.fa-chevron-down {
    transform: rotate(180deg);
}

/* Efeito de digitação no campo de busca moderno */
.search-box-modern input:focus {
    background: #f8fafc;
    transition: background 0.3s ease;
}

/* Badge de contagem no botão de filtros */
.filter-btn-modern::after {
    content: '';
    position: absolute;
    top: -2px;
    right: -2px;
    width: 8px;
    height: 8px;
    background: #ef4444;
    border-radius: 50%;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.filter-btn-modern.has-active-filters::after {
    opacity: 1;
}

/* Layout moderno para Top Usuários Mais Ativos */
.top-users-modern-section {
    background: white;
    border-radius: 16px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    padding: 0;
    margin-bottom: 32px;
    border: 1px solid #e2e8f0;
    overflow: hidden;
}

.section-header-modern {
    background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
    padding: 24px 32px;
    border-bottom: 1px solid #e2e8f0;
}

.header-left-modern {
    margin-bottom: 20px;
}

.section-title-modern {
    display: flex;
    align-items: flex-start;
    gap: 16px;
}

.title-icon {
    background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
    width: 48px;
    height: 48px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    box-shadow: 0 4px 12px rgba(251, 191, 36, 0.3);
}

.title-icon i {
    color: white;
    font-size: 20px;
}

.title-content h2 {
    font-size: 24px;
    font-weight: 700;
    color: #1f2937;
    margin: 0 0 8px 0;
}

.title-description {
    margin-bottom: 12px;
}

.title-description span {
    color: #6b7280;
    font-size: 16px;
    font-weight: 400;
}

.title-stats {
    display: flex;
    gap: 24px;
    flex-wrap: wrap;
}

.stat-item {
    display: flex;
    align-items: center;
    gap: 6px;
    color: #374151;
    font-size: 14px;
    font-weight: 500;
}

.stat-item i {
    color: #6b7280;
    font-size: 14px;
}

/* Controles em linha horizontal */
.controls-row-modern {
    display: flex;
    align-items: center;
    gap: 16px;
    flex-wrap: wrap;
}

.search-control-modern {
    flex: 1;
    min-width: 280px;
}

.search-box-modern {
    position: relative;
    display: flex;
    align-items: center;
    background: white;
    border: 2px solid #e2e8f0;
    border-radius: 10px;
    padding: 0 16px;
    transition: all 0.3s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    height: 44px;
}

.search-box-modern:focus-within {
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.search-box-modern i {
    color: #6b7280;
    font-size: 16px;
    margin-right: 12px;
}

.search-box-modern input {
    border: none;
    outline: none;
    flex: 1;
    font-size: 14px;
    color: #374151;
    background: transparent;
}

.search-box-modern input::placeholder {
    color: #9ca3af;
}

.filter-control-modern,
.export-control-modern {
    flex-shrink: 0;
}

.export-btn-modern {
    background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
    border: none;
    color: white;
    padding: 12px 20px;
    border-radius: 10px;
    font-weight: 600;
    font-size: 14px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.3s ease;
    box-shadow: 0 2px 8px rgba(59, 130, 246, 0.2);
    height: 44px;
}

.export-btn-modern:hover {
    background: linear-gradient(135deg, #1d4ed8 0%, #1e40af 100%);
    transform: translateY(-2px);
    box-shadow: 0 4px 16px rgba(59, 130, 246, 0.3);
}

.view-modes-modern {
    display: flex;
    align-items: center;
    gap: 16px;
    margin-left: auto;
}

.user-count-modern {
    color: #6b7280;
    font-size: 14px;
    font-weight: 600;
    white-space: nowrap;
}

.view-toggle-modern {
    display: flex;
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 8px;
    overflow: hidden;
}

.mode-btn-modern {
    background: transparent;
    border: none;
    padding: 10px 12px;
    cursor: pointer;
    color: #6b7280;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.mode-btn-modern:hover {
    background: #f1f5f9;
    color: #374151;
}

.mode-btn-modern.active {
    background: #3b82f6;
    color: white;
}

.mode-btn-modern i {
    font-size: 14px;
}

/* Responsividade */
@media (max-width: 1024px) {
    .controls-row-modern {
        flex-direction: column;
        align-items: stretch;
        gap: 12px;
    }
    
    .search-control-modern {
        min-width: auto;
    }
    
    .view-modes-modern {
        margin-left: 0;
        justify-content: space-between;
    }
}

@media (max-width: 768px) {
    .section-header-modern {
        padding: 20px;
    }
    
    .section-title-modern {
        flex-direction: column;
        gap: 12px;
        text-align: center;
    }
    
    .title-stats {
        justify-content: center;
        gap: 16px;
    }
    
    .stat-item {
        font-size: 13px;
    }
    
    .controls-row-modern {
        gap: 16px;
    }
    
    .title-content h2 {
        font-size: 20px;
    }
    
    .filter-dropdown-menu {
        left: auto;
        right: 0;
        min-width: 200px;
    }
}

/* Melhorias na barra de filtros */
.advanced-filters-bar {
    position: relative;
    overflow: hidden;
}

.advanced-filters-bar::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent, #3b82f6, transparent);
    opacity: 0;
    transition: opacity 0.3s ease;
}

.advanced-filters-bar:hover::before {
    opacity: 1;
}

/* Notificações melhoradas */
.notification {
    backdrop-filter: blur(10px) !important;
    border: 1px solid rgba(255, 255, 255, 0.2) !important;
    border-radius: 12px !important;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1) !important;
    font-size: 14px !important;
    max-width: 400px !important;
    word-wrap: break-word !important;
}

/* Efeitos de hover melhorados */
.filter-option:hover {
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    border-color: #3b82f6;
}

/* Removido - agora usando .export-btn-modern */

/* Indicadores de carregamento */
.loading-indicator {
    display: inline-block;
    width: 16px;
    height: 16px;
    border: 2px solid #f3f4f6;
    border-radius: 50%;
    border-top-color: #3b82f6;
    animation: spin 1s ease-in-out infinite;
}

/* Highlight de texto na busca */
mark {
    background: linear-gradient(135deg, #fef3c7 0%, #fcd34d 100%);
    color: #1f2937;
    padding: 2px 4px;
    border-radius: 3px;
    font-weight: 600;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    animation: highlightPulse 0.5s ease-in-out;
}

@keyframes highlightPulse {
    0% {
        background: #fef3c7;
        transform: scale(1);
    }
    50% {
        background: #fcd34d;
        transform: scale(1.05);
    }
    100% {
        background: #fef3c7;
        transform: scale(1);
    }
}

/* Melhorias no botão de exportar moderno */
.export-btn-modern {
    position: relative;
    overflow: hidden;
}

.export-btn-modern::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
    transition: left 0.5s ease;
}

.export-btn-modern:hover::before {
    left: 100%;
}

/* Estados dos filtros */
.filter-option input[type="checkbox"]:checked + label::after {
    content: ' ✓';
    color: #3b82f6;
    font-weight: bold;
}

/* Animação para contador de usuários */
#userCount {
    transition: all 0.3s ease;
}

#userCount.updating {
    color: #3b82f6;
    transform: scale(1.1);
}

/* Sistema de notificações aprimorado */
.notification-container {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 10000;
    pointer-events: none;
}

.notification {
    pointer-events: auto;
    margin-bottom: 10px;
    animation: slideInRight 0.3s ease;
}

@keyframes slideInRight {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

.footer-info {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: #64748b;
    font-size: 0.9rem;
}

.period-counter {
    padding: 0.5rem 1rem;
    background: rgba(59, 130, 246, 0.1);
    border-radius: 8px;
    color: #3b82f6;
    font-weight: 600;
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.info-icon {
    color: #3b82f6;
}

/* Indicador de dados carregados */
.data-loaded {
    animation: dataFadeIn 0.5s ease-in-out;
}

@keyframes dataFadeIn {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}
</style>

<!-- Background Premium -->
<div class="reports-background">
    <div class="animated-gradient"></div>
    <div class="floating-particles"></div>
</div>

<div class="reports-container">
    <!-- Breadcrumb -->
    <nav class="breadcrumb-reports">
        <a href="{% url 'home' %}" class="breadcrumb-link">
            <i class="fas fa-home"></i>
            <span>Dashboard</span>
        </a>
        <div class="breadcrumb-separator"><i class="fas fa-chevron-right"></i></div>
        <a href="{% url 'configuracoes' %}" class="breadcrumb-link">
            <i class="fas fa-cog"></i>
            <span>Configurações</span>
        </a>
        <div class="breadcrumb-separator"><i class="fas fa-chevron-right"></i></div>
        <span class="breadcrumb-current">
            <i class="fas fa-chart-line"></i>
            <span>Relatórios do Sistema</span>
        </span>
    </nav>

    <!-- Header -->
    <div class="reports-header">
        <div class="header-content">
            <div class="header-icon">
                <i class="fas fa-chart-line"></i>
                <div class="pulse-animation"></div>
            </div>
            <div class="header-text">
                <h1>Relatórios e Analytics</h1>
                <p>Análises detalhadas e insights do sistema</p>
            </div>
        </div>
        <div class="header-controls">
            <div class="period-selector-modern">
                <button class="period-button" onclick="openPeriodModal()">
                    <div class="period-icon">
                        <i class="fas fa-calendar-alt"></i>
                    </div>
                    <div class="period-text">
                        <span class="current-period">
                            {% if periodo_selecionado == '12' %}Últimos 12 meses
                            {% elif periodo_selecionado == '9' %}Últimos 9 meses
                            {% elif periodo_selecionado == '6' %}Últimos 6 meses
                            {% elif periodo_selecionado == '3' %}Últimos 3 meses
                            {% elif periodo_selecionado == '1' %}Último mês
                            {% else %}Últimos 12 meses{% endif %}
                        </span>
                        <small>Período de análise</small>
                    </div>
                    <div class="period-arrow">
                        <i class="fas fa-chevron-down"></i>
                    </div>
                </button>
            </div>
            
            <div class="quick-actions">
                <button class="action-btn" onclick="refreshData()" title="Atualizar dados">
                    <i class="fas fa-sync-alt"></i>
                </button>
                <button class="action-btn" onclick="exportReport()" title="Exportar relatório">
                    <i class="fas fa-download"></i>
                </button>
                <button class="action-btn" onclick="shareReport()" title="Compartilhar">
                    <i class="fas fa-share-alt"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Estatísticas Gerais Premium -->
    <div class="stats-overview-premium">
        <!-- Card de Usuários -->
        <div class="stat-card-premium users" data-animation="fadeInUp" data-delay="0.1s">
            <div class="card-background">
                <div class="floating-shapes">
                    <div class="shape-1"></div>
                    <div class="shape-2"></div>
                    <div class="shape-3"></div>
                </div>
            </div>
            <div class="card-header-premium">
                <div class="stat-icon-premium">
                    <i class="fas fa-users-crown"></i>
                    <div class="icon-glow"></div>
                </div>
                <div class="card-badge-premium">
                    <i class="fas fa-trending-up"></i>
                    <span>+{{ analises.crescimento_usuarios|default:"0" }}%</span>
                </div>
            </div>
            <div class="card-content-premium">
                <div class="stat-number-premium">
                    <span class="number-counter" data-target="{{ stats_gerais.total_usuarios }}">0</span>
                </div>
                <div class="stat-label-premium">Usuários Total</div>
                <div class="stat-detail-premium">
                    <div class="detail-item">
                        <i class="fas fa-circle active-dot"></i>
                        <span>{{ stats_gerais.usuarios_ativos }} ativos</span>
                    </div>
                    <div class="detail-item">
                        <i class="fas fa-circle inactive-dot"></i>
                        <span>{% widthratio stats_gerais.total_usuarios 1 1 %}{% widthratio stats_gerais.usuarios_ativos -1 1 %} inativos</span>
                    </div>
                </div>
            </div>
            <div class="card-progress-premium">
                <div class="progress-bar-premium">
                    <div class="progress-fill-premium users" style="width: {{ stats_gerais.usuarios_ativos|percentage:stats_gerais.total_usuarios|floatformat:1 }}%"></div>
                </div>
                <span class="progress-text-premium">{{ stats_gerais.usuarios_ativos|percentage:stats_gerais.total_usuarios|floatformat:1 }}% ativo</span>
            </div>
        </div>

        <!-- Card de Unidades de Saúde -->
        <div class="stat-card-premium units" data-animation="fadeInUp" data-delay="0.2s">
            <div class="card-background">
                <div class="floating-shapes">
                    <div class="shape-1"></div>
                    <div class="shape-2"></div>
                    <div class="shape-3"></div>
                </div>
            </div>
            <div class="card-header-premium">
                <div class="stat-icon-premium">
                    <i class="fas fa-hospital-alt"></i>
                    <div class="icon-glow"></div>
                </div>
                <div class="card-badge-premium stable">
                    <i class="fas fa-shield-check"></i>
                    <span>Estável</span>
                </div>
            </div>
            <div class="card-content-premium">
                <div class="stat-number-premium">
                    <span class="number-counter" data-target="{{ stats_gerais.total_unidades }}">0</span>
                </div>
                <div class="stat-label-premium">Unidades Saúde</div>
                <div class="stat-detail-premium">
                    <div class="detail-item">
                        <i class="fas fa-map-marker-alt"></i>
                        <span>Todas as regiões</span>
                    </div>
                    <div class="detail-item">
                        <i class="fas fa-stethoscope"></i>
                        <span>Sistema integrado</span>
                    </div>
                </div>
            </div>
            <div class="card-progress-premium">
                <div class="network-visualization">
                    <div class="network-nodes">
                        <div class="node main"></div>
                        <div class="node secondary"></div>
                        <div class="node secondary"></div>
                        <div class="node secondary"></div>
                    </div>
                    <div class="network-connections"></div>
                </div>
                <span class="progress-text-premium">Rede conectada</span>
            </div>
        </div>

        <!-- Card de Chamadas -->
        <div class="stat-card-premium calls" data-animation="fadeInUp" data-delay="0.3s">
            <div class="card-background">
                <div class="floating-shapes">
                    <div class="shape-1"></div>
                    <div class="shape-2"></div>
                    <div class="shape-3"></div>
                </div>
            </div>
            <div class="card-header-premium">
                <div class="stat-icon-premium">
                    <i class="fas fa-phone-volume"></i>
                    <div class="icon-glow"></div>
                </div>
                <div class="card-badge-premium growing">
                    <i class="fas fa-chart-line"></i>
                    <span>Crescendo</span>
                </div>
            </div>
            <div class="card-content-premium">
                <div class="stat-number-premium">
                    <span class="number-counter" data-target="{{ stats_gerais.total_chamadas }}">0</span>
                </div>
                <div class="stat-label-premium">Chamadas Total</div>
                <div class="stat-detail-premium">
                    <div class="detail-item">
                        <i class="fas fa-check-circle resolved"></i>
                        <span>{{ chamadas_stats.por_status.Resolvida|default:"0" }} resolvidas</span>
                    </div>
                    <div class="detail-item">
                        <i class="fas fa-clock pending"></i>
                        <span>{{ chamadas_stats.por_status.Aberta|default:"0" }} abertas</span>
                    </div>
                </div>
            </div>
            <div class="card-progress-premium">
                <div class="call-activity">
                    <div class="activity-bars">
                        <div class="bar" style="height: 60%"></div>
                        <div class="bar" style="height: 80%"></div>
                        <div class="bar" style="height: 40%"></div>
                        <div class="bar" style="height: 90%"></div>
                        <div class="bar" style="height: 70%"></div>
                    </div>
                </div>
                <span class="progress-text-premium">Volume alto</span>
            </div>
        </div>

        <!-- Card de Administradores -->
        <div class="stat-card-premium admins" data-animation="fadeInUp" data-delay="0.4s">
            <div class="card-background">
                <div class="floating-shapes">
                    <div class="shape-1"></div>
                    <div class="shape-2"></div>
                    <div class="shape-3"></div>
                </div>
            </div>
            <div class="card-header-premium">
                <div class="stat-icon-premium">
                    <i class="fas fa-shield-virus"></i>
                    <div class="icon-glow"></div>
                </div>
                <div class="card-badge-premium secure">
                    <i class="fas fa-lock"></i>
                    <span>Seguro</span>
                </div>
            </div>
            <div class="card-content-premium">
                <div class="stat-number-premium">
                    <span class="number-counter" data-target="{{ stats_gerais.usuarios_admins }}">0</span>
                </div>
                <div class="stat-label-premium">Administradores</div>
                <div class="stat-detail-premium">
                    <div class="detail-item">
                        <i class="fas fa-key security-key"></i>
                        <span>Acesso total</span>
                    </div>
                    <div class="detail-item">
                        <i class="fas fa-user-tie"></i>
                        <span>Controle sistema</span>
                    </div>
                </div>
            </div>
            <div class="card-progress-premium">
                <div class="security-indicator">
                    <div class="security-rings">
                        <div class="ring ring-1"></div>
                        <div class="ring ring-2"></div>
                        <div class="ring ring-3"></div>
                    </div>
                    <div class="security-core"></div>
                </div>
                <span class="progress-text-premium">Máxima segurança</span>
            </div>
        </div>
    </div>

    <!-- Insights Automáticos Simplificados -->
    {% if analises.insights %}
        {% if analises.insights|length > 0 %}
        <div class="insights-section-simple">
            <div class="insights-container">
                <div class="insights-header-simple">
                    <div class="insights-title-simple">
            <i class="fas fa-lightbulb"></i>
                        <h3>Insights Automáticos</h3>
                    </div>
                    <span class="insights-count">{{ analises.insights|length }} insight{{ analises.insights|length|pluralize }}</span>
                </div>
                
                <div class="insights-cards">
            {% for insight in analises.insights %}
                    <div class="insight-card-simple insight-{{ insight.tipo }}">
                        <div class="insight-icon-simple">
                    {% if insight.tipo == 'positivo' %}
                        <i class="fas fa-thumbs-up"></i>
                    {% elif insight.tipo == 'destaque' %}
                        <i class="fas fa-star"></i>
                    {% else %}
                        <i class="fas fa-info-circle"></i>
                    {% endif %}
                </div>
                        <div class="insight-content-simple">
                            <h4>{{ insight.titulo }}</h4>
                    <p>{{ insight.descricao }}</p>
                            
                            {% if insight.titulo == "Alta Taxa de Usuários Ativos" %}
                            <div class="insight-stats">
                                <div class="stat-item-simple">
                                    <span class="stat-number">{{ stats_gerais.usuarios_ativos }}</span>
                                    <span class="stat-label">Usuários Ativos</span>
                                </div>
                                <div class="stat-item-simple">
                                    <span class="stat-number">{{ stats_gerais.usuarios_ativos|percentage:stats_gerais.total_usuarios|floatformat:1 }}%</span>
                                    <span class="stat-label">Taxa Ativação</span>
                                </div>
                            </div>
                            <div class="progress-simple">
                                <div class="progress-bar-simple" style="width: {{ stats_gerais.usuarios_ativos|percentage:stats_gerais.total_usuarios|floatformat:1 }}%"></div>
                            </div>
                            {% endif %}
                </div>
            </div>
            {% endfor %}
                </div>
        </div>
    </div>
        {% endif %}
    {% endif %}

    <!-- Relatórios por Categoria -->
    <div class="reports-tabs" style="margin-top: 0 !important;">
        <div class="tab-buttons">
            <button class="tab-button active" onclick="showTab('usuarios')">
                <i class="fas fa-users"></i>
                Usuários
            </button>
            <button class="tab-button" onclick="showTab('unidades')">
                <i class="fas fa-hospital"></i>
                Unidades
            </button>
            <button class="tab-button" onclick="showTab('chamadas')">
                <i class="fas fa-phone"></i>
                Chamadas
            </button>
        </div>

                <!-- Tab Usuários - NOVA ABORDAGEM SIMPLES -->
        <div class="tab-content active" id="tab-usuarios">
            
            <!-- Seção 1: Gráfico de Usuários por Mês - VERSÃO PREMIUM -->
            <div class="usuarios-mes-premium-section">
                <!-- Header Premium -->
                <div class="section-header-premium">
                    <div class="header-left-premium">
                        <div class="section-icon-container">
                            <div class="section-icon-premium chart-icon">
                                <i class="fas fa-chart-line"></i>
                                <div class="icon-pulse"></div>
                            </div>
                        </div>
                        <div class="header-text-premium">
                            <h3>Novos Usuários por Mês</h3>
                            <p class="section-subtitle-premium">Análise temporal do crescimento da base de usuários</p>
                        </div>
                    </div>
                    <div class="header-right-premium">
                        <div class="period-indicator-premium">
                            <i class="fas fa-calendar-alt"></i>
                            <span>
                                {% if periodo_selecionado == '12' %}Últimos 12 meses
                                {% elif periodo_selecionado == '9' %}Últimos 9 meses
                                {% elif periodo_selecionado == '6' %}Últimos 6 meses
                                {% elif periodo_selecionado == '3' %}Últimos 3 meses
                                {% elif periodo_selecionado == '1' %}Último mês
                                {% else %}Últimos 12 meses{% endif %}
                            </span>
                        </div>
                        <div class="export-dropdown-premium">
                            <button class="export-btn-premium" onclick="toggleExportDropdown('usuarios-mes-dropdown')">
                                <i class="fas fa-download"></i>
                                <span>Exportar</span>
                                <i class="fas fa-chevron-down"></i>
                            </button>
                            <div class="dropdown-menu-premium" id="usuarios-mes-dropdown">
                                <a href="{% url 'export_relatorio_usuarios_mes_excel' %}?periodo={{ periodo_selecionado }}" class="dropdown-item-premium excel">
                                    <div class="item-icon">
                                        <i class="fas fa-file-excel"></i>
                                    </div>
                                    <div class="item-content">
                                        <span class="item-title">Excel Completo</span>
                                        <span class="item-desc">Dados detalhados (.xlsx)</span>
                                    </div>
                                </a>
                                <a href="{% url 'export_relatorio_usuarios_mes_pdf' %}?periodo={{ periodo_selecionado }}" class="dropdown-item-premium pdf">
                                    <div class="item-icon">
                                        <i class="fas fa-file-pdf"></i>
                                    </div>
                                    <div class="item-content">
                                        <span class="item-title">Relatório PDF</span>
                                        <span class="item-desc">Documento completo (.pdf)</span>
                                    </div>
                                </a>
                                <a href="{% url 'export_relatorio_usuarios_mes_csv' %}?periodo={{ periodo_selecionado }}" class="dropdown-item-premium csv">
                                    <div class="item-icon">
                                        <i class="fas fa-file-csv"></i>
                                    </div>
                                    <div class="item-content">
                                        <span class="item-title">Dados CSV</span>
                                        <span class="item-desc">Planilha simples (.csv)</span>
                                    </div>
                                </a>
                                <div class="dropdown-divider-premium"></div>
                                <a href="#" class="dropdown-item-premium image" onclick="exportChart('usuarios-mes')">
                                    <div class="item-icon">
                                        <i class="fas fa-image"></i>
                                    </div>
                                    <div class="item-content">
                                        <span class="item-title">Imagem HD</span>
                                        <span class="item-desc">Gráfico em PNG (.png)</span>
                                    </div>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Estatísticas Rápidas Premium -->
                <div class="quick-stats-premium">
                    <div class="stat-card-premium total">
                        <div class="stat-icon-premium">
                            <i class="fas fa-users"></i>
                            <div class="icon-background"></div>
                        </div>
                        <div class="stat-content-premium">
                            <div class="stat-number-premium">{{ stats_gerais.total_usuarios }}</div>
                            <div class="stat-label-premium">Total de Usuários</div>
                            <div class="stat-trend-premium positive">
                                <i class="fas fa-arrow-up"></i>
                                <span>+{{ usuarios_stats.usuarios_mes_atual|default:0 }} este mês</span>
                            </div>
                        </div>
                        <div class="stat-sparkline-premium">
                            <canvas id="total-sparkline" width="80" height="30"></canvas>
                        </div>
                    </div>

                    <div class="stat-card-premium active">
                        <div class="stat-icon-premium">
                            <i class="fas fa-user-check"></i>
                            <div class="icon-background"></div>
                        </div>
                        <div class="stat-content-premium">
                            <div class="stat-number-premium">{{ stats_gerais.usuarios_ativos }}</div>
                            <div class="stat-label-premium">Usuários Ativos</div>
                            <div class="stat-trend-premium">
                                <i class="fas fa-percentage"></i>
                                <span>{{ stats_gerais.usuarios_ativos|percentage:stats_gerais.total_usuarios|floatformat:1 }}% do total</span>
                            </div>
                        </div>
                        <div class="stat-progress-premium">
                            <div class="progress-circle-premium">
                                <svg width="60" height="60">
                                    <circle cx="30" cy="30" r="25" class="progress-bg"></circle>
                                    <circle cx="30" cy="30" r="25" class="progress-fill" 
                                            style="stroke-dasharray: {{ stats_gerais.usuarios_ativos|percentage:stats_gerais.total_usuarios|floatformat:1 }} 100"></circle>
                                </svg>
                                <div class="progress-text">{{ stats_gerais.usuarios_ativos|percentage:stats_gerais.total_usuarios|floatformat:0 }}%</div>
                            </div>
                        </div>
                    </div>

                    <div class="stat-card-premium new">
                        <div class="stat-icon-premium">
                            <i class="fas fa-user-plus"></i>
                            <div class="icon-background"></div>
                        </div>
                        <div class="stat-content-premium">
                            <div class="stat-number-premium">{{ usuarios_stats.usuarios_mes_atual|default:0 }}</div>
                            <div class="stat-label-premium">Novos Este Mês</div>
                            <div class="stat-trend-premium {% if usuarios_stats.usuarios_mes_atual > 0 %}positive{% else %}neutral{% endif %}">
                                <i class="fas fa-{% if usuarios_stats.usuarios_mes_atual > 0 %}plus{% else %}minus{% endif %}"></i>
                                <span>{% if usuarios_stats.usuarios_mes_atual > 0 %}Crescimento{% else %}Sem novos{% endif %}</span>
                            </div>
                        </div>
                        <div class="stat-badge-premium">
                            {% if usuarios_stats.usuarios_mes_atual > 0 %}
                                <span class="badge-new">NOVO</span>
                            {% else %}
                                <span class="badge-stable">ESTÁVEL</span>
                            {% endif %}
                        </div>
                    </div>

                    <div class="stat-card-premium growth">
                        <div class="stat-icon-premium">
                            <i class="fas fa-chart-line"></i>
                            <div class="icon-background"></div>
                        </div>
                        <div class="stat-content-premium">
                            <div class="stat-number-premium">
                                {% if usuarios_stats.usuarios_mes_atual > 0 %}+{{ usuarios_stats.usuarios_mes_atual|percentage:stats_gerais.total_usuarios|floatformat:1 }}%{% else %}0%{% endif %}
                            </div>
                            <div class="stat-label-premium">Taxa de Crescimento</div>
                            <div class="stat-trend-premium {% if usuarios_stats.usuarios_mes_atual > 0 %}positive{% else %}neutral{% endif %}">
                                <i class="fas fa-{% if usuarios_stats.usuarios_mes_atual > 0 %}trending-up{% else %}equals{% endif %}"></i>
                                <span>{% if usuarios_stats.usuarios_mes_atual > 0 %}Em alta{% else %}Estável{% endif %}</span>
                            </div>
                        </div>
                        <div class="stat-mini-chart-premium">
                            <div class="mini-bars">
                                <div class="bar" style="height: 20%"></div>
                                <div class="bar" style="height: 40%"></div>
                                <div class="bar" style="height: 60%"></div>
                                <div class="bar" style="height: {% if usuarios_stats.usuarios_mes_atual > 0 %}80%{% else %}30%{% endif %}"></div>
                                <div class="bar active" style="height: {% if usuarios_stats.usuarios_mes_atual > 0 %}100%{% else %}40%{% endif %}"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Gráfico Principal Premium -->
                <div class="chart-container-premium">
                    <div class="chart-header-premium">
                        <div class="chart-title">
                            <h4>Evolução Temporal de Usuários</h4>
                            <p>Tendência de crescimento baseada nos últimos {{ periodo_selecionado|default:"12" }} meses</p>
                        </div>
                        <div class="chart-controls">
                            <div class="chart-legends">
                                <div class="legend-item">
                                    <div class="legend-color primary"></div>
                                    <span>Novos Usuários</span>
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color secondary"></div>
                                    <span>Meta Mensal</span>
                                </div>
                            </div>
                            <div class="chart-view-toggle">
                                <button class="view-btn active" data-view="line">
                                    <i class="fas fa-chart-line"></i>
                                </button>
                                <button class="view-btn" data-view="bar">
                                    <i class="fas fa-chart-bar"></i>
                                </button>
                                <button class="view-btn" data-view="area">
                                    <i class="fas fa-chart-area"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="chart-wrapper-premium">
                        <div class="chart-overlay">
                            <div class="loading-chart">
                                <i class="fas fa-chart-line"></i>
                                <span>Carregando dados...</span>
                            </div>
                        </div>
                        <canvas id="usuarios-mes-chart" style="height: 400px;"></canvas>
                    </div>

                    <!-- Insights do Gráfico -->
                    <div class="chart-insights-premium">
                        <div class="insight-item">
                            <div class="insight-icon trending-up">
                                <i class="fas fa-trending-up"></i>
                            </div>
                            <div class="insight-content">
                                <h5>Tendência Identificada</h5>
                                <p>
                                    {% if usuarios_stats.usuarios_mes_atual > 0 %}
                                        Crescimento positivo com {{ usuarios_stats.usuarios_mes_atual }} novos usuários neste mês
                                    {% else %}
                                        Período estável sem novos cadastros este mês
                                    {% endif %}
                                </p>
                            </div>
                        </div>
                        
                        <div class="insight-item">
                            <div class="insight-icon analytics">
                                <i class="fas fa-analytics"></i>
                            </div>
                            <div class="insight-content">
                                <h5>Análise de Performance</h5>
                                <p>{{ stats_gerais.usuarios_ativos|percentage:stats_gerais.total_usuarios|floatformat:1 }}% dos usuários estão ativos, indicando boa retenção</p>
                            </div>
                        </div>

                        <div class="insight-item">
                            <div class="insight-icon target">
                                <i class="fas fa-bullseye"></i>
                            </div>
                            <div class="insight-content">
                                <h5>Meta Recomendada</h5>
                                <p>Manter pelo menos 2-3 novos usuários por mês para crescimento sustentável</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Seção 2: Top Usuários Mais Ativos -->
            <div class="simple-section">
                <div class="section-header">
                    <h3>
                        <i class="fas fa-trophy"></i>
                        Top Usuários Mais Ativos
                    </h3>
                    <div class="section-controls">
                        <div class="count-badge">
                            <span id="userCount">{{ usuarios_stats.top_usuarios|length }}</span> usuários
                        </div>
                        <div class="view-toggle">
                            <button class="toggle-btn active" data-view="table">
                                <i class="fas fa-list"></i>
                            </button>
                            <button class="toggle-btn" data-view="cards">
                                <i class="fas fa-th-large"></i>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="section-content">
                    <!-- Visualização em Tabela -->
                    <div class="users-table-view active" id="tableView">
                        <div class="table-responsive">
                            <table class="users-table">
                                <thead>
                                    <tr>
                                        <th>Posição</th>
                                        <th>Usuário</th>
                                        <th>Chamadas</th>
                                        <th>Unidades</th>
                                        <th>Taxa Resolução</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for user_data in usuarios_stats.top_usuarios|slice:":10" %}
                                    <tr class="user-row {% if forloop.counter <= 3 %}top-user{% endif %}">
                                        <td class="rank-cell">
                                            {% if forloop.counter == 1 %}
                                                <div class="rank-badge gold">
                                                    <i class="fas fa-crown"></i>
                                                    <span>#1</span>
                                                </div>
                                            {% elif forloop.counter == 2 %}
                                                <div class="rank-badge silver">
                                                    <i class="fas fa-medal"></i>
                                                    <span>#2</span>
                                                </div>
                                            {% elif forloop.counter == 3 %}
                                                <div class="rank-badge bronze">
                                                    <i class="fas fa-award"></i>
                                                    <span>#3</span>
                                                </div>
                                            {% else %}
                                                <div class="rank-badge">
                                                    <span>#{{ forloop.counter }}</span>
                                                </div>
                                            {% endif %}
                                        </td>
                                        <td class="user-info">
                                            <div class="user-avatar">
                                                {{ user_data.usuario.get_full_name.0|default:user_data.usuario.username.0|upper }}
                                            </div>
                                            <div class="user-details">
                                                <div class="user-name">
                                                    {{ user_data.usuario.get_full_name|default:user_data.usuario.username }}
                                                    {% if forloop.counter <= 3 %}
                                                        <i class="fas fa-star top-star"></i>
                                                    {% endif %}
                                                </div>
                                                <div class="user-username">@{{ user_data.usuario.username }}</div>
                                            </div>
                                        </td>
                                        <td class="metric-cell">
                                            <div class="metric-value">{{ user_data.total_chamadas }}</div>
                                            <div class="metric-label">total</div>
                                        </td>
                                        <td class="metric-cell">
                                            <div class="metric-value">{{ user_data.unidades_cadastradas }}</div>
                                            <div class="metric-label">cadastradas</div>
                                        </td>
                                        <td class="metric-cell">
                                            <div class="progress-circle">
                                                <div class="progress-text">{{ user_data.taxa_resolucao }}%</div>
                                            </div>
                                        </td>
                                        <td class="status-cell">
                                            {% if user_data.usuario.is_staff %}
                                                <span class="status-badge admin">
                                                    <i class="fas fa-shield-alt"></i>
                                                    Admin
                                                </span>
                                            {% else %}
                                                <span class="status-badge user">
                                                    <i class="fas fa-user"></i>
                                                    Usuário
                                                </span>
                                            {% endif %}
                                        </td>
                                    </tr>
                                    {% empty %}
                                    <tr>
                                        <td colspan="6" class="empty-state">
                                            <div class="empty-icon">
                                                <i class="fas fa-users"></i>
                                            </div>
                                            <h4>Nenhum usuário encontrado</h4>
                                            <p>Não há dados de usuários ativos para exibir</p>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Visualização em Cards -->
                    <div class="users-cards-view" id="cardsView">
                        <div class="cards-grid">
                            {% for user_data in usuarios_stats.top_usuarios|slice:":6" %}
                            <div class="user-card {% if forloop.counter <= 3 %}top-user-card{% endif %}">
                                <div class="card-header">
                                    <div class="rank-indicator">
                                        {% if forloop.counter == 1 %}
                                            <i class="fas fa-crown gold"></i>
                                        {% elif forloop.counter == 2 %}
                                            <i class="fas fa-medal silver"></i>
                                        {% elif forloop.counter == 3 %}
                                            <i class="fas fa-award bronze"></i>
                                        {% else %}
                                            <span class="rank-num">#{{ forloop.counter }}</span>
                                        {% endif %}
                                    </div>
                                    <div class="user-avatar">
                                        {{ user_data.usuario.get_full_name.0|default:user_data.usuario.username.0|upper }}
                                    </div>
                                </div>
                                <div class="card-body">
                                    <h4>{{ user_data.usuario.get_full_name|default:user_data.usuario.username }}</h4>
                                    <p>@{{ user_data.usuario.username }}</p>
                                    <div class="card-metrics">
                                        <div class="metric">
                                            <i class="fas fa-phone"></i>
                                            <span>{{ user_data.total_chamadas }} chamadas</span>
                                        </div>
                                        <div class="metric">
                                            <i class="fas fa-hospital"></i>
                                            <span>{{ user_data.unidades_cadastradas }} unidades</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-footer">
                                    {% if user_data.usuario.is_staff %}
                                        <span class="role-tag admin">Administrador</span>
                                    {% else %}
                                        <span class="role-tag user">Usuário</span>
                                    {% endif %}
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Seção 3: Distribuição de Usuários -->
            <div class="simple-section">
                <div class="section-header">
                    <h3><i class="fas fa-chart-pie"></i> Distribuição de Usuários</h3>
                            </div>
                <div class="section-content">
                    <div class="distribution-grid">
                        <div class="dist-item">
                            <div class="dist-icon user">
                                <i class="fas fa-user"></i>
                        </div>
                            <div class="dist-info">
                                <div class="dist-number">{{ usuarios_stats.por_tipo.usuarios_comuns }}</div>
                                <div class="dist-label">Usuários Comuns</div>
                                <div class="dist-percent">{{ usuarios_stats.por_tipo.usuarios_comuns|percentage:stats_gerais.total_usuarios|floatformat:1 }}%</div>
                            </div>
                            <div class="dist-bar">
                                <div class="dist-fill user" style="width: {{ usuarios_stats.por_tipo.usuarios_comuns|percentage:stats_gerais.total_usuarios|floatformat:1 }}%"></div>
                        </div>
                    </div>
                        
                        <div class="dist-item">
                            <div class="dist-icon admin">
                                <i class="fas fa-shield-alt"></i>
                </div>
                            <div class="dist-info">
                                <div class="dist-number">{{ usuarios_stats.por_tipo.administradores }}</div>
                                <div class="dist-label">Administradores</div>
                                <div class="dist-percent">{{ usuarios_stats.por_tipo.administradores|percentage:stats_gerais.total_usuarios|floatformat:1 }}%</div>
            </div>
                            <div class="dist-bar">
                                <div class="dist-fill admin" style="width: {{ usuarios_stats.por_tipo.administradores|percentage:stats_gerais.total_usuarios|floatformat:1 }}%"></div>
                            </div>
                        </div>
                        
                        <div class="dist-item">
                            <div class="dist-icon active">
                                <i class="fas fa-user-check"></i>
                            </div>
                            <div class="dist-info">
                                <div class="dist-number">{{ stats_gerais.usuarios_ativos }}</div>
                                <div class="dist-label">Usuários Ativos</div>
                                <div class="dist-percent">{{ stats_gerais.usuarios_ativos|percentage:stats_gerais.total_usuarios|floatformat:1 }}%</div>
                            </div>
                            <div class="dist-bar">
                                <div class="dist-fill active" style="width: {{ stats_gerais.usuarios_ativos|percentage:stats_gerais.total_usuarios|floatformat:1 }}%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <!-- Tab Unidades -->
        <div class="tab-content" id="tab-unidades">
            <div class="reports-grid">
                <div class="chart-card">
                    <div class="chart-header">
                        <h3>Unidades por Município (Top 5)</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="unidades-municipio-chart"></canvas>
                    </div>
                </div>

                <div class="data-card">
                    <h3>Unidades Mais Ativas</h3>
                    <div class="data-list">
                        {% for unidade_data in unidades_stats.mais_ativas|slice:":5" %}
                        <div class="data-item">
                            <div class="item-icon">
                                <i class="fas fa-hospital"></i>
                            </div>
                            <div class="item-content">
                                <strong>{{ unidade_data.unidade.nome }}</strong>
                                <span>{{ unidade_data.unidade.municipio }} • {{ unidade_data.total_chamadas }} chamadas</span>
                            </div>
                            <div class="item-badge">{{ unidade_data.total_chamadas }}</div>
                        </div>
                        {% endfor %}
                    </div>
                </div>

                <div class="stats-card">
                    <h3>Tipos de Unidades</h3>
                    <div class="stats-list">
                        {% for tipo, count in unidades_stats.por_tipo.items %}
                        <div class="stat-row">
                            <span class="stat-label">{{ tipo }}</span>
                            <div class="stat-bar">
                                {% if stats_gerais.total_unidades > 0 %}
                                    <div class="stat-fill" style="width: {{ count|percentage:stats_gerais.total_unidades|floatformat:1 }}%"></div>
                                {% else %}
                                    <div class="stat-fill" style="width: 0%"></div>
                                {% endif %}
                            </div>
                            <span class="stat-value">{{ count }}</span>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab Chamadas -->
        <div class="tab-content" id="tab-chamadas">
            <div class="reports-grid">
                <div class="chart-card">
                    <div class="chart-header">
                        <h3>Chamadas por Tipo</h3>
                    </div>
                    <div class="chart-container">
                        <canvas id="chamadas-tipo-chart"></canvas>
                    </div>
                </div>

                <div class="stats-card">
                    <h3>Status das Chamadas</h3>
                    <div class="stats-list">
                        {% for status, count in chamadas_stats.por_status.items %}
                        <div class="stat-row">
                            <span class="stat-label">{{ status }}</span>
                            <div class="stat-bar">
                                {% if stats_gerais.total_chamadas > 0 %}
                                    <div class="stat-fill status-{{ status|lower }}" style="width: {{ count|percentage:stats_gerais.total_chamadas|floatformat:1 }}%"></div>
                                {% else %}
                                    <div class="stat-fill" style="width: 0%"></div>
                                {% endif %}
                            </div>
                            <span class="stat-value">{{ count }}</span>
                        </div>
                        {% endfor %}
                    </div>
                </div>

                <div class="summary-card">
                    <h3>Resumo Executivo</h3>
                    <div class="summary-stats">
                        <div class="summary-item">
                            <div class="summary-number">{{ stats_gerais.total_chamadas }}</div>
                            <div class="summary-label">Total de Chamadas</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-number">{{ chamadas_stats.por_status.Resolvida|default:0 }}</div>
                            <div class="summary-label">Resolvidas</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-number">{{ chamadas_stats.por_status.Aberta|default:0 }}</div>
                            <div class="summary-label">Abertas</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal de Seleção de Período -->
<div class="period-modal-overlay" id="periodModalOverlay">
    <div class="period-modal" id="periodModal">
        <div class="modal-header">
            <div class="modal-title">
                <div class="modal-icon">
                    <i class="fas fa-calendar-alt"></i>
                </div>
                <div class="modal-title-text">
                    <h2>Selecionar Período</h2>
                    <p>Escolha o período para análise dos dados</p>
                </div>
            </div>
            <button class="modal-close" onclick="closePeriodModal()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="modal-body-modern">
            <div class="period-options">
                <!-- Opção: Último mês -->
                <div class="period-option {% if periodo_selecionado == '1' %}selected{% endif %}" 
                     data-period="1" data-label="Último mês">
                    <div class="option-header">
                        <div class="option-icon month">
                            <i class="fas fa-calendar-day"></i>
                        </div>
                        <div class="option-badge">30d</div>
                    </div>
                    <div class="option-content">
                        <h3>Últimos 30 dias</h3>
                        <p>Análise detalhada dos dados mais recentes</p>
                        <div class="option-features">
                            <span class="feature">
                                <i class="fas fa-bolt"></i>
                                Dados recentes
                            </span>
                            <span class="feature">
                                <i class="fas fa-clock"></i>
                                Atualização rápida
                            </span>
                        </div>
                    </div>
                    <div class="option-selector">
                        <div class="radio-custom">
                            <div class="radio-dot"></div>
                        </div>
                    </div>
                </div>

                <!-- Opção: Últimos 3 meses -->
                <div class="period-option {% if periodo_selecionado == '3' %}selected{% endif %}" 
                     data-period="3" data-label="Últimos 3 meses">
                    <div class="option-header">
                        <div class="option-icon quarter">
                            <i class="fas fa-calendar-week"></i>
                        </div>
                        <div class="option-badge">3m</div>
                    </div>
                    <div class="option-content">
                        <h3>Últimos 3 meses</h3>
                        <p>Análise trimestral completa</p>
                        <div class="option-features">
                            <span class="feature">
                                <i class="fas fa-chart-line"></i>
                                Tendências claras
                            </span>
                            <span class="feature">
                                <i class="fas fa-target"></i>
                                Visão focada
                            </span>
                        </div>
                    </div>
                    <div class="option-selector">
                        <div class="radio-custom">
                            <div class="radio-dot"></div>
                        </div>
                    </div>
                </div>

                <!-- Opção: Últimos 6 meses -->
                <div class="period-option {% if periodo_selecionado == '6' %}selected{% endif %}" 
                     data-period="6" data-label="Últimos 6 meses">
                    <div class="option-header">
                        <div class="option-icon semester">
                            <i class="fas fa-calendar"></i>
                        </div>
                        <div class="option-badge">6m</div>
                    </div>
                    <div class="option-content">
                        <h3>Últimos 6 meses</h3>
                        <p>Análise semestral detalhada</p>
                        <div class="option-features">
                            <span class="feature">
                                <i class="fas fa-chart-area"></i>
                                Dados abrangentes
                            </span>
                            <span class="feature">
                                <i class="fas fa-search"></i>
                                Análise profunda
                            </span>
                        </div>
                    </div>
                    <div class="option-selector">
                        <div class="radio-custom">
                            <div class="radio-dot"></div>
                        </div>
                    </div>
                </div>

                <!-- Opção: Últimos 9 meses -->
                <div class="period-option {% if periodo_selecionado == '9' %}selected{% endif %}" 
                     data-period="9" data-label="Últimos 9 meses">
                    <div class="option-header">
                        <div class="option-icon three-quarters">
                            <i class="fas fa-calendar-week"></i>
                        </div>
                        <div class="option-badge">9m</div>
                    </div>
                    <div class="option-content">
                        <h3>Últimos 9 meses</h3>
                        <p>Análise de três quartos do ano</p>
                        <div class="option-features">
                            <span class="feature">
                                <i class="fas fa-chart-bar"></i>
                                Visão ampliada
                            </span>
                            <span class="feature">
                                <i class="fas fa-clock"></i>
                                Período intermediário
                            </span>
                        </div>
                    </div>
                    <div class="option-selector">
                        <div class="radio-custom">
                            <div class="radio-dot"></div>
                        </div>
                    </div>
                </div>

                <!-- Opção: Últimos 12 meses (Recomendado) -->
                <div class="period-option recommended {% if periodo_selecionado == '12' %}selected{% endif %}" 
                     data-period="12" data-label="Últimos 12 meses">
                    <div class="recommended-tag">
                        <i class="fas fa-star"></i>
                        Recomendado
                    </div>
                    <div class="option-header">
                        <div class="option-icon year">
                            <i class="fas fa-calendar-alt"></i>
                        </div>
                        <div class="option-badge">12m</div>
                    </div>
                    <div class="option-content">
                        <h3>Últimos 12 meses</h3>
                        <p>Análise anual completa</p>
                        <div class="option-features">
                            <span class="feature">
                                <i class="fas fa-calendar-check"></i>
                                Ciclo completo
                            </span>
                            <span class="feature">
                                <i class="fas fa-trending-up"></i>
                                Padrões anuais
                            </span>
                        </div>
                    </div>
                    <div class="option-selector">
                        <div class="radio-custom">
                            <div class="radio-dot"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Indicador de scroll -->
            <div class="scroll-indicator" id="scrollIndicator">
                <i class="fas fa-chevron-down"></i>
                <span>Role para ver mais opções</span>
            </div>
        </div>
        
        <div class="modal-footer-modern">
            <div class="footer-info">
                <div class="info-indicator">
                    <div class="pulse-dot"></div>
                    <span>Os dados são atualizados em tempo real</span>
                </div>
                <div class="period-counter">
                    <span>5 opções disponíveis</span>
                </div>
            </div>
            <div class="footer-actions">
                <button class="btn-cancel" onclick="closePeriodModal()">
                    Cancelar
                </button>
                <button class="btn-apply" onclick="applySelectedPeriod()" id="applyPeriodBtn">
                    <i class="fas fa-check"></i>
                    Aplicar Filtro
                </button>
            </div>
        </div>
    </div>
</div>

<style>
/* Background */
.reports-background {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}

.animated-gradient {
    position: absolute;
    width: 100%;
    height: 100%;
    background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
    background-size: 400% 400%;
    animation: gradientShift 15s ease infinite;
    opacity: 0.8;
}

@keyframes gradientShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

/* Container */
.reports-container {
    min-height: 100vh;
    padding: 2rem;
    max-width: 1400px;
    margin: 0 auto;
}

.reports-container > * {
    margin-top: 0;
}

/* Breadcrumb */
.breadcrumb-reports {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 2rem;
    padding: 1rem 1.5rem;
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(20px);
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.breadcrumb-link {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: rgba(255, 255, 255, 0.9);
    text-decoration: none;
    padding: 0.5rem;
    border-radius: 8px;
    transition: all 0.2s ease;
}

.breadcrumb-link:hover {
    background: rgba(255, 255, 255, 0.1);
    color: white;
}

.breadcrumb-separator {
    color: rgba(255, 255, 255, 0.6);
}

.breadcrumb-current {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: white;
    font-weight: 600;
    padding: 0.5rem;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 8px;
}

/* Header */
.reports-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
    padding: 2rem;
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(20px);
    border-radius: 20px;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.header-content {
    display: flex;
    align-items: center;
    gap: 1.5rem;
}

.header-icon {
    width: 80px;
    height: 80px;
    background: linear-gradient(135deg, #667eea, #764ba2);
    border-radius: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2rem;
    color: white;
    position: relative;
}

.pulse-animation {
    position: absolute;
    width: 100px;
    height: 100px;
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 50%;
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0% { transform: scale(0.8); opacity: 1; }
    100% { transform: scale(1.4); opacity: 0; }
}

.header-text h1 {
    font-size: 2.5rem;
    font-weight: 700;
    color: white;
    margin: 0;
}

.header-text p {
    color: rgba(255, 255, 255, 0.9);
    margin: 0.5rem 0 0;
    font-size: 1.1rem;
}

.header-controls {
    display: flex;
    align-items: center;
    gap: 1rem;
}

/* ===== SELETOR DE PERÍODO MODERNO ===== */
.period-selector-modern {
    position: relative;
}

.period-button {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem 1.5rem;
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(20px);
    border: 2px solid rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    color: white;
    cursor: pointer;
    transition: all 0.3s ease;
    min-width: 220px;
    font-family: inherit;
}

.period-button:hover {
    background: rgba(255, 255, 255, 0.25);
    border-color: rgba(255, 255, 255, 0.4);
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
}

.period-icon {
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.1rem;
}

.period-text {
    flex: 1;
    text-align: left;
}

.current-period {
    display: block;
    font-weight: 600;
    font-size: 1rem;
    margin-bottom: 0.25rem;
}

.period-text small {
    color: rgba(255, 255, 255, 0.8);
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.period-arrow {
    font-size: 0.9rem;
    transition: transform 0.3s ease;
}

/* ===== MODAL DE PERÍODO ===== */
.period-modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(8px);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10003;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.period-modal-overlay.show {
    opacity: 1;
    visibility: visible;
}

.period-modal {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.98), rgba(248, 250, 252, 0.95));
    backdrop-filter: blur(30px);
    border-radius: 20px;
    border: 2px solid rgba(255, 255, 255, 0.3);
    box-shadow: 0 30px 80px rgba(0, 0, 0, 0.3);
    width: 90%;
    max-width: 700px;
    max-height: 85vh;
    display: flex;
    flex-direction: column;
    transform: scale(0.8) translateY(20px);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.period-modal-overlay.show .period-modal {
    transform: scale(1) translateY(0);
}

.modal-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 2rem;
    background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(139, 92, 246, 0.05));
    border-bottom: 2px solid rgba(255, 255, 255, 0.2);
}

.modal-title {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.modal-icon {
    width: 60px;
    height: 60px;
    background: linear-gradient(135deg, #3b82f6, #1d4ed8);
    border-radius: 15px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.5rem;
}

.modal-title-text h2 {
    color: #1e293b;
    font-size: 1.5rem;
    font-weight: 700;
    margin: 0 0 0.25rem;
}

.modal-title-text p {
    color: #64748b;
    margin: 0;
    font-size: 0.9rem;
}

.modal-close {
    width: 40px;
    height: 40px;
    background: rgba(239, 68, 68, 0.1);
    border: 1px solid rgba(239, 68, 68, 0.2);
    border-radius: 10px;
    color: #ef4444;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.modal-close:hover {
    background: rgba(239, 68, 68, 0.2);
    transform: scale(1.1);
}

.modal-body {
    padding: 2rem;
}

.period-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
}

.period-card {
    background: rgba(255, 255, 255, 0.8);
    border: 2px solid rgba(226, 232, 240, 0.8);
    border-radius: 16px;
    padding: 1.5rem;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
}

.period-card:hover {
    border-color: rgba(59, 130, 246, 0.4);
    box-shadow: 0 8px 25px rgba(59, 130, 246, 0.15);
    transform: translateY(-4px);
}

.period-card.active {
    border-color: rgba(59, 130, 246, 0.6);
    background: linear-gradient(135deg, rgba(59, 130, 246, 0.08), rgba(255, 255, 255, 0.9));
    box-shadow: 0 12px 30px rgba(59, 130, 246, 0.2);
    transform: translateY(-4px);
}

.card-icon {
    width: 60px;
    height: 60px;
    border-radius: 15px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    color: white;
    margin-bottom: 1rem;
}

.card-icon.day { background: linear-gradient(135deg, #3b82f6, #1d4ed8); }
.card-icon.quarter { background: linear-gradient(135deg, #10b981, #059669); }
.card-icon.semester { background: linear-gradient(135deg, #8b5cf6, #7c3aed); }
.card-icon.year { background: linear-gradient(135deg, #f59e0b, #d97706); }

.card-content h3 {
    color: #1e293b;
    font-size: 1.25rem;
    font-weight: 700;
    margin: 0 0 0.5rem;
}

.card-content p {
    color: #64748b;
    margin: 0 0 1rem;
    font-size: 0.95rem;
}

/* ===== NOVO CSS PARA MODAL DE PERÍODO MODERNO ===== */

/* Layout das opções */
.modal-body-modern {
    padding: 2rem;
    background: #f8fafc;
    flex: 1;
    overflow-y: auto;
    max-height: 60vh;
}

/* Scroll personalizado para o modal */
.modal-body-modern::-webkit-scrollbar {
    width: 8px;
}

.modal-body-modern::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
}

.modal-body-modern::-webkit-scrollbar-thumb {
    background: rgba(59, 130, 246, 0.3);
    border-radius: 4px;
    transition: background 0.3s ease;
}

.modal-body-modern::-webkit-scrollbar-thumb:hover {
    background: rgba(59, 130, 246, 0.5);
}

/* Indicador de scroll */
.scroll-indicator {
    position: absolute;
    bottom: 100px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: #64748b;
    font-size: 0.8rem;
    opacity: 0.7;
    animation: fadeInOut 2s infinite;
    pointer-events: none;
}

.scroll-indicator i {
    animation: bounce 1s infinite;
}

@keyframes fadeInOut {
    0%, 100% { opacity: 0.7; }
    50% { opacity: 1; }
}

@keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-5px); }
}

@keyframes pulseSelection {
    0% { transform: scale(1); }
    50% { transform: scale(1.02); box-shadow: 0 8px 30px rgba(59, 130, 246, 0.3); }
    100% { transform: scale(1); }
}

@keyframes buttonActivate {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
}

.period-options {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

/* Opções de período */
.period-option {
    background: white;
    border: 2px solid #e2e8f0;
    border-radius: 16px;
    padding: 1.5rem;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    display: flex;
    align-items: center;
    gap: 1.5rem;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.period-option:hover {
    border-color: #3b82f6;
    box-shadow: 0 8px 25px rgba(59, 130, 246, 0.15);
    transform: translateY(-2px);
}

.period-option.selected {
    border-color: #3b82f6;
    background: linear-gradient(135deg, rgba(59, 130, 246, 0.08), rgba(255, 255, 255, 1));
    box-shadow: 0 8px 25px rgba(59, 130, 246, 0.2);
    transform: translateY(-2px);
}

.period-option.recommended {
    border-color: #f59e0b;
    position: relative;
}

.period-option.recommended:hover {
    border-color: #d97706;
    box-shadow: 0 8px 25px rgba(245, 158, 11, 0.15);
}

.period-option.recommended.selected {
    border-color: #f59e0b;
    background: linear-gradient(135deg, rgba(245, 158, 11, 0.08), rgba(255, 255, 255, 1));
    box-shadow: 0 8px 25px rgba(245, 158, 11, 0.2);
}

/* Tag recomendado */
.recommended-tag {
    position: absolute;
    top: -8px;
    right: 16px;
    background: linear-gradient(135deg, #f59e0b, #d97706);
    color: white;
    padding: 0.25rem 0.75rem;
    border-radius: 8px;
    font-size: 0.8rem;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 0.25rem;
    box-shadow: 0 2px 8px rgba(245, 158, 11, 0.3);
}

/* Header da opção */
.option-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    flex-shrink: 0;
}

.option-icon {
    width: 56px;
    height: 56px;
    border-radius: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    color: white;
    position: relative;
    overflow: hidden;
}

.option-icon::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(255, 255, 255, 0.2);
    opacity: 0;
    transition: opacity 0.3s ease;
}

.period-option:hover .option-icon::before {
    opacity: 1;
}

.option-icon.month { background: linear-gradient(135deg, #3b82f6, #1d4ed8); }
.option-icon.quarter { background: linear-gradient(135deg, #10b981, #059669); }
.option-icon.semester { background: linear-gradient(135deg, #8b5cf6, #7c3aed); }
.option-icon.three-quarters { background: linear-gradient(135deg, #06b6d4, #0891b2); }
.option-icon.year { background: linear-gradient(135deg, #f59e0b, #d97706); }

.option-badge {
    background: rgba(71, 85, 105, 0.1);
    color: #475569;
    padding: 0.25rem 0.75rem;
    border-radius: 8px;
    font-size: 0.8rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.period-option.selected .option-badge {
    background: rgba(59, 130, 246, 0.15);
    color: #3b82f6;
}

.period-option.recommended.selected .option-badge {
    background: rgba(245, 158, 11, 0.15);
    color: #f59e0b;
}

/* Conteúdo da opção */
.option-content {
    flex: 1;
}

.option-content h3 {
    color: #1e293b;
    font-size: 1.25rem;
    font-weight: 700;
    margin: 0 0 0.5rem;
}

.option-content p {
    color: #64748b;
    margin: 0 0 1rem;
    font-size: 0.95rem;
    line-height: 1.5;
}

.option-features {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
}

.feature {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: #6b7280;
    font-size: 0.85rem;
    font-weight: 500;
}

.feature i {
    width: 16px;
    color: #9ca3af;
}

/* Seletor customizado */
.option-selector {
    flex-shrink: 0;
}

.radio-custom {
    width: 24px;
    height: 24px;
    border: 2px solid #d1d5db;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    position: relative;
}

.period-option:hover .radio-custom {
    border-color: #3b82f6;
}

.period-option.selected .radio-custom {
    border-color: #3b82f6;
    background: #3b82f6;
}

.period-option.recommended.selected .radio-custom {
    border-color: #f59e0b;
    background: #f59e0b;
}

.radio-dot {
    width: 10px;
    height: 10px;
    background: white;
    border-radius: 50%;
    opacity: 0;
    transform: scale(0);
    transition: all 0.3s ease;
}

.period-option.selected .radio-dot {
    opacity: 1;
    transform: scale(1);
}

/* Footer moderno */
.modal-footer-modern {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1.5rem 2rem;
    background: white;
    border-top: 1px solid #e2e8f0;
    flex-shrink: 0;
    position: relative;
}

.info-indicator {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    color: #6b7280;
    font-size: 0.9rem;
}

.pulse-dot {
    width: 8px;
    height: 8px;
    background: #10b981;
    border-radius: 50%;
    animation: pulse-indicator 2s infinite;
}

@keyframes pulse-indicator {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.5; transform: scale(1.2); }
}

.footer-actions {
    display: flex;
    gap: 1rem;
}

.btn-cancel {
    padding: 0.875rem 1.5rem;
    background: white;
    border: 2px solid #e2e8f0;
    color: #64748b;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: 600;
    font-family: inherit;
    font-size: 1rem;
    min-width: 140px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    text-align: center;
}

.btn-cancel:hover {
    background: #f8fafc;
    border-color: #cbd5e1;
    color: #475569;
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(100, 116, 139, 0.2);
}

.btn-apply {
    padding: 0.875rem 2rem;
    background: linear-gradient(135deg, #3b82f6, #1d4ed8);
    border: none;
    color: white;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-weight: 700;
    font-family: inherit;
    font-size: 1rem;
    box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
    min-width: 180px;
    justify-content: center;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    position: relative;
    overflow: hidden;
}

.btn-apply::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s ease;
}

.btn-apply:hover::before {
    left: 100%;
}

.btn-apply:hover {
    transform: translateY(-3px);
    box-shadow: 0 12px 35px rgba(59, 130, 246, 0.4);
    background: linear-gradient(135deg, #2563eb, #1e40af);
}

.btn-apply:active {
    transform: translateY(-1px);
    box-shadow: 0 6px 20px rgba(59, 130, 246, 0.3);
}

.btn-apply i {
    font-size: 1.1rem;
}

/* Responsividade */
@media (max-width: 768px) {
    .modal-body-modern {
        padding: 1.5rem 1rem;
    }
    
    .period-option {
        flex-direction: column;
        align-items: flex-start;
        gap: 1rem;
        padding: 1.25rem;
    }
    
    .option-header {
        align-self: stretch;
        justify-content: space-between;
    }
    
    .option-selector {
        position: absolute;
        top: 1.25rem;
        right: 1.25rem;
    }
    
    .option-features {
        flex-direction: column;
        gap: 0.5rem;
    }
    
    .modal-footer-modern {
        flex-direction: column;
        gap: 1rem;
        padding: 1rem;
        text-align: center;
    }
    
    .footer-actions {
        width: 100%;
        justify-content: space-between;
    }
    
    .btn-cancel,
    .btn-apply {
        flex: 1;
    }
}

.card-stats {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.stat-item {
    font-size: 0.85rem;
    color: #64748b;
    font-weight: 500;
}

.card-badge {
    position: absolute;
    top: 1rem;
    right: 1rem;
    background: rgba(59, 130, 246, 0.1);
    color: #1d4ed8;
    padding: 0.4rem 0.8rem;
    border-radius: 20px;
    font-weight: 700;
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.8px;
    border: 1px solid rgba(59, 130, 246, 0.2);
}

.period-card.active .card-badge {
    background: rgba(16, 185, 129, 0.15);
    color: #065f46;
    border-color: rgba(16, 185, 129, 0.3);
}

.card-check {
    position: absolute;
    top: -2px;
    right: -2px;
    width: 30px;
    height: 30px;
    background: linear-gradient(135deg, #10b981, #059669);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 0.8rem;
    opacity: 0;
    transform: scale(0);
    transition: all 0.3s ease;
}

.period-card.active .card-check {
    opacity: 1;
    transform: scale(1);
}

.modal-footer {
    display: flex !important;
    align-items: center;
    justify-content: space-between;
    padding: 1.5rem 2rem;
    background: rgba(248, 250, 252, 0.8);
    border-top: 2px solid rgba(226, 232, 240, 0.5);
    position: sticky;
    bottom: 0;
    z-index: 10002;
    width: 100%;
    box-sizing: border-box;
}

.footer-info {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: #64748b;
    font-size: 0.9rem;
}

.period-counter {
    padding: 0.5rem 1rem;
    background: rgba(59, 130, 246, 0.1);
    border-radius: 8px;
    color: #3b82f6;
    font-weight: 600;
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.info-icon {
    color: #3b82f6;
}

.footer-actions {
    display: flex;
    gap: 1rem;
}

.btn-secondary {
    padding: 0.75rem 1.5rem;
    background: rgba(71, 85, 105, 0.1);
    border: 1px solid rgba(71, 85, 105, 0.2);
    color: #475569;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: 600;
}

.btn-secondary:hover {
    background: rgba(71, 85, 105, 0.15);
    transform: translateY(-1px);
}

.btn-primary {
    padding: 0.75rem 1.5rem;
    background: linear-gradient(135deg, #3b82f6, #1d4ed8);
    border: none;
    color: white;
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: 600;
    font-family: inherit;
    z-index: 10001;
}
    box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
}

/* Estilo específico para o botão Aplicar Filtro */
#applyPeriodBtn {
    display: flex !important;
    align-items: center;
    gap: 0.5rem;
    opacity: 1 !important;
    pointer-events: auto !important;
    visibility: visible !important;
    min-width: 140px;
    justify-content: center;
    font-size: 0.95rem;
}

/* Garantir que o modal-footer esteja sempre visível */
.period-modal {
    display: flex;
    flex-direction: column;
    max-height: 85vh;
}

.modal-body {
    flex: 1;
    overflow-y: auto;
}

.modal-footer {
    flex-shrink: 0;
    margin-top: auto;
}

/* Ações Rápidas */
.quick-actions {
    display: flex;
    gap: 0.5rem;
    margin-left: 1rem;
}

.action-btn {
    width: 45px;
    height: 45px;
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 10px;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 1rem;
}

.action-btn:hover {
    background: rgba(255, 255, 255, 0.25);
    border-color: rgba(255, 255, 255, 0.4);
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
}

.action-btn:active {
    transform: translateY(0);
}

/* === ESTATÍSTICAS PREMIUM === */
.stats-overview-premium {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 2rem;
    margin-bottom: 3rem;
}

.stat-card-premium {
    background: white;
    border-radius: 24px;
    padding: 0;
    border: 1px solid rgba(226, 232, 240, 0.3);
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.04);
    position: relative;
    overflow: hidden;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    cursor: pointer;
    min-height: 280px;
    display: flex;
    flex-direction: column;
}

.stat-card-premium:hover {
    transform: translateY(-12px) scale(1.02);
    box-shadow: 0 25px 60px rgba(0, 0, 0, 0.15);
    border-color: rgba(59, 130, 246, 0.3);
}

/* Fundo animado */
.card-background {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    overflow: hidden;
    z-index: 1;
}

.floating-shapes {
    position: relative;
    width: 100%;
    height: 100%;
}

.floating-shapes .shape-1,
.floating-shapes .shape-2,
.floating-shapes .shape-3 {
    position: absolute;
    border-radius: 50%;
    animation: float 6s ease-in-out infinite;
    opacity: 0.1;
}

.floating-shapes .shape-1 {
    width: 80px;
    height: 80px;
    top: 20%;
    right: 10%;
    animation-delay: 0s;
}

.floating-shapes .shape-2 {
    width: 40px;
    height: 40px;
    top: 60%;
    right: 30%;
    animation-delay: 2s;
}

.floating-shapes .shape-3 {
    width: 20px;
    height: 20px;
    top: 80%;
    right: 60%;
    animation-delay: 4s;
}

/* Cores específicas dos cards */
.stat-card-premium.users {
    background: linear-gradient(135deg, rgba(59, 130, 246, 0.02), rgba(29, 78, 216, 0.08));
}

.stat-card-premium.users .floating-shapes .shape-1,
.stat-card-premium.users .floating-shapes .shape-2,
.stat-card-premium.users .floating-shapes .shape-3 {
    background: linear-gradient(135deg, #3b82f6, #1d4ed8);
}

.stat-card-premium.units {
    background: linear-gradient(135deg, rgba(16, 185, 129, 0.02), rgba(5, 150, 105, 0.08));
}

.stat-card-premium.units .floating-shapes .shape-1,
.stat-card-premium.units .floating-shapes .shape-2,
.stat-card-premium.units .floating-shapes .shape-3 {
    background: linear-gradient(135deg, #10b981, #059669);
}

.stat-card-premium.calls {
    background: linear-gradient(135deg, rgba(139, 92, 246, 0.02), rgba(124, 58, 237, 0.08));
}

.stat-card-premium.calls .floating-shapes .shape-1,
.stat-card-premium.calls .floating-shapes .shape-2,
.stat-card-premium.calls .floating-shapes .shape-3 {
    background: linear-gradient(135deg, #8b5cf6, #7c3aed);
}

.stat-card-premium.admins {
    background: linear-gradient(135deg, rgba(245, 158, 11, 0.02), rgba(217, 119, 6, 0.08));
}

.stat-card-premium.admins .floating-shapes .shape-1,
.stat-card-premium.admins .floating-shapes .shape-2,
.stat-card-premium.admins .floating-shapes .shape-3 {
    background: linear-gradient(135deg, #f59e0b, #d97706);
}

/* Header do card */
.card-header-premium {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    padding: 2rem 2rem 0;
    position: relative;
    z-index: 10;
}

.stat-icon-premium {
    width: 70px;
    height: 70px;
    border-radius: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    backdrop-filter: blur(10px);
    border: 2px solid rgba(255, 255, 255, 0.2);
    transition: all 0.3s ease;
}

.stat-icon-premium i {
    font-size: 32px;
    color: white;
    z-index: 2;
    position: relative;
}

.icon-glow {
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    border-radius: 22px;
    opacity: 0;
    transition: all 0.3s ease;
    z-index: 1;
}

.stat-card-premium:hover .icon-glow {
    opacity: 0.6;
    animation: pulse-glow 2s infinite;
}

/* Ícones específicos */
.stat-card-premium.users .stat-icon-premium {
    background: linear-gradient(135deg, #3b82f6, #1d4ed8);
}

.stat-card-premium.users .icon-glow {
    background: linear-gradient(135deg, #3b82f6, #1d4ed8);
}

.stat-card-premium.units .stat-icon-premium {
    background: linear-gradient(135deg, #10b981, #059669);
}

.stat-card-premium.units .icon-glow {
    background: linear-gradient(135deg, #10b981, #059669);
}

.stat-card-premium.calls .stat-icon-premium {
    background: linear-gradient(135deg, #8b5cf6, #7c3aed);
}

.stat-card-premium.calls .icon-glow {
    background: linear-gradient(135deg, #8b5cf6, #7c3aed);
}

.stat-card-premium.admins .stat-icon-premium {
    background: linear-gradient(135deg, #f59e0b, #d97706);
}

.stat-card-premium.admins .icon-glow {
    background: linear-gradient(135deg, #f59e0b, #d97706);
}

/* Badge do card */
.card-badge-premium {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    border-radius: 50px;
    font-size: 0.85rem;
    font-weight: 600;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: white;
    transition: all 0.3s ease;
}

.card-badge-premium i {
    font-size: 0.75rem;
}

.card-badge-premium {
    background: linear-gradient(135deg, rgba(34, 197, 94, 0.9), rgba(21, 128, 61, 0.9));
}

.card-badge-premium.stable {
    background: linear-gradient(135deg, rgba(34, 197, 94, 0.9), rgba(21, 128, 61, 0.9));
}

.card-badge-premium.growing {
    background: linear-gradient(135deg, rgba(168, 85, 247, 0.9), rgba(124, 58, 237, 0.9));
}

.card-badge-premium.secure {
    background: linear-gradient(135deg, rgba(245, 158, 11, 0.9), rgba(217, 119, 6, 0.9));
}

/* Conteúdo do card */
.card-content-premium {
    padding: 1.5rem 2rem;
    position: relative;
    z-index: 10;
    flex: 1;
}

.stat-number-premium {
    font-size: 3.5rem;
    font-weight: 800;
    line-height: 1;
    margin-bottom: 0.5rem;
    color: #1e293b;
    font-family: 'Segoe UI', system-ui, sans-serif;
}

.stat-label-premium {
    font-size: 1.1rem;
    font-weight: 600;
    color: #64748b;
    margin-bottom: 1rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.stat-detail-premium {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.detail-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.9rem;
    color: #64748b;
}

.detail-item i {
    font-size: 0.7rem;
    width: 12px;
}

.active-dot {
    color: #22c55e !important;
}

.inactive-dot {
    color: #ef4444 !important;
}

.resolved {
    color: #22c55e !important;
}

.pending {
    color: #f59e0b !important;
}

.security-key {
    color: #f59e0b !important;
}

/* Progresso e visualizações */
.card-progress-premium {
    padding: 0 2rem 2rem;
    position: relative;
    z-index: 10;
}

.progress-bar-premium {
    height: 6px;
    background: rgba(148, 163, 184, 0.2);
    border-radius: 3px;
    overflow: hidden;
    margin-bottom: 0.5rem;
}

.progress-fill-premium {
    height: 100%;
    border-radius: 3px;
    transition: width 1s ease;
    position: relative;
}

.progress-fill-premium.users {
    background: linear-gradient(90deg, #3b82f6, #1d4ed8);
}

.progress-text-premium {
    font-size: 0.85rem;
    color: #64748b;
    font-weight: 500;
}

/* Visualização de rede */
.network-visualization {
    height: 40px;
    position: relative;
    margin-bottom: 0.5rem;
}

.network-nodes {
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 100%;
    position: relative;
}

.node {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: linear-gradient(135deg, #10b981, #059669);
    position: relative;
    animation: network-pulse 2s infinite;
}

.node.main {
    width: 12px;
    height: 12px;
    animation-delay: 0s;
}

.node.secondary:nth-child(2) { animation-delay: 0.5s; }
.node.secondary:nth-child(3) { animation-delay: 1s; }
.node.secondary:nth-child(4) { animation-delay: 1.5s; }

/* Atividade de chamadas */
.call-activity {
    height: 40px;
    margin-bottom: 0.5rem;
}

.activity-bars {
    display: flex;
    align-items: flex-end;
    gap: 3px;
    height: 100%;
    padding: 5px 0;
}

.activity-bars .bar {
    flex: 1;
    background: linear-gradient(180deg, #8b5cf6, #7c3aed);
    border-radius: 2px;
    min-height: 4px;
    animation: bar-bounce 2s infinite;
}

.activity-bars .bar:nth-child(1) { animation-delay: 0s; }
.activity-bars .bar:nth-child(2) { animation-delay: 0.2s; }
.activity-bars .bar:nth-child(3) { animation-delay: 0.4s; }
.activity-bars .bar:nth-child(4) { animation-delay: 0.6s; }
.activity-bars .bar:nth-child(5) { animation-delay: 0.8s; }

/* Indicador de segurança */
.security-indicator {
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    margin-bottom: 0.5rem;
}

.security-rings {
    position: relative;
    width: 40px;
    height: 40px;
}

.ring {
    position: absolute;
    border: 2px solid rgba(245, 158, 11, 0.3);
    border-radius: 50%;
    animation: security-ring 3s infinite;
}

.ring-1 {
    width: 20px;
    height: 20px;
    top: 10px;
    left: 10px;
    animation-delay: 0s;
}

.ring-2 {
    width: 30px;
    height: 30px;
    top: 5px;
    left: 5px;
    animation-delay: 1s;
}

.ring-3 {
    width: 40px;
    height: 40px;
    top: 0;
    left: 0;
    animation-delay: 2s;
}

.security-core {
    width: 8px;
    height: 8px;
    background: linear-gradient(135deg, #f59e0b, #d97706);
    border-radius: 50%;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    animation: security-pulse 1.5s infinite;
}

/* === ANIMAÇÕES === */
@keyframes float {
    0%, 100% { transform: translateY(0px) rotate(0deg); }
    50% { transform: translateY(-20px) rotate(180deg); }
}

@keyframes pulse-glow {
    0%, 100% { transform: scale(1); opacity: 0.6; }
    50% { transform: scale(1.1); opacity: 0.8; }
}

@keyframes network-pulse {
    0%, 100% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.5); opacity: 0.7; }
}

@keyframes bar-bounce {
    0%, 100% { transform: scaleY(1); }
    50% { transform: scaleY(1.2); }
}

@keyframes security-ring {
    0% { transform: scale(0.8); opacity: 1; }
    100% { transform: scale(1.2); opacity: 0; }
}

@keyframes security-pulse {
    0%, 100% { transform: translate(-50%, -50%) scale(1); }
    50% { transform: translate(-50%, -50%) scale(1.2); }
}

/* Contador animado */
@keyframes countUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

.number-counter {
    display: inline-block;
    animation: countUp 0.8s ease;
}

/* Responsividade */
@media (max-width: 768px) {
    .stats-overview-premium {
        grid-template-columns: 1fr;
        gap: 1.5rem;
    }
    
    .stat-card-premium {
        min-height: 240px;
    }
    
    .card-header-premium {
        padding: 1.5rem 1.5rem 0;
    }
    
    .card-content-premium {
        padding: 1rem 1.5rem;
    }
    
    .card-progress-premium {
        padding: 0 1.5rem 1.5rem;
    }
    
    .stat-number-premium {
        font-size: 2.5rem;
    }
}

/* ===== INSIGHTS SIMPLIFICADOS ===== */
.insights-section-simple {
    margin-bottom: 1.5rem;
}

.insights-container {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 16px;
    padding: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(20px);
}

.insights-header-simple {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.insights-title-simple {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    color: white;
}

.insights-title-simple i {
    font-size: 1.5rem;
    color: #f59e0b;
}

.insights-title-simple h3 {
    margin: 0;
    font-size: 1.3rem;
    font-weight: 600;
}

.insights-count {
    background: rgba(59, 130, 246, 0.2);
    color: #60a5fa;
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 600;
    border: 1px solid rgba(59, 130, 246, 0.3);
}

.insights-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
}

.insight-card-simple {
    background: rgba(255, 255, 255, 0.08);
    border-radius: 12px;
    padding: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.3s ease;
    display: flex;
    gap: 1rem;
    align-items: flex-start;
}

.insight-card-simple:hover {
    background: rgba(255, 255, 255, 0.12);
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
}

.insight-card-simple.insight-destaque {
    border-left: 4px solid #f59e0b;
}

.insight-icon-simple {
    width: 50px;
    height: 50px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.25rem;
    color: white;
    flex-shrink: 0;
}

.insight-positivo .insight-icon-simple {
    background: linear-gradient(135deg, #10b981, #059669);
}

.insight-destaque .insight-icon-simple {
    background: linear-gradient(135deg, #f59e0b, #d97706);
}

.insight-content-simple {
    flex: 1;
}

.insight-content-simple h4 {
    color: white;
    font-size: 1.1rem;
    font-weight: 600;
    margin: 0 0 0.5rem 0;
}

.insight-content-simple p {
    color: rgba(255, 255, 255, 0.8);
    font-size: 0.9rem;
    line-height: 1.5;
    margin: 0 0 1rem 0;
}

.insight-stats {
    display: flex;
    gap: 1rem;
    margin-bottom: 1rem;
}

.stat-item-simple {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 0.75rem;
    background: rgba(255, 255, 255, 0.08);
    border-radius: 8px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.stat-number {
    color: white;
    font-size: 1.25rem;
    font-weight: 700;
    line-height: 1;
    margin-bottom: 0.25rem;
}

.stat-label {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.75rem;
    text-align: center;
    font-weight: 500;
}

.progress-simple {
    width: 100%;
    height: 6px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 3px;
    overflow: hidden;
}

.progress-bar-simple {
    height: 100%;
    background: linear-gradient(90deg, #10b981, #059669);
    border-radius: 3px;
    transition: width 1.5s ease-in-out;
    position: relative;
}

/* Tabs */
.reports-tabs {
    background: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(20px);
    border-radius: 16px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    overflow: hidden;
    margin-top: 0 !important;
}

.tab-buttons {
    display: flex;
    background: rgba(255, 255, 255, 0.1);
}

.tab-button {
    flex: 1;
    padding: 1rem 1.5rem;
    background: none;
    border: none;
    color: rgba(255, 255, 255, 0.8);
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.tab-button.active {
    background: rgba(255, 255, 255, 0.2);
    color: white;
}

.tab-button:hover {
    background: rgba(255, 255, 255, 0.1);
}

.tab-content {
    display: none;
    padding: 2rem;
}

.tab-content.active {
    display: block;
}

/* Reports Grid */
.reports-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: 2rem;
}

.chart-card, .data-card, .stats-card, .summary-card {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.chart-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
}

.chart-header h3 {
    color: white;
    font-weight: 600;
    margin: 0;
}

.chart-btn {
    background: rgba(255, 255, 255, 0.2);
    border: none;
    color: white;
    padding: 0.5rem;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s ease;
}

.chart-btn:hover {
    background: rgba(255, 255, 255, 0.3);
}

.chart-container {
    height: 300px;
    position: relative;
}

/* ===== CARDS MELHORADOS ===== */

/* Card Enhanced de Usuários Ativos */
.data-card-enhanced {
    background: rgba(255, 255, 255, 0.12);
    backdrop-filter: blur(25px);
    border-radius: 20px;
    border: 2px solid rgba(255, 255, 255, 0.15);
    overflow: hidden;
    transition: all 0.3s ease;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
}

.data-card-enhanced:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.2);
    border-color: rgba(255, 255, 255, 0.25);
}

.card-header-enhanced {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    padding: 1.5rem 2rem 1rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.header-title {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
}

.title-icon {
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, #f59e0b, #d97706);
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.25rem;
    box-shadow: 0 4px 15px rgba(245, 158, 11, 0.3);
}

.title-text h3 {
    color: white;
    font-size: 1.3rem;
    font-weight: 700;
    margin: 0 0 0.25rem 0;
}

.title-text p {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.9rem;
    margin: 0;
}

.header-stats {
    text-align: right;
}

.total-count {
    background: rgba(59, 130, 246, 0.2);
    color: #60a5fa;
    padding: 0.5rem 1rem;
    border-radius: 12px;
    font-size: 0.85rem;
    font-weight: 600;
    border: 1px solid rgba(59, 130, 246, 0.3);
}

/* Lista melhorada de usuários */
.data-list-enhanced {
    padding: 1rem 2rem 1.5rem;
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.data-item-enhanced {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1.25rem;
    background: rgba(255, 255, 255, 0.08);
    border-radius: 16px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
}

.data-item-enhanced:hover {
    background: rgba(255, 255, 255, 0.12);
    transform: translateX(4px);
    border-color: rgba(255, 255, 255, 0.2);
}

.data-item-enhanced.top-performer {
    background: linear-gradient(135deg, rgba(245, 158, 11, 0.15), rgba(217, 119, 6, 0.1));
    border-color: rgba(245, 158, 11, 0.3);
}

.item-rank {
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 45px;
}

.rank-medal {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.1rem;
    color: white;
    position: relative;
}

.rank-medal.gold {
    background: linear-gradient(135deg, #fbbf24, #f59e0b);
    box-shadow: 0 4px 15px rgba(251, 191, 36, 0.4);
}

.rank-medal.silver {
    background: linear-gradient(135deg, #e5e7eb, #9ca3af);
    box-shadow: 0 4px 15px rgba(156, 163, 175, 0.4);
}

.rank-medal.bronze {
    background: linear-gradient(135deg, #cd7c0f, #92400e);
    box-shadow: 0 4px 15px rgba(205, 124, 15, 0.4);
}

.rank-number {
    width: 30px;
    height: 30px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 600;
    font-size: 0.9rem;
}

.item-avatar {
    position: relative;
}

.avatar-circle {
    width: 55px;
    height: 55px;
    background: linear-gradient(135deg, #3b82f6, #1d4ed8);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 700;
    font-size: 1.25rem;
    border: 3px solid rgba(255, 255, 255, 0.2);
}

.admin-badge {
    position: absolute;
    top: -2px;
    right: -2px;
    width: 20px;
    height: 20px;
    background: linear-gradient(135deg, #f59e0b, #d97706);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 0.7rem;
    border: 2px solid rgba(255, 255, 255, 0.8);
}

.item-details {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.user-name {
    color: white;
    font-size: 1.1rem;
    font-weight: 600;
    margin-bottom: 0.25rem;
}

.user-stats {
    display: flex;
    gap: 1.5rem;
    margin-bottom: 0.75rem;
}

.stat-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: rgba(255, 255, 255, 0.8);
    font-size: 0.85rem;
}

.stat-item i {
    color: #60a5fa;
    width: 16px;
}

.activity-level {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
}

.activity-bar {
    width: 100%;
    height: 6px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 3px;
    overflow: hidden;
}

.activity-fill {
    height: 100%;
    background: linear-gradient(90deg, #10b981, #059669);
    border-radius: 3px;
    transition: width 1.5s ease-in-out;
}

.activity-text {
    color: rgba(255, 255, 255, 0.6);
    font-size: 0.75rem;
    font-weight: 500;
}

.item-score {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-width: 70px;
    padding: 0.75rem;
    background: rgba(59, 130, 246, 0.15);
    border-radius: 12px;
    border: 1px solid rgba(59, 130, 246, 0.3);
}

.score-number {
    color: #60a5fa;
    font-size: 1.5rem;
    font-weight: 700;
    line-height: 1;
}

.score-label {
    color: rgba(255, 255, 255, 0.8);
    font-size: 0.75rem;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-top: 0.25rem;
}

.empty-state {
    text-align: center;
    padding: 3rem 2rem;
    color: rgba(255, 255, 255, 0.6);
}

.empty-state i {
    font-size: 3rem;
    margin-bottom: 1rem;
    opacity: 0.5;
}

.card-footer-enhanced {
    padding: 1rem 2rem 1.5rem;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.view-all-btn {
    width: 100%;
    padding: 0.75rem 1rem;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    color: rgba(255, 255, 255, 0.9);
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.view-all-btn:hover {
    background: rgba(255, 255, 255, 0.15);
    border-color: rgba(255, 255, 255, 0.3);
    color: white;
}

/* ===== CARD DE ESTATÍSTICAS MELHORADO ===== */

.stats-card-enhanced {
    background: rgba(255, 255, 255, 0.12);
    backdrop-filter: blur(25px);
    border-radius: 20px;
    border: 2px solid rgba(255, 255, 255, 0.15);
    overflow: hidden;
    transition: all 0.3s ease;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
}

.stats-card-enhanced:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.2);
    border-color: rgba(255, 255, 255, 0.25);
}

.stats-header-enhanced {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    padding: 1.5rem 2rem 1rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.stats-title {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
}

.title-icon-stats {
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, #8b5cf6, #7c3aed);
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.25rem;
    box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
}

.title-content h3 {
    color: white;
    font-size: 1.3rem;
    font-weight: 700;
    margin: 0 0 0.25rem 0;
}

.title-content p {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.9rem;
    margin: 0;
}

.total-users-badge {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 0.75rem 1rem;
    background: rgba(139, 92, 246, 0.2);
    border: 1px solid rgba(139, 92, 246, 0.3);
    border-radius: 12px;
    text-align: center;
}

.total-users-badge span {
    color: #a78bfa;
    font-size: 1.25rem;
    font-weight: 700;
    line-height: 1;
}

.total-users-badge small {
    color: rgba(255, 255, 255, 0.8);
    font-size: 0.75rem;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.distribution-container {
    padding: 1.5rem 2rem;
    display: flex;
    gap: 2rem;
    align-items: center;
}

.distribution-chart {
    position: relative;
    flex-shrink: 0;
}

.chart-center {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
}

.center-number {
    color: white;
    font-size: 1.5rem;
    font-weight: 700;
    line-height: 1;
}

.center-label {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.8rem;
    font-weight: 500;
    margin-top: 0.25rem;
}

.donut-chart {
    width: 120px;
    height: 120px;
}

.distribution-details {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.detail-row {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.detail-indicator {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.indicator-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
}

.indicator-dot.common {
    background: #3b82f6;
    box-shadow: 0 0 10px rgba(59, 130, 246, 0.5);
}

.indicator-dot.admin {
    background: #f59e0b;
    box-shadow: 0 0 10px rgba(245, 158, 11, 0.5);
}

.indicator-icon {
    width: 35px;
    height: 35px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1rem;
}

.detail-row.common .indicator-icon {
    background: rgba(59, 130, 246, 0.2);
    color: #60a5fa;
}

.detail-row.admin .indicator-icon {
    background: rgba(245, 158, 11, 0.2);
    color: #fbbf24;
}

.detail-content {
    flex: 1;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.detail-info {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
}

.detail-label {
    color: white;
    font-weight: 600;
    font-size: 1rem;
}

.detail-description {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.8rem;
}

.detail-numbers {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: 0.25rem;
}

.detail-count {
    color: white;
    font-size: 1.25rem;
    font-weight: 700;
}

.detail-percent {
    color: rgba(255, 255, 255, 0.8);
    font-size: 0.85rem;
    font-weight: 500;
}

.detail-progress {
    width: 60px;
    margin-left: 1rem;
}

.progress-bar-detail {
    width: 100%;
    height: 8px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
    overflow: hidden;
}

.progress-fill-detail {
    height: 100%;
    border-radius: 4px;
    transition: width 1.5s ease-in-out;
}

.progress-fill-detail.common {
    background: linear-gradient(90deg, #3b82f6, #1d4ed8);
}

.progress-fill-detail.admin {
    background: linear-gradient(90deg, #f59e0b, #d97706);
}

.stats-summary {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
    padding: 1rem 2rem 1.5rem;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.summary-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.summary-icon {
    width: 40px;
    height: 40px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.1rem;
}

.summary-icon.active {
    background: rgba(16, 185, 129, 0.2);
    color: #10b981;
}

.summary-icon.recent {
    background: rgba(59, 130, 246, 0.2);
    color: #60a5fa;
}

.summary-icon.ratio {
    background: rgba(245, 158, 11, 0.2);
    color: #fbbf24;
}

.summary-data {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
}

.summary-number {
    color: white;
    font-size: 1.1rem;
    font-weight: 700;
    line-height: 1;
}

.summary-label {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.75rem;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.data-item-enhanced {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1.25rem;
    background: rgba(255, 255, 255, 0.08);
    border-radius: 16px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
}

.data-item-enhanced:hover {
    background: rgba(255, 255, 255, 0.12);
    transform: translateX(4px);
    border-color: rgba(255, 255, 255, 0.2);
}

.data-item-enhanced.top-performer {
    background: linear-gradient(135deg, rgba(245, 158, 11, 0.15), rgba(217, 119, 6, 0.1));
    border-color: rgba(245, 158, 11, 0.3);
}

.item-rank {
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 45px;
}

.rank-medal {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.1rem;
    color: white;
    position: relative;
}

.rank-medal.gold {
    background: linear-gradient(135deg, #fbbf24, #f59e0b);
    box-shadow: 0 4px 15px rgba(251, 191, 36, 0.4);
}

.rank-medal.silver {
    background: linear-gradient(135deg, #e5e7eb, #9ca3af);
    box-shadow: 0 4px 15px rgba(156, 163, 175, 0.4);
}

.rank-medal.bronze {
    background: linear-gradient(135deg, #cd7c0f, #92400e);
    box-shadow: 0 4px 15px rgba(205, 124, 15, 0.4);
}

.rank-number {
    width: 30px;
    height: 30px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 600;
    font-size: 0.9rem;
}

.item-avatar {
    position: relative;
}

.avatar-circle {
    width: 55px;
    height: 55px;
    background: linear-gradient(135deg, #3b82f6, #1d4ed8);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 700;
    font-size: 1.25rem;
    border: 3px solid rgba(255, 255, 255, 0.2);
}

.admin-badge {
    position: absolute;
    top: -2px;
    right: -2px;
    width: 20px;
    height: 20px;
    background: linear-gradient(135deg, #f59e0b, #d97706);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 0.7rem;
    border: 2px solid rgba(255, 255, 255, 0.8);
}

.item-details {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.user-name {
    color: white;
    font-size: 1.1rem;
    font-weight: 600;
    margin-bottom: 0.25rem;
}

.user-stats {
    display: flex;
    gap: 1.5rem;
    margin-bottom: 0.75rem;
}

.stat-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: rgba(255, 255, 255, 0.8);
    font-size: 0.85rem;
}

.stat-item i {
    color: #60a5fa;
    width: 16px;
}

.activity-level {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
}

.activity-bar {
    width: 100%;
    height: 6px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 3px;
    overflow: hidden;
}

.activity-fill {
    height: 100%;
    background: linear-gradient(90deg, #10b981, #059669);
    border-radius: 3px;
    transition: width 1.5s ease-in-out;
}

.activity-text {
    color: rgba(255, 255, 255, 0.6);
    font-size: 0.75rem;
    font-weight: 500;
}

.item-score {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-width: 70px;
    padding: 0.75rem;
    background: rgba(59, 130, 246, 0.15);
    border-radius: 12px;
    border: 1px solid rgba(59, 130, 246, 0.3);
}

.score-number {
    color: #60a5fa;
    font-size: 1.5rem;
    font-weight: 700;
    line-height: 1;
}

.score-label {
    color: rgba(255, 255, 255, 0.8);
    font-size: 0.75rem;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-top: 0.25rem;
}

.empty-state {
    text-align: center;
    padding: 3rem 2rem;
    color: rgba(255, 255, 255, 0.6);
}

.empty-state i {
    font-size: 3rem;
    margin-bottom: 1rem;
    opacity: 0.5;
}

.card-footer-enhanced {
    padding: 1rem 2rem 1.5rem;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.view-all-btn {
    width: 100%;
    padding: 0.75rem 1rem;
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 12px;
    color: rgba(255, 255, 255, 0.9);
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.view-all-btn:hover {
    background: rgba(255, 255, 255, 0.15);
    border-color: rgba(255, 255, 255, 0.3);
    color: white;
}

/* ===== CARD DE ESTATÍSTICAS MELHORADO ===== */

.stats-card-enhanced {
    background: rgba(255, 255, 255, 0.12);
    backdrop-filter: blur(25px);
    border-radius: 20px;
    border: 2px solid rgba(255, 255, 255, 0.15);
    overflow: hidden;
    transition: all 0.3s ease;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
}

.stats-card-enhanced:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.2);
    border-color: rgba(255, 255, 255, 0.25);
}

.stats-header-enhanced {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    padding: 1.5rem 2rem 1rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.stats-title {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
}

.title-icon-stats {
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, #8b5cf6, #7c3aed);
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.25rem;
    box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
}

.title-content h3 {
    color: white;
    font-size: 1.3rem;
    font-weight: 700;
    margin: 0 0 0.25rem 0;
}

.title-content p {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.9rem;
    margin: 0;
}

.total-users-badge {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 0.75rem 1rem;
    background: rgba(139, 92, 246, 0.2);
    border: 1px solid rgba(139, 92, 246, 0.3);
    border-radius: 12px;
    text-align: center;
}

.total-users-badge span {
    color: #a78bfa;
    font-size: 1.25rem;
    font-weight: 700;
    line-height: 1;
}

.total-users-badge small {
    color: rgba(255, 255, 255, 0.8);
    font-size: 0.75rem;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.distribution-container {
    padding: 1.5rem 2rem;
    display: flex;
    gap: 2rem;
    align-items: center;
}

.distribution-chart {
    position: relative;
    flex-shrink: 0;
}

.chart-center {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
}

.center-number {
    color: white;
    font-size: 1.5rem;
    font-weight: 700;
    line-height: 1;
}

.center-label {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.8rem;
    font-weight: 500;
    margin-top: 0.25rem;
}

.donut-chart {
    width: 120px;
    height: 120px;
}

.distribution-details {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.detail-row {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.detail-indicator {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.indicator-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
}

.indicator-dot.common {
    background: #3b82f6;
    box-shadow: 0 0 10px rgba(59, 130, 246, 0.5);
}

.indicator-dot.admin {
    background: #f59e0b;
    box-shadow: 0 0 10px rgba(245, 158, 11, 0.5);
}

.indicator-icon {
    width: 35px;
    height: 35px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1rem;
}

.detail-row.common .indicator-icon {
    background: rgba(59, 130, 246, 0.2);
    color: #60a5fa;
}

.detail-row.admin .indicator-icon {
    background: rgba(245, 158, 11, 0.2);
    color: #fbbf24;
}

.detail-content {
    flex: 1;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.detail-info {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
}

.detail-label {
    color: white;
    font-weight: 600;
    font-size: 1rem;
}

.detail-description {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.8rem;
}

.detail-numbers {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: 0.25rem;
}

.detail-count {
    color: white;
    font-size: 1.25rem;
    font-weight: 700;
}

.detail-percent {
    color: rgba(255, 255, 255, 0.8);
    font-size: 0.85rem;
    font-weight: 500;
}

.detail-progress {
    width: 60px;
    margin-left: 1rem;
}

.progress-bar-detail {
    width: 100%;
    height: 8px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
    overflow: hidden;
}

.progress-fill-detail {
    height: 100%;
    border-radius: 4px;
    transition: width 1.5s ease-in-out;
}

.progress-fill-detail.common {
    background: linear-gradient(90deg, #3b82f6, #1d4ed8);
}

.progress-fill-detail.admin {
    background: linear-gradient(90deg, #f59e0b, #d97706);
}

.stats-summary {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
    padding: 1rem 2rem 1.5rem;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.summary-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.summary-icon {
    width: 40px;
    height: 40px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.1rem;
}

.summary-icon.active {
    background: rgba(16, 185, 129, 0.2);
    color: #10b981;
}

.summary-icon.recent {
    background: rgba(59, 130, 246, 0.2);
    color: #60a5fa;
}

.summary-icon.ratio {
    background: rgba(245, 158, 11, 0.2);
    color: #fbbf24;
}

.summary-data {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
}

.summary-number {
    color: white;
    font-size: 1.1rem;
    font-weight: 700;
    line-height: 1;
}

.summary-label {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.75rem;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

/* RESET TOTAL - Correções Definitivas */
.data-card-enhanced,
.stats-card-enhanced,
.chart-card {
    overflow: visible !important;
    height: auto !important;
    min-height: auto !important;
    max-height: none !important;
    width: 100% !important;
    box-sizing: border-box !important;
}

/* Remover regras conflitantes - deixar apenas as essenciais */

/* CSS Limpo e Simplificado */

/* CSS LIMPO - APENAS O NECESSÁRIO */

/* ===== NOVA ABORDAGEM SIMPLES E FUNCIONAL ===== */

/* Reset e base */
#tab-usuarios {
    padding: 2rem 0;
    overflow: visible;
}

/* Seções principais */
.simple-section {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(20px);
    border-radius: 16px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    margin-bottom: 2rem;
    overflow: visible;
}

/* Cabeçalhos de seção */
.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1.5rem 2rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.section-header h3 {
    color: white;
    font-size: 1.4rem;
    font-weight: 700;
    margin: 0;
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.section-header h3 i {
    color: #60a5fa;
}

.section-count {
    background: rgba(59, 130, 246, 0.2);
    color: #60a5fa;
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-size: 0.9rem;
    font-weight: 600;
}

/* Opções de exportação */
.export-options {
    display: flex;
    gap: 0.75rem;
    align-items: center;
}

.export-btn {
    padding: 0.75rem 1.25rem;
    border-radius: 10px;
    font-weight: 600;
    font-size: 0.9rem;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    border: 2px solid transparent;
}

.export-btn.primary {
    background: linear-gradient(135deg, #10b981, #059669);
    color: white;
    box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
}

.export-btn.primary:hover {
    background: linear-gradient(135deg, #059669, #047857);
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
}

.export-btn.secondary {
    background: rgba(59, 130, 246, 0.1);
    color: #3b82f6;
    border-color: rgba(59, 130, 246, 0.3);
}

.export-btn.secondary:hover {
    background: rgba(59, 130, 246, 0.2);
    border-color: rgba(59, 130, 246, 0.5);
    transform: translateY(-2px);
}

/* Dropdown de exportação */
.export-dropdown {
    position: relative;
    display: inline-block;
}

.dropdown-toggle {
    position: relative;
}

.dropdown-toggle .fa-chevron-down {
    margin-left: 0.5rem;
    font-size: 0.8rem;
    transition: transform 0.3s ease;
}

.dropdown-toggle.active .fa-chevron-down {
    transform: rotate(180deg);
}

.dropdown-menu {
    position: absolute;
    top: 100%;
    right: 0;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.3);
    min-width: 220px;
    z-index: 1000;
    opacity: 0;
    visibility: hidden;
    transform: translateY(-10px);
    transition: all 0.3s ease;
    margin-top: 0.5rem;
}

.dropdown-menu.show {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
}

.dropdown-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem 1rem;
    color: #374151;
    text-decoration: none;
    transition: all 0.2s ease;
    font-weight: 500;
    border-radius: 8px;
    margin: 0.25rem;
}

.dropdown-item:hover {
    background: rgba(59, 130, 246, 0.1);
    color: #1e40af;
    transform: translateX(2px);
}

.dropdown-item.excel:hover {
    background: rgba(16, 185, 129, 0.1);
    color: #059669;
}

.dropdown-item.pdf:hover {
    background: rgba(239, 68, 68, 0.1);
    color: #dc2626;
}

.dropdown-item.csv:hover {
    background: rgba(245, 158, 11, 0.1);
    color: #d97706;
}

.dropdown-item.image:hover {
    background: rgba(139, 92, 246, 0.1);
    color: #7c3aed;
}

.dropdown-divider {
    height: 1px;
    background: rgba(0, 0, 0, 0.1);
    margin: 0.5rem 0;
}

.dropdown-item i {
    width: 16px;
    text-align: center;
}

/* Animações específicas por tipo */
.dropdown-item.excel i {
    color: #059669;
}

.dropdown-item.pdf i {
    color: #dc2626;
}

.dropdown-item.csv i {
    color: #d97706;
}

.dropdown-item.image i {
    color: #7c3aed;
}

/* Conteúdo das seções */
.section-content {
    padding: 2rem;
}

/* Seção 1: Gráfico */
.chart-wrapper {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    height: 350px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.chart-info {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
}

.info-item {
    background: rgba(255, 255, 255, 0.08);
    padding: 1rem 1.5rem;
    border-radius: 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.info-label {
    color: rgba(255, 255, 255, 0.8);
    font-weight: 500;
}

.info-value {
    color: white;
    font-size: 1.25rem;
    font-weight: 700;
}

/* Seção 2: Tabela de Usuários */
.users-table {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    overflow: hidden;
}

.table-header {
    display: grid;
    grid-template-columns: 80px 1fr 100px 100px 120px;
    gap: 1rem;
    padding: 1rem 1.5rem;
    background: rgba(255, 255, 255, 0.1);
    color: rgba(255, 255, 255, 0.9);
    font-weight: 600;
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.table-row {
    display: grid;
    grid-template-columns: 80px 1fr 100px 100px 120px;
    gap: 1rem;
    padding: 1rem 1.5rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    transition: all 0.3s ease;
    align-items: center;
}

.table-row:hover {
    background: rgba(255, 255, 255, 0.08);
}

.table-row.top-user {
    background: rgba(245, 158, 11, 0.1);
    border-left: 4px solid #f59e0b;
}

/* Colunas da tabela */
.col-rank {
    display: flex;
    justify-content: center;
}

.rank-badge {
    padding: 0.4rem 0.8rem;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 700;
    text-align: center;
}

.rank-badge.gold {
    background: linear-gradient(135deg, #fbbf24, #f59e0b);
    color: white;
}

.rank-badge.silver {
    background: linear-gradient(135deg, #e5e7eb, #9ca3af);
    color: white;
}

.rank-badge.bronze {
    background: linear-gradient(135deg, #cd7c0f, #92400e);
    color: white;
}

.rank-badge.normal {
    background: rgba(255, 255, 255, 0.2);
    color: white;
}

.col-user {
    display: flex;
    align-items: center;
}

.user-info {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.user-avatar {
    width: 40px;
    height: 40px;
    background: linear-gradient(135deg, #3b82f6, #1d4ed8);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 700;
    font-size: 1rem;
}

.user-details {
    display: flex;
    flex-direction: column;
    gap: 0.2rem;
}

.user-name {
    color: white;
    font-weight: 600;
    font-size: 1rem;
}

.user-username {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.8rem;
}

.stat-number {
    color: white;
    font-weight: 700;
    font-size: 1.1rem;
    text-align: center;
}

.type-badge {
    padding: 0.4rem 0.8rem;
    border-radius: 12px;
    font-size: 0.8rem;
    font-weight: 600;
    text-align: center;
}

.type-badge.admin {
    background: rgba(245, 158, 11, 0.2);
    color: #fbbf24;
    border: 1px solid rgba(245, 158, 11, 0.3);
}

.type-badge.user {
    background: rgba(59, 130, 246, 0.2);
    color: #60a5fa;
    border: 1px solid rgba(59, 130, 246, 0.3);
}

.table-empty {
    text-align: center;
    padding: 3rem;
    color: rgba(255, 255, 255, 0.6);
}

.table-empty i {
    font-size: 3rem;
    margin-bottom: 1rem;
    opacity: 0.5;
}

/* Seção 3: Distribuição */
.distribution-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
}

.dist-item {
    background: rgba(255, 255, 255, 0.08);
    border-radius: 16px;
    padding: 1.5rem;
    transition: all 0.3s ease;
}

.dist-item:hover {
    background: rgba(255, 255, 255, 0.12);
    transform: translateY(-4px);
}

.dist-icon {
    width: 60px;
    height: 60px;
    border-radius: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    margin-bottom: 1rem;
}

.dist-icon.user {
    background: rgba(59, 130, 246, 0.2);
    color: #60a5fa;
}

.dist-icon.admin {
    background: rgba(245, 158, 11, 0.2);
    color: #fbbf24;
}

.dist-icon.active {
    background: rgba(16, 185, 129, 0.2);
    color: #10b981;
}

.dist-info {
    margin-bottom: 1rem;
}

.dist-number {
    color: white;
    font-size: 2rem;
    font-weight: 700;
    line-height: 1;
    margin-bottom: 0.5rem;
}

.dist-label {
    color: rgba(255, 255, 255, 0.9);
    font-weight: 600;
    margin-bottom: 0.25rem;
}

.dist-percent {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.9rem;
}

.dist-bar {
    height: 8px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
    overflow: hidden;
}

.dist-fill {
    height: 100%;
    border-radius: 4px;
    transition: width 1.5s ease;
}

.dist-fill.user {
    background: linear-gradient(90deg, #3b82f6, #1d4ed8);
}

.dist-fill.admin {
    background: linear-gradient(90deg, #f59e0b, #d97706);
}

.dist-fill.active {
    background: linear-gradient(90deg, #10b981, #059669);
}

/* Responsividade */
@media (max-width: 768px) {
    .section-header {
        flex-direction: column;
        gap: 1rem;
        text-align: center;
    }
    
    .table-header,
    .table-row {
        grid-template-columns: 1fr;
        gap: 0.5rem;
        text-align: center;
    }
    
    .user-info {
        justify-content: center;
        flex-direction: column;
        text-align: center;
    }
    
    .chart-info {
        grid-template-columns: 1fr;
    }
    
    .distribution-grid {
        grid-template-columns: 1fr;
    }
}

/* Data Lists e Stats Bars (fallback para compatibilidade) */
.data-card h3, .stats-card h3, .summary-card h3 {
    color: white;
    font-weight: 600;
    margin: 0 0 1rem;
}

.data-list {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.data-item {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 0.75rem;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 8px;
}

.item-icon {
    width: 40px;
    height: 40px;
    background: rgba(59, 130, 246, 0.2);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #60a5fa;
}

.item-content {
    flex: 1;
}

.item-content strong {
    color: white;
    display: block;
    margin-bottom: 0.25rem;
}

.item-content span {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.9rem;
}

.item-badge {
    background: rgba(59, 130, 246, 0.3);
    color: #60a5fa;
    padding: 0.25rem 0.75rem;
    border-radius: 12px;
    font-weight: 600;
    font-size: 0.9rem;
}

/* Stats Bars */
.stats-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.stat-row {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.stat-label {
    color: white;
    font-weight: 500;
    min-width: 120px;
}

.stat-bar {
    flex: 1;
    height: 8px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: 4px;
    overflow: hidden;
}

.stat-fill {
    height: 100%;
    background: linear-gradient(90deg, #3b82f6, #1d4ed8);
    border-radius: 4px;
    transition: width 1s ease;
}

.stat-value {
    color: white;
    font-weight: 600;
    min-width: 50px;
    text-align: right;
}

/* Responsividade geral */
@media (max-width: 768px) {
    .reports-container {
        padding: 1rem;
    }
    
    .reports-header {
        flex-direction: column;
        gap: 1rem;
        text-align: center;
    }
    
    .header-controls {
        flex-direction: column;
        gap: 1rem;
        width: 100%;
    }
    
    .period-selector-modern {
        width: 100%;
    }
    
    .period-button {
        min-width: auto;
        width: 100%;
    }
    
    .quick-actions {
        margin-left: 0;
        justify-content: center;
        width: 100%;
    }
    
    .action-btn {
        flex: 1;
        max-width: 60px;
    }
    
    .period-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
    }
    
    .period-modal {
        width: 95%;
        max-height: 85vh;
    }
    
    .modal-header {
        padding: 1.5rem 1rem;
    }
    
    .modal-body {
        padding: 1.5rem 1rem;
    }
    
    .modal-footer {
        padding: 1rem;
        flex-direction: column;
        gap: 1rem;
        text-align: center;
    }
    
    .footer-actions {
        width: 100%;
        justify-content: space-between;
    }
    
    .stats-overview {
        grid-template-columns: 1fr;
        gap: 1rem;
    }
    
    .stat-card {
        padding: 1.5rem;
    }
    
    .reports-grid {
        grid-template-columns: 1fr;
    }
    
    .tab-buttons {
        flex-direction: column;
    }
    
    .tab-button {
        flex: none;
        padding: 1rem;
    }
    
    .insights-cards {
        grid-template-columns: 1fr;
        gap: 1rem;
    }
    
    .insight-card-simple {
        flex-direction: column;
        text-align: center;
        gap: 1rem;
    }
    
    .insight-stats {
        justify-content: center;
        gap: 0.75rem;
    }
    
    .insights-header-simple {
        flex-direction: column;
        gap: 1rem;
        text-align: center;
    }

    /* Responsividade para cards melhorados */
    .distribution-container {
        flex-direction: column;
        gap: 1.5rem;
        align-items: center;
    }
    
    .stats-summary {
        grid-template-columns: 1fr;
    }
    
    .user-stats {
        flex-direction: column;
        gap: 0.5rem;
    }
    
    .data-item-enhanced {
        flex-direction: column;
        text-align: center;
        gap: 1rem;
    }
}

@media (max-width: 480px) {
    .reports-header {
        padding: 1.5rem 1rem;
    }
    
    .header-text h1 {
        font-size: 2rem;
    }
    
    .header-text p {
        font-size: 1rem;
    }
    
    .header-icon {
        width: 60px;
        height: 60px;
        font-size: 1.5rem;
    }
    
    .period-button {
        padding: 0.75rem 1rem;
        gap: 0.75rem;
    }
    
    .period-icon {
        width: 35px;
        height: 35px;
        font-size: 1rem;
    }
    
    .current-period {
        font-size: 0.9rem;
    }
    
    .period-text small {
        font-size: 0.7rem;
    }
    
    .period-modal {
        width: 98%;
        max-height: 90vh;
    }
    
    .modal-header {
        padding: 1rem;
        flex-direction: column;
        gap: 1rem;
    }
    
    .modal-title {
        flex-direction: column;
        text-align: center;
        gap: 0.5rem;
    }
    
    .modal-body {
        padding: 1rem;
    }
    
    .period-card {
        padding: 1rem;
    }
    
    .card-icon {
        width: 50px;
        height: 50px;
        font-size: 1.25rem;
        margin-bottom: 0.75rem;
    }
    
    .card-content h3 {
        font-size: 1.1rem;
    }
    
    .modal-footer {
        padding: 1rem;
        gap: 0.75rem;
    }
    
    .footer-actions {
        gap: 0.5rem;
    }
    
    .btn-secondary, .btn-primary {
        padding: 0.6rem 1rem;
        font-size: 0.9rem;
    }
    
    .action-btn {
        width: 40px;
        height: 40px;
        font-size: 0.9rem;
    }
    
    .stat-card {
        padding: 1rem;
        gap: 0.75rem;
    }
    
    .stat-icon {
        width: 50px;
        height: 50px;
        font-size: 1.25rem;
    }
    
    .stat-number {
        font-size: 1.75rem;
    }
    
    .chart-container {
        height: 250px;
    }
}
/* === ESTATÍSTICAS PREMIUM === */
.stats-overview-premium {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 2rem;
    margin-bottom: 3rem;
}

.stat-card-premium {
    background: white;
    border-radius: 24px;
    padding: 0;
    border: 1px solid rgba(226, 232, 240, 0.3);
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.04);
    position: relative;
    overflow: hidden;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    cursor: pointer;
    min-height: 280px;
    display: flex;
    flex-direction: column;
}

.stat-card-premium:hover {
    transform: translateY(-12px) scale(1.02);
    box-shadow: 0 25px 60px rgba(0, 0, 0, 0.15);
    border-color: rgba(59, 130, 246, 0.3);
}

/* Fundo animado */
.card-background {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    overflow: hidden;
    z-index: 1;
}

.floating-shapes {
    position: relative;
    width: 100%;
    height: 100%;
}

.floating-shapes .shape-1,
.floating-shapes .shape-2,
.floating-shapes .shape-3 {
    position: absolute;
    border-radius: 50%;
    animation: float 6s ease-in-out infinite;
    opacity: 0.1;
}

.floating-shapes .shape-1 {
    width: 80px;
    height: 80px;
    top: 20%;
    right: 10%;
    animation-delay: 0s;
}

.floating-shapes .shape-2 {
    width: 40px;
    height: 40px;
    top: 60%;
    right: 30%;
    animation-delay: 2s;
}

.floating-shapes .shape-3 {
    width: 20px;
    height: 20px;
    top: 80%;
    right: 60%;
    animation-delay: 4s;
}

/* Cores específicas dos cards */
.stat-card-premium.users {
    background: linear-gradient(135deg, rgba(59, 130, 246, 0.02), rgba(29, 78, 216, 0.08));
}

.stat-card-premium.users .floating-shapes .shape-1,
.stat-card-premium.users .floating-shapes .shape-2,
.stat-card-premium.users .floating-shapes .shape-3 {
    background: linear-gradient(135deg, #3b82f6, #1d4ed8);
}

.stat-card-premium.units {
    background: linear-gradient(135deg, rgba(16, 185, 129, 0.02), rgba(5, 150, 105, 0.08));
}

.stat-card-premium.units .floating-shapes .shape-1,
.stat-card-premium.units .floating-shapes .shape-2,
.stat-card-premium.units .floating-shapes .shape-3 {
    background: linear-gradient(135deg, #10b981, #059669);
}

.stat-card-premium.calls {
    background: linear-gradient(135deg, rgba(139, 92, 246, 0.02), rgba(124, 58, 237, 0.08));
}

.stat-card-premium.calls .floating-shapes .shape-1,
.stat-card-premium.calls .floating-shapes .shape-2,
.stat-card-premium.calls .floating-shapes .shape-3 {
    background: linear-gradient(135deg, #8b5cf6, #7c3aed);
}

.stat-card-premium.admins {
    background: linear-gradient(135deg, rgba(245, 158, 11, 0.02), rgba(217, 119, 6, 0.08));
}

.stat-card-premium.admins .floating-shapes .shape-1,
.stat-card-premium.admins .floating-shapes .shape-2,
.stat-card-premium.admins .floating-shapes .shape-3 {
    background: linear-gradient(135deg, #f59e0b, #d97706);
}

/* Header do card */
.card-header-premium {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    padding: 2rem 2rem 0;
    position: relative;
    z-index: 10;
}

.stat-icon-premium {
    width: 70px;
    height: 70px;
    border-radius: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    backdrop-filter: blur(10px);
    border: 2px solid rgba(255, 255, 255, 0.2);
    transition: all 0.3s ease;
}

.stat-icon-premium i {
    font-size: 32px;
    color: white;
    z-index: 2;
    position: relative;
}

.icon-glow {
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    border-radius: 22px;
    opacity: 0;
    transition: all 0.3s ease;
    z-index: 1;
}

.stat-card-premium:hover .icon-glow {
    opacity: 0.6;
    animation: pulse-glow 2s infinite;
}

/* Ícones específicos */
.stat-card-premium.users .stat-icon-premium {
    background: linear-gradient(135deg, #3b82f6, #1d4ed8);
}

.stat-card-premium.users .icon-glow {
    background: linear-gradient(135deg, #3b82f6, #1d4ed8);
}

.stat-card-premium.units .stat-icon-premium {
    background: linear-gradient(135deg, #10b981, #059669);
}

.stat-card-premium.units .icon-glow {
    background: linear-gradient(135deg, #10b981, #059669);
}

.stat-card-premium.calls .stat-icon-premium {
    background: linear-gradient(135deg, #8b5cf6, #7c3aed);
}

.stat-card-premium.calls .icon-glow {
    background: linear-gradient(135deg, #8b5cf6, #7c3aed);
}

.stat-card-premium.admins .stat-icon-premium {
    background: linear-gradient(135deg, #f59e0b, #d97706);
}

.stat-card-premium.admins .icon-glow {
    background: linear-gradient(135deg, #f59e0b, #d97706);
}

/* Badge do card */
.card-badge-premium {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    border-radius: 50px;
    font-size: 0.85rem;
    font-weight: 600;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: white;
    transition: all 0.3s ease;
}

.card-badge-premium i {
    font-size: 0.75rem;
}

.card-badge-premium {
    background: linear-gradient(135deg, rgba(34, 197, 94, 0.9), rgba(21, 128, 61, 0.9));
}

.card-badge-premium.stable {
    background: linear-gradient(135deg, rgba(34, 197, 94, 0.9), rgba(21, 128, 61, 0.9));
}

.card-badge-premium.growing {
    background: linear-gradient(135deg, rgba(168, 85, 247, 0.9), rgba(124, 58, 237, 0.9));
}

.card-badge-premium.secure {
    background: linear-gradient(135deg, rgba(245, 158, 11, 0.9), rgba(217, 119, 6, 0.9));
}

/* Conteúdo do card */
.card-content-premium {
    padding: 1.5rem 2rem;
    position: relative;
    z-index: 10;
    flex: 1;
}

.stat-number-premium {
    font-size: 3.5rem;
    font-weight: 800;
    line-height: 1;
    margin-bottom: 0.5rem;
    color: #1e293b;
    font-family: 'Segoe UI', system-ui, sans-serif;
}

.stat-label-premium {
    font-size: 1.1rem;
    font-weight: 600;
    color: #64748b;
    margin-bottom: 1rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.stat-detail-premium {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.detail-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.9rem;
    color: #64748b;
}

.detail-item i {
    font-size: 0.7rem;
    width: 12px;
}

.active-dot {
    color: #22c55e !important;
}

.inactive-dot {
    color: #ef4444 !important;
}

.resolved {
    color: #22c55e !important;
}

.pending {
    color: #f59e0b !important;
}

.security-key {
    color: #f59e0b !important;
}

/* Progresso e visualizações */
.card-progress-premium {
    padding: 0 2rem 2rem;
    position: relative;
    z-index: 10;
}

.progress-bar-premium {
    height: 6px;
    background: rgba(148, 163, 184, 0.2);
    border-radius: 3px;
    overflow: hidden;
    margin-bottom: 0.5rem;
}

.progress-fill-premium {
    height: 100%;
    border-radius: 3px;
    transition: width 1s ease;
    position: relative;
}

.progress-fill-premium.users {
    background: linear-gradient(90deg, #3b82f6, #1d4ed8);
}

.progress-text-premium {
    font-size: 0.85rem;
    color: #64748b;
    font-weight: 500;
}

/* Visualização de rede */
.network-visualization {
    height: 40px;
    position: relative;
    margin-bottom: 0.5rem;
}

.network-nodes {
    display: flex;
    align-items: center;
    justify-content: space-between;
    height: 100%;
    position: relative;
}

.node {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: linear-gradient(135deg, #10b981, #059669);
    position: relative;
    animation: network-pulse 2s infinite;
}

.node.main {
    width: 12px;
    height: 12px;
    animation-delay: 0s;
}

.node.secondary:nth-child(2) { animation-delay: 0.5s; }
.node.secondary:nth-child(3) { animation-delay: 1s; }
.node.secondary:nth-child(4) { animation-delay: 1.5s; }

/* Atividade de chamadas */
.call-activity {
    height: 40px;
    margin-bottom: 0.5rem;
}

.activity-bars {
    display: flex;
    align-items: flex-end;
    gap: 3px;
    height: 100%;
    padding: 5px 0;
}

.activity-bars .bar {
    flex: 1;
    background: linear-gradient(180deg, #8b5cf6, #7c3aed);
    border-radius: 2px;
    min-height: 4px;
    animation: bar-bounce 2s infinite;
}

.activity-bars .bar:nth-child(1) { animation-delay: 0s; }
.activity-bars .bar:nth-child(2) { animation-delay: 0.2s; }
.activity-bars .bar:nth-child(3) { animation-delay: 0.4s; }
.activity-bars .bar:nth-child(4) { animation-delay: 0.6s; }
.activity-bars .bar:nth-child(5) { animation-delay: 0.8s; }

/* Indicador de segurança */
.security-indicator {
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    margin-bottom: 0.5rem;
}

.security-rings {
    position: relative;
    width: 40px;
    height: 40px;
}

.ring {
    position: absolute;
    border: 2px solid rgba(245, 158, 11, 0.3);
    border-radius: 50%;
    animation: security-ring 3s infinite;
}

.ring-1 {
    width: 20px;
    height: 20px;
    top: 10px;
    left: 10px;
    animation-delay: 0s;
}

.ring-2 {
    width: 30px;
    height: 30px;
    top: 5px;
    left: 5px;
    animation-delay: 1s;
}

.ring-3 {
    width: 40px;
    height: 40px;
    top: 0;
    left: 0;
    animation-delay: 2s;
}

.security-core {
    width: 8px;
    height: 8px;
    background: linear-gradient(135deg, #f59e0b, #d97706);
    border-radius: 50%;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    animation: security-pulse 1.5s infinite;
}

/* === ANIMAÇÕES === */
@keyframes float {
    0%, 100% { transform: translateY(0px) rotate(0deg); }
    50% { transform: translateY(-20px) rotate(180deg); }
}

@keyframes pulse-glow {
    0%, 100% { transform: scale(1); opacity: 0.6; }
    50% { transform: scale(1.1); opacity: 0.8; }
}

@keyframes network-pulse {
    0%, 100% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.5); opacity: 0.7; }
}

@keyframes bar-bounce {
    0%, 100% { transform: scaleY(1); }
    50% { transform: scaleY(1.2); }
}

@keyframes security-ring {
    0% { transform: scale(0.8); opacity: 1; }
    100% { transform: scale(1.2); opacity: 0; }
}

@keyframes security-pulse {
    0%, 100% { transform: translate(-50%, -50%) scale(1); }
    50% { transform: translate(-50%, -50%) scale(1.2); }
}

/* Contador animado */
@keyframes countUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

.number-counter {
    display: inline-block;
    animation: countUp 0.8s ease;
}

/* Responsividade */
@media (max-width: 768px) {
    .stats-overview-premium {
        grid-template-columns: 1fr;
        gap: 1.5rem;
    }
    
    .stat-card-premium {
        min-height: 240px;
    }
    
    .card-header-premium {
        padding: 1.5rem 1.5rem 0;
    }
    
    .card-content-premium {
        padding: 1rem 1.5rem;
    }
    
    .card-progress-premium {
        padding: 0 1.5rem 1.5rem;
    }
    
    .stat-number-premium {
        font-size: 2.5rem;
    }
}

/* === MELHORIAS DE LEGIBILIDADE === */
.stat-number-premium {
    font-size: 4.5rem !important;
    font-weight: 900 !important;
    color: #0f172a !important;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
    margin-bottom: 1rem !important;
}

.stat-label-premium {
    font-size: 1.3rem !important;
    font-weight: 700 !important;
    color: #1f2937 !important;
    margin-bottom: 1.5rem !important;
    letter-spacing: 1.2px !important;
}

.detail-item {
    font-size: 1.1rem !important;
    color: #374151 !important;
    font-weight: 600 !important;
    padding: 0.75rem 0 !important;
    gap: 1rem !important;
}

.detail-item i {
    font-size: 1rem !important;
    width: 18px !important;
    font-weight: 700 !important;
}

.progress-text-premium {
    font-size: 1rem !important;
    color: #374151 !important;
    font-weight: 600 !important;
}

/* Melhorar contraste dos badges */
.card-badge-premium {
    font-size: 0.95rem !important;
    font-weight: 700 !important;
    padding: 0.75rem 1.25rem !important;
    backdrop-filter: blur(15px) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
}

/* Melhorar visibilidade dos ícones */
.stat-icon-premium i {
    font-size: 36px !important;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3) !important;
}

/* Cores mais contrastantes por card */
.stat-card-premium.users .stat-number-premium {
    color: #1e40af !important;
}

.stat-card-premium.units .stat-number-premium {
    color: #059669 !important;
}

.stat-card-premium.calls .stat-number-premium {
    color: #7c3aed !important;
}

.stat-card-premium.admins .stat-number-premium {
    color: #d97706 !important;
}

/* Responsividade melhorada */
@media (max-width: 768px) {
    .stat-number-premium {
        font-size: 3rem !important;
    }
    
    .stat-label-premium {
        font-size: 1.1rem !important;
    }
    
    .detail-item {
        font-size: 1rem !important;
    }
}

/* ===== CSS PREMIUM PARA TOP USUÁRIOS MAIS ATIVOS ===== */

/* Seção Premium */
.top-users-premium-section {
    background: rgba(255, 255, 255, 0.15) !important;
    backdrop-filter: blur(25px) !important;
    border: 2px solid rgba(255, 255, 255, 0.25) !important;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15) !important;
}

/* Cabeçalho Premium */
.premium-header {
    display: flex !important;
    justify-content: space-between !important;
    align-items: flex-start !important;
    padding: 2rem 2.5rem 1.5rem !important;
    border-bottom: 1px solid rgba(255, 255, 255, 0.2) !important;
}

.header-left h3 {
    color: white !important;
    font-size: 1.8rem !important;
    font-weight: 800 !important;
    margin: 0 0 0.5rem 0 !important;
    display: flex !important;
    align-items: center !important;
    gap: 1rem !important;
}

.section-icon-premium {
    position: relative !important;
    width: 60px !important;
    height: 60px !important;
    background: linear-gradient(135deg, #fbbf24, #f59e0b) !important;
    border-radius: 16px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    font-size: 1.5rem !important;
    color: white !important;
    box-shadow: 0 8px 25px rgba(251, 191, 36, 0.4) !important;
}

.icon-sparkle {
    position: absolute !important;
    top: -5px !important;
    right: -5px !important;
    width: 20px !important;
    height: 20px !important;
    background: linear-gradient(135deg, #fde047, #facc15) !important;
    border-radius: 50% !important;
    animation: sparkle 2s infinite !important;
}

@keyframes sparkle {
    0%, 100% { transform: scale(1) rotate(0deg); opacity: 1; }
    50% { transform: scale(1.2) rotate(180deg); opacity: 0.8; }
}

.section-subtitle {
    color: rgba(255, 255, 255, 0.85) !important;
    font-size: 1rem !important;
    font-weight: 500 !important;
    margin: 0 !important;
}

.header-right {
    display: flex !important;
    align-items: center !important;
    gap: 1.5rem !important;
}

.premium-count {
    background: rgba(59, 130, 246, 0.2) !important;
    border: 1px solid rgba(59, 130, 246, 0.4) !important;
    color: #60a5fa !important;
    padding: 0.75rem 1.25rem !important;
    border-radius: 12px !important;
    font-weight: 700 !important;
    display: flex !important;
    align-items: center !important;
    gap: 0.5rem !important;
}

.view-mode-toggle {
    display: flex !important;
    background: rgba(255, 255, 255, 0.1) !important;
    border-radius: 10px !important;
    padding: 0.25rem !important;
}

.mode-btn {
    padding: 0.5rem 0.75rem !important;
    border: none !important;
    background: transparent !important;
    color: rgba(255, 255, 255, 0.7) !important;
    border-radius: 6px !important;
    cursor: pointer !important;
    transition: all 0.3s ease !important;
}

.mode-btn.active {
    background: rgba(255, 255, 255, 0.2) !important;
    color: white !important;
}

/* Conteúdo Premium */
.premium-content {
    padding: 0 !important;
}

/* Tabela Premium */
.users-table-premium {
    background: rgba(255, 255, 255, 0.08) !important;
    border-radius: 16px !important;
    margin: 2rem !important;
    overflow: hidden !important;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1) !important;
}

.table-header-premium {
    display: grid !important;
    grid-template-columns: 120px 2fr 1.5fr 1.5fr 1.5fr !important;
    gap: 1rem !important;
    padding: 1.5rem 2rem !important;
    background: rgba(255, 255, 255, 0.15) !important;
    border-bottom: 2px solid rgba(255, 255, 255, 0.1) !important;
}

.table-header-premium > div {
    display: flex !important;
    align-items: center !important;
    gap: 0.5rem !important;
    color: white !important;
    font-weight: 700 !important;
    font-size: 0.95rem !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
}

.table-header-premium i {
    color: #60a5fa !important;
    font-size: 1rem !important;
}

/* Linhas da Tabela Premium */
.table-row-premium {
    display: grid !important;
    grid-template-columns: 120px 2fr 1.5fr 1.5fr 1.5fr !important;
    gap: 1rem !important;
    padding: 1.5rem 2rem !important;
    border-bottom: 1px solid rgba(255, 255, 255, 0.08) !important;
    transition: all 0.4s ease !important;
    animation: slideInFromLeft 0.6s ease forwards !important;
    opacity: 0 !important;
    transform: translateX(-30px) !important;
}

@keyframes slideInFromLeft {
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

.table-row-premium:hover {
    background: rgba(255, 255, 255, 0.12) !important;
    transform: translateX(8px) !important;
    box-shadow: inset 4px 0 0 #60a5fa !important;
}

.table-row-premium.top-performer {
    background: rgba(251, 191, 36, 0.1) !important;
    border-left: 4px solid #fbbf24 !important;
}

.table-row-premium.top-performer:hover {
    background: rgba(251, 191, 36, 0.15) !important;
    box-shadow: inset 4px 0 0 #fbbf24 !important;
}

/* Colunas Premium */
.col-rank-premium {
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
}

.rank-badge-premium {
    position: relative !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    padding: 0.75rem !important;
    border-radius: 12px !important;
    font-weight: 700 !important;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15) !important;
    overflow: hidden !important;
}

.rank-badge-premium.gold {
    background: linear-gradient(135deg, #fbbf24, #f59e0b) !important;
    color: white !important;
    animation: goldGlow 3s ease-in-out infinite !important;
}

.rank-badge-premium.silver {
    background: linear-gradient(135deg, #e5e7eb, #9ca3af) !important;
    color: white !important;
}

.rank-badge-premium.bronze {
    background: linear-gradient(135deg, #cd7c0f, #92400e) !important;
    color: white !important;
}

.rank-badge-premium.normal {
    background: rgba(255, 255, 255, 0.2) !important;
    color: white !important;
}

@keyframes goldGlow {
    0%, 100% { box-shadow: 0 6px 20px rgba(251, 191, 36, 0.3); }
    50% { box-shadow: 0 8px 30px rgba(251, 191, 36, 0.6); }
}

.rank-icon {
    font-size: 1.2rem !important;
    margin-bottom: 0.25rem !important;
}

.rank-number {
    font-size: 0.9rem !important;
    font-weight: 800 !important;
}

/* Informações do Usuário Premium */
.user-info-premium {
    display: flex !important;
    align-items: center !important;
    gap: 1rem !important;
}

.user-avatar-premium {
    position: relative !important;
    width: 56px !important;
    height: 56px !important;
    border-radius: 50% !important;
    overflow: hidden !important;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2) !important;
}

.user-avatar-premium.top-user-avatar {
    border: 3px solid #fbbf24 !important;
    box-shadow: 0 6px 20px rgba(251, 191, 36, 0.4) !important;
}

.avatar-image {
    width: 100% !important;
    height: 100% !important;
    background: linear-gradient(135deg, #3b82f6, #1d4ed8) !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    color: white !important;
    font-weight: 700 !important;
    font-size: 1.3rem !important;
}

.avatar-crown {
    position: absolute !important;
    top: -8px !important;
    right: -8px !important;
    width: 24px !important;
    height: 24px !important;
    background: linear-gradient(135deg, #fbbf24, #f59e0b) !important;
    border-radius: 50% !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    color: white !important;
    font-size: 0.8rem !important;
    border: 2px solid white !important;
}

.avatar-status {
    position: absolute !important;
    bottom: 2px !important;
    right: 2px !important;
    width: 14px !important;
    height: 14px !important;
    border-radius: 50% !important;
    border: 2px solid white !important;
}

.avatar-status.online {
    background: #10b981 !important;
}

.user-details-premium {
    display: flex !important;
    flex-direction: column !important;
    gap: 0.25rem !important;
}

.user-name-premium {
    color: white !important;
    font-weight: 700 !important;
    font-size: 1.1rem !important;
    display: flex !important;
    align-items: center !important;
    gap: 0.5rem !important;
}

.user-star {
    color: #fbbf24 !important;
    font-size: 0.9rem !important;
    animation: starTwinkle 2s ease-in-out infinite !important;
}

@keyframes starTwinkle {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.7; transform: scale(1.1); }
}

.user-username-premium {
    color: rgba(255, 255, 255, 0.75) !important;
    font-size: 0.9rem !important;
    font-weight: 500 !important;
}

.user-join-date {
    color: rgba(255, 255, 255, 0.6) !important;
    font-size: 0.8rem !important;
    display: flex !important;
    align-items: center !important;
    gap: 0.3rem !important;
}

/* Métricas de Atividade */
.activity-metrics {
    display: flex !important;
    flex-direction: column !important;
    gap: 0.75rem !important;
}

.metric-item {
    display: flex !important;
    align-items: center !important;
    gap: 0.75rem !important;
    padding: 0.5rem 0.75rem !important;
    background: rgba(255, 255, 255, 0.08) !important;
    border-radius: 8px !important;
    transition: all 0.3s ease !important;
}

.metric-item:hover {
    background: rgba(255, 255, 255, 0.12) !important;
}

.metric-item.calls .metric-icon {
    background: rgba(139, 92, 246, 0.2) !important;
    color: #a78bfa !important;
}

.metric-item.units .metric-icon {
    background: rgba(16, 185, 129, 0.2) !important;
    color: #34d399 !important;
}

.metric-icon {
    width: 32px !important;
    height: 32px !important;
    border-radius: 8px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    font-size: 0.9rem !important;
}

.metric-info {
    display: flex !important;
    flex-direction: column !important;
    gap: 0.1rem !important;
}

.metric-number {
    color: white !important;
    font-weight: 700 !important;
    font-size: 1.1rem !important;
}

.metric-label {
    color: rgba(255, 255, 255, 0.7) !important;
    font-size: 0.8rem !important;
}

.activity-score {
    margin-top: 0.5rem !important;
    padding: 0.75rem !important;
    background: rgba(255, 255, 255, 0.05) !important;
    border-radius: 8px !important;
}

.score-bar {
    width: 100% !important;
    height: 6px !important;
    background: rgba(255, 255, 255, 0.2) !important;
    border-radius: 3px !important;
    overflow: hidden !important;
    margin-bottom: 0.5rem !important;
}

.score-fill {
    height: 100% !important;
    background: linear-gradient(90deg, #3b82f6, #1d4ed8) !important;
    border-radius: 3px !important;
    transition: width 2s ease !important;
}

.score-text {
    color: rgba(255, 255, 255, 0.8) !important;
    font-size: 0.8rem !important;
    font-weight: 600 !important;
}

/* Estatísticas Mini */
.stats-grid {
    display: flex !important;
    flex-direction: column !important;
    gap: 0.5rem !important;
}

.stat-card-mini {
    display: flex !important;
    align-items: center !important;
    gap: 0.5rem !important;
    padding: 0.5rem 0.75rem !important;
    border-radius: 8px !important;
    transition: all 0.3s ease !important;
}

.stat-card-mini.success {
    background: rgba(16, 185, 129, 0.15) !important;
    border: 1px solid rgba(16, 185, 129, 0.3) !important;
}

.stat-card-mini.efficiency {
    background: rgba(245, 158, 11, 0.15) !important;
    border: 1px solid rgba(245, 158, 11, 0.3) !important;
}

.stat-card-mini i {
    color: #10b981 !important;
    font-size: 1rem !important;
}

.stat-card-mini.efficiency i {
    color: #fbbf24 !important;
}

.stat-content {
    display: flex !important;
    flex-direction: column !important;
    gap: 0.1rem !important;
}

.stat-value {
    color: white !important;
    font-weight: 700 !important;
    font-size: 0.9rem !important;
}

.stat-desc {
    color: rgba(255, 255, 255, 0.7) !important;
    font-size: 0.7rem !important;
}

/* Badges de Status */
.status-badges {
    display: flex !important;
    flex-direction: column !important;
    gap: 0.5rem !important;
    margin-bottom: 0.75rem !important;
}

.status-badge {
    display: flex !important;
    align-items: center !important;
    gap: 0.5rem !important;
    padding: 0.4rem 0.75rem !important;
    border-radius: 12px !important;
    font-size: 0.8rem !important;
    font-weight: 600 !important;
}

.admin-badge {
    background: rgba(245, 158, 11, 0.2) !important;
    color: #fbbf24 !important;
    border: 1px solid rgba(245, 158, 11, 0.3) !important;
}

.user-badge {
    background: rgba(59, 130, 246, 0.2) !important;
    color: #60a5fa !important;
    border: 1px solid rgba(59, 130, 246, 0.3) !important;
}

.vip-badge {
    background: rgba(251, 191, 36, 0.2) !important;
    color: #fbbf24 !important;
    border: 1px solid rgba(251, 191, 36, 0.3) !important;
    animation: vipPulse 2s ease-in-out infinite !important;
}

@keyframes vipPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
}

.active-badge {
    background: rgba(16, 185, 129, 0.2) !important;
    color: #10b981 !important;
    border: 1px solid rgba(16, 185, 129, 0.3) !important;
}

.last-activity {
    display: flex !important;
    align-items: center !important;
    gap: 0.5rem !important;
    color: rgba(255, 255, 255, 0.6) !important;
    font-size: 0.8rem !important;
}

.last-activity i {
    color: #10b981 !important;
}

/* Cards Premium (Modo Alternativo) */
.users-cards-premium {
    display: none !important;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)) !important;
    gap: 1.5rem !important;
    padding: 2rem !important;
}

.user-card-premium {
    background: rgba(255, 255, 255, 0.1) !important;
    backdrop-filter: blur(20px) !important;
    border-radius: 16px !important;
    border: 1px solid rgba(255, 255, 255, 0.2) !important;
    padding: 1.5rem !important;
    transition: all 0.3s ease !important;
}

.user-card-premium:hover {
    transform: translateY(-8px) !important;
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2) !important;
}

.user-card-premium.top-user-card {
    border: 2px solid #fbbf24 !important;
    box-shadow: 0 8px 25px rgba(251, 191, 36, 0.3) !important;
}

/* Estados Vazios Premium */
.table-empty-premium {
    text-align: center !important;
    padding: 4rem 2rem !important;
    color: rgba(255, 255, 255, 0.7) !important;
}

.empty-icon {
    font-size: 3.5rem !important;
    margin-bottom: 1.5rem !important;
    opacity: 0.5 !important;
    color: #60a5fa !important;
}

.table-empty-premium h4 {
    color: white !important;
    font-size: 1.3rem !important;
    font-weight: 600 !important;
    margin: 0 0 0.5rem 0 !important;
}

.table-empty-premium p {
    color: rgba(255, 255, 255, 0.6) !important;
    margin: 0 !important;
}

/* Responsividade Premium */
@media (max-width: 1200px) {
    .table-header-premium,
    .table-row-premium {
        grid-template-columns: 100px 1.5fr 1fr 1fr 1fr !important;
        gap: 0.75rem !important;
    }
}

@media (max-width: 768px) {
    .premium-header {
        flex-direction: column !important;
        gap: 1.5rem !important;
        text-align: center !important;
    }
    
    .header-right {
        justify-content: center !important;
    }
    
    .table-header-premium,
    .table-row-premium {
        grid-template-columns: 1fr !important;
        gap: 0.5rem !important;
        text-align: center !important;
    }
    
    .table-header-premium {
        display: none !important;
    }
    
    .table-row-premium {
        display: flex !important;
        flex-direction: column !important;
        gap: 1rem !important;
        padding: 1.5rem !important;
        border-radius: 12px !important;
        margin-bottom: 1rem !important;
        background: rgba(255, 255, 255, 0.08) !important;
    }
    
    .users-cards-premium {
        grid-template-columns: 1fr !important;
    }
}

/* ===== FIM CSS PREMIUM TOP USUÁRIOS ===== */

/* Responsividade melhorada */
@media (max-width: 768px) {
    .stat-number-premium {
        font-size: 3rem !important;
    }
    
    .stat-label-premium {
        font-size: 1.1rem !important;
    }
    
    .detail-item {
        font-size: 1rem !important;
    }
}

/* ===== CSS PARA TOP USUÁRIOS MAIS ATIVOS ===== */

/* Controles da seção */
.section-controls {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.count-badge {
    background: rgba(255, 255, 255, 0.1);
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 8px;
    font-size: 0.9rem;
    font-weight: 600;
}

.view-toggle {
    display: flex;
    gap: 0.5rem;
}

.toggle-btn {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: rgba(255, 255, 255, 0.7);
    padding: 0.5rem 0.75rem;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.toggle-btn:hover {
    background: rgba(255, 255, 255, 0.2);
    color: white;
}

.toggle-btn.active {
    background: rgba(59, 130, 246, 0.3);
    color: white;
    border-color: rgba(59, 130, 246, 0.5);
}

/* Tabela de usuários */
.users-table-view {
    display: block;
}

.users-table-view.active {
    display: block;
}

.users-cards-view {
    display: none;
}

.users-cards-view.active {
    display: block;
}

.table-responsive {
    overflow-x: auto;
}

.users-table {
    width: 100%;
    border-collapse: collapse;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
}

.users-table th {
    background: rgba(255, 255, 255, 0.1);
    color: white;
    padding: 1rem;
    font-weight: 600;
    text-align: left;
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.users-table td {
    padding: 1rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    vertical-align: middle;
}

.user-row {
    transition: all 0.3s ease;
}

.user-row:hover {
    background: rgba(255, 255, 255, 0.08);
}

.user-row.top-user {
    background: rgba(251, 191, 36, 0.1);
    border-left: 4px solid #fbbf24;
}

.user-row.top-user:hover {
    background: rgba(251, 191, 36, 0.15);
}

/* Células da tabela */
.rank-cell {
    text-align: center;
    width: 80px;
}

.rank-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 0.75rem;
    border-radius: 8px;
    font-weight: 600;
    font-size: 0.9rem;
}

.rank-badge.gold {
    background: linear-gradient(135deg, #fbbf24, #f59e0b);
    color: white;
}

.rank-badge.silver {
    background: linear-gradient(135deg, #e5e7eb, #9ca3af);
    color: white;
}

.rank-badge.bronze {
    background: linear-gradient(135deg, #cd7c0f, #92400e);
    color: white;
}

.rank-badge:not(.gold):not(.silver):not(.bronze) {
    background: rgba(255, 255, 255, 0.1);
    color: white;
}

.user-info {
    display: flex;
    align-items: center;
    gap: 1rem;
    min-width: 200px;
}

.user-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: linear-gradient(135deg, #3b82f6, #1d4ed8);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 600;
    font-size: 1.1rem;
    flex-shrink: 0;
}

.user-details {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
}

.user-name {
    color: white;
    font-weight: 600;
    font-size: 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.top-star {
    color: #fbbf24;
    font-size: 0.8rem;
}

.user-username {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.85rem;
}

.metric-cell {
    text-align: center;
    width: 100px;
}

.metric-value {
    color: white;
    font-weight: 600;
    font-size: 1.1rem;
    margin-bottom: 0.25rem;
}

.metric-label {
    color: rgba(255, 255, 255, 0.6);
    font-size: 0.8rem;
}

.progress-circle {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: conic-gradient(#10b981 0deg 270deg, rgba(255, 255, 255, 0.1) 270deg);
    position: relative;
    margin: 0 auto;
}

.progress-text {
    color: white;
    font-weight: 600;
    font-size: 0.9rem;
}

.status-cell {
    text-align: center;
    width: 120px;
}

.status-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 0.75rem;
    border-radius: 8px;
    font-weight: 600;
    font-size: 0.85rem;
}

.status-badge.admin {
    background: rgba(245, 158, 11, 0.2);
    color: #fbbf24;
    border: 1px solid rgba(245, 158, 11, 0.3);
}

.status-badge.user {
    background: rgba(59, 130, 246, 0.2);
    color: #60a5fa;
    border: 1px solid rgba(59, 130, 246, 0.3);
}

.empty-state {
    text-align: center;
    padding: 3rem 2rem;
    color: rgba(255, 255, 255, 0.7);
}

.empty-icon {
    font-size: 3rem;
    margin-bottom: 1rem;
    opacity: 0.5;
}

.empty-state h4 {
    color: white;
    margin-bottom: 0.5rem;
}

/* Visualização em Cards */
.cards-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
    margin-top: 1rem;
}

.user-card {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 1.5rem;
    transition: all 0.3s ease;
}

.user-card:hover {
    background: rgba(255, 255, 255, 0.08);
    transform: translateY(-2px);
}

.user-card.top-user-card {
    border-left: 4px solid #fbbf24;
    background: rgba(251, 191, 36, 0.1);
}

.card-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1rem;
}

.rank-indicator {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: 600;
}

.rank-indicator .gold {
    color: #fbbf24;
}

.rank-indicator .silver {
    color: #9ca3af;
}

.rank-indicator .bronze {
    color: #cd7c0f;
}

.rank-num {
    color: white;
    font-weight: 600;
}

.card-body h4 {
    color: white;
    margin-bottom: 0.5rem;
}

.card-body p {
    color: rgba(255, 255, 255, 0.7);
    margin-bottom: 1rem;
}

.card-metrics {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    margin-bottom: 1rem;
}

.card-metrics .metric {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: rgba(255, 255, 255, 0.8);
    font-size: 0.9rem;
}

.card-metrics .metric i {
    color: #60a5fa;
    width: 16px;
}

.card-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-top: 1rem;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.role-tag {
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-size: 0.8rem;
    font-weight: 600;
}

.role-tag.admin {
    background: rgba(245, 158, 11, 0.2);
    color: #fbbf24;
}

.role-tag.user {
    background: rgba(59, 130, 246, 0.2);
    color: #60a5fa;
}

/* Responsividade */
@media (max-width: 768px) {
    .section-controls {
        flex-direction: column;
        gap: 1rem;
        align-items: flex-start;
    }
    
    .users-table {
        font-size: 0.85rem;
    }
    
    .users-table th,
    .users-table td {
        padding: 0.75rem 0.5rem;
    }
    
    .user-info {
        min-width: 150px;
    }
    
    .cards-grid {
        grid-template-columns: 1fr;
    }
}

/* Cabeçalho Premium */
.premium-header {
    display: flex !important;
    justify-content: space-between !important;
    align-items: flex-start !important;
    padding: 2rem 2.5rem 1.5rem !important;
    border-bottom: 1px solid rgba(255, 255, 255, 0.2) !important;
}

.header-left h3 {
    color: white !important;
    font-size: 1.8rem !important;
    font-weight: 800 !important;
    margin: 0 0 0.5rem 0 !important;
    display: flex !important;
    align-items: center !important;
    gap: 1rem !important;
}

.section-icon-premium {
    position: relative !important;
    width: 60px !important;
    height: 60px !important;
    background: linear-gradient(135deg, #fbbf24, #f59e0b) !important;
    border-radius: 16px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    font-size: 1.5rem !important;
    color: white !important;
    box-shadow: 0 8px 25px rgba(251, 191, 36, 0.4) !important;
}

.icon-sparkle {
    position: absolute !important;
    top: -5px !important;
    right: -5px !important;
    width: 20px !important;
    height: 20px !important;
    background: linear-gradient(135deg, #fde047, #facc15) !important;
    border-radius: 50% !important;
    animation: sparkle 2s infinite !important;
}

@keyframes sparkle {
    0%, 100% { transform: scale(1) rotate(0deg); opacity: 1; }
    50% { transform: scale(1.2) rotate(180deg); opacity: 0.8; }
}

.section-subtitle {
    color: rgba(255, 255, 255, 0.85) !important;
    font-size: 1rem !important;
    font-weight: 500 !important;
    margin: 0 !important;
}

.premium-count {
    background: rgba(59, 130, 246, 0.2) !important;
    border: 1px solid rgba(59, 130, 246, 0.4) !important;
    color: #60a5fa !important;
    padding: 0.75rem 1.25rem !important;
    border-radius: 12px !important;
    font-weight: 700 !important;
    font-size: 1.1rem !important;
    display: flex !important;
    align-items: center !important;
    gap: 0.5rem !important;
}

/* Tabela Premium */
.users-table-premium {
    background: rgba(255, 255, 255, 0.08) !important;
    border-radius: 16px !important;
    margin: 2rem !important;
    overflow: hidden !important;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1) !important;
}

.table-header-premium {
    display: grid !important;
    grid-template-columns: 120px 2fr 1.5fr 1.5fr 1.5fr !important;
    gap: 1rem !important;
    padding: 1.5rem 2rem !important;
    background: rgba(255, 255, 255, 0.15) !important;
    border-bottom: 2px solid rgba(255, 255, 255, 0.1) !important;
}

.table-header-premium > div {
    display: flex !important;
    align-items: center !important;
    gap: 0.5rem !important;
    color: white !important;
    font-weight: 700 !important;
    font-size: 1.1rem !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
}

.table-header-premium i {
    color: #60a5fa !important;
    font-size: 1.2rem !important;
}

/* Linhas da Tabela Premium */
.table-row-premium {
    display: grid !important;
    grid-template-columns: 120px 2fr 1.5fr 1.5fr 1.5fr !important;
    gap: 1rem !important;
    padding: 1.5rem 2rem !important;
    border-bottom: 1px solid rgba(255, 255, 255, 0.08) !important;
    transition: all 0.4s ease !important;
    animation: slideInFromLeft 0.6s ease forwards !important;
    opacity: 0 !important;
    transform: translateX(-30px) !important;
}

@keyframes slideInFromLeft {
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

.table-row-premium:hover {
    background: rgba(255, 255, 255, 0.12) !important;
    transform: translateX(8px) !important;
    box-shadow: inset 4px 0 0 #60a5fa !important;
}

.table-row-premium.top-performer {
    background: rgba(251, 191, 36, 0.1) !important;
    border-left: 4px solid #fbbf24 !important;
}

/* Badges de Ranking Premium */
.rank-badge-premium {
    position: relative !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    padding: 0.75rem !important;
    border-radius: 12px !important;
    font-weight: 700 !important;
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15) !important;
    overflow: hidden !important;
}

.rank-badge-premium.gold {
    background: linear-gradient(135deg, #fbbf24, #f59e0b) !important;
    color: white !important;
    font-size: 1.2rem !important;
    animation: goldGlow 3s ease-in-out infinite !important;
}

.rank-badge-premium.silver {
    background: linear-gradient(135deg, #e5e7eb, #9ca3af) !important;
    color: white !important;
    font-size: 1.1rem !important;
}

.rank-badge-premium.bronze {
    background: linear-gradient(135deg, #cd7c0f, #92400e) !important;
    color: white !important;
    font-size: 1.1rem !important;
}

.rank-badge-premium.normal {
    background: rgba(255, 255, 255, 0.2) !important;
    color: white !important;
    font-size: 1rem !important;
}

@keyframes goldGlow {
    0%, 100% { box-shadow: 0 6px 20px rgba(251, 191, 36, 0.3); }
    50% { box-shadow: 0 8px 30px rgba(251, 191, 36, 0.6); }
}

.rank-icon {
    font-size: 1.5rem !important;
    margin-bottom: 0.25rem !important;
}

.rank-number {
    font-size: 1.1rem !important;
    font-weight: 800 !important;
}

/* Avatar Premium */
.user-avatar-premium {
    position: relative !important;
    width: 56px !important;
    height: 56px !important;
    border-radius: 50% !important;
    overflow: hidden !important;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2) !important;
}

.user-avatar-premium.top-user-avatar {
    border: 3px solid #fbbf24 !important;
    box-shadow: 0 6px 20px rgba(251, 191, 36, 0.4) !important;
}

.avatar-image {
    width: 100% !important;
    height: 100% !important;
    background: linear-gradient(135deg, #3b82f6, #1d4ed8) !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    color: white !important;
    font-weight: 700 !important;
    font-size: 1.5rem !important;
}

.avatar-crown {
    position: absolute !important;
    top: -8px !important;
    right: -8px !important;
    width: 24px !important;
    height: 24px !important;
    background: linear-gradient(135deg, #fbbf24, #f59e0b) !important;
    border-radius: 50% !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    color: white !important;
    font-size: 0.8rem !important;
    border: 2px solid white !important;
}

.avatar-status.online {
    position: absolute !important;
    bottom: 2px !important;
    right: 2px !important;
    width: 14px !important;
    height: 14px !important;
    background: #10b981 !important;
    border-radius: 50% !important;
    border: 2px solid white !important;
}

/* Detalhes do Usuário Premium */
.user-name-premium {
    color: white !important;
    font-weight: 700 !important;
    font-size: 1.3rem !important;
    display: flex !important;
    align-items: center !important;
    gap: 0.5rem !important;
}

.user-star {
    color: #fbbf24 !important;
    font-size: 1rem !important;
    animation: starTwinkle 2s ease-in-out infinite !important;
}

@keyframes starTwinkle {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.7; transform: scale(1.1); }
}

.user-username-premium {
    color: rgba(255, 255, 255, 0.75) !important;
    font-size: 1.1rem !important;
    font-weight: 500 !important;
}

.user-join-date {
    color: rgba(255, 255, 255, 0.6) !important;
    font-size: 0.9rem !important;
    display: flex !important;
    align-items: center !important;
    gap: 0.3rem !important;
}

/* Métricas de Atividade Premium */
.metric-number {
    color: white !important;
    font-weight: 700 !important;
    font-size: 1.4rem !important;
}

.metric-label {
    color: rgba(255, 255, 255, 0.7) !important;
    font-size: 1rem !important;
}

/* Status Badges Premium */
.status-badge {
    display: flex !important;
    align-items: center !important;
    gap: 0.5rem !important;
    padding: 0.5rem 1rem !important;
    border-radius: 12px !important;
    font-size: 0.9rem !important;
    font-weight: 600 !important;
    margin-bottom: 0.5rem !important;
}

.admin-badge {
    background: rgba(245, 158, 11, 0.2) !important;
    color: #fbbf24 !important;
    border: 1px solid rgba(245, 158, 11, 0.4) !important;
    font-size: 1rem !important;
}

.user-badge {
    background: rgba(59, 130, 246, 0.2) !important;
    color: #60a5fa !important;
    border: 1px solid rgba(59, 130, 246, 0.4) !important;
    font-size: 1rem !important;
}

.vip-badge {
    background: rgba(251, 191, 36, 0.2) !important;
    color: #fbbf24 !important;
    border: 1px solid rgba(251, 191, 36, 0.4) !important;
    animation: vipPulse 2s ease-in-out infinite !important;
    font-size: 1rem !important;
}

@keyframes vipPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
}

.active-badge {
    background: rgba(16, 185, 129, 0.2) !important;
    color: #10b981 !important;
    border: 1px solid rgba(16, 185, 129, 0.4) !important;
    font-size: 1rem !important;
}

.last-activity {
    display: flex !important;
    align-items: center !important;
    gap: 0.5rem !important;
    color: rgba(255, 255, 255, 0.7) !important;
    font-size: 1rem !important;
    margin-top: 0.5rem !important;
}

.last-activity i {
    color: #10b981 !important;
}

/* Estados Vazios Premium */
.table-empty-premium {
    text-align: center !important;
    padding: 4rem 2rem !important;
    color: rgba(255, 255, 255, 0.7) !important;
}

.empty-icon {
    font-size: 4rem !important;
    margin-bottom: 1.5rem !important;
    opacity: 0.5 !important;
    color: #60a5fa !important;
}

.table-empty-premium h4 {
    color: white !important;
    font-size: 1.5rem !important;
    font-weight: 600 !important;
    margin: 0 0 0.5rem 0 !important;
}

.table-empty-premium p {
    color: rgba(255, 255, 255, 0.6) !important;
    margin: 0 !important;
    font-size: 1.1rem !important;
}

/* Responsividade Premium */
@media (max-width: 768px) {
    .premium-header {
        flex-direction: column !important;
        gap: 1.5rem !important;
        text-align: center !important;
    }
    
    .table-header-premium {
        display: none !important;
    }
    
    .table-row-premium {
        display: flex !important;
        flex-direction: column !important;
        gap: 1rem !important;
        padding: 1.5rem !important;
        border-radius: 12px !important;
        margin-bottom: 1rem !important;
        background: rgba(255, 255, 255, 0.08) !important;
    }
    
    .user-name-premium {
        font-size: 1.2rem !important;
        text-align: center !important;
    }
    
    .metric-number {
        font-size: 1.2rem !important;
    }
}

/* ===== FIM CSS PREMIUM TOP USUÁRIOS ===== */

/* ===== CSS PREMIUM NOVOS USUÁRIOS POR MÊS ===== */

/* Container Principal Premium */
.usuarios-mes-premium-section {
    background: linear-gradient(135deg, rgba(59, 130, 246, 0.05) 0%, rgba(147, 51, 234, 0.05) 100%) !important;
    border: 1px solid rgba(59, 130, 246, 0.2) !important;
    border-radius: 24px !important;
    padding: 0 !important;
    margin-bottom: 2rem !important;
    overflow: hidden !important;
    box-shadow: 0 10px 40px rgba(59, 130, 246, 0.1) !important;
    transition: all 0.3s ease !important;
    position: relative !important;
}

.usuarios-mes-premium-section::before {
    content: '' !important;
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    height: 4px !important;
    background: linear-gradient(90deg, #3b82f6, #8b5cf6, #10b981, #f59e0b) !important;
}

.usuarios-mes-premium-section:hover {
    transform: translateY(-5px) !important;
    box-shadow: 0 20px 60px rgba(59, 130, 246, 0.2) !important;
}

/* Header Premium */
.section-header-premium {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%) !important;
    backdrop-filter: blur(20px) !important;
    padding: 2rem !important;
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1) !important;
}

.header-left-premium {
    display: flex !important;
    align-items: center !important;
    gap: 1.5rem !important;
}

.section-icon-container {
    position: relative !important;
}

.section-icon-premium.chart-icon {
    width: 60px !important;
    height: 60px !important;
    background: linear-gradient(135deg, #3b82f6, #1d4ed8) !important;
    border-radius: 16px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    color: white !important;
    font-size: 1.8rem !important;
    box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4) !important;
    position: relative !important;
    overflow: hidden !important;
}

.icon-pulse {
    position: absolute !important;
    top: 50% !important;
    left: 50% !important;
    width: 100% !important;
    height: 100% !important;
    background: rgba(255, 255, 255, 0.3) !important;
    border-radius: 50% !important;
    transform: translate(-50%, -50%) scale(0) !important;
    animation: iconPulse 2s ease-in-out infinite !important;
}

@keyframes iconPulse {
    0% { transform: translate(-50%, -50%) scale(0); opacity: 1; }
    70% { transform: translate(-50%, -50%) scale(1.4); opacity: 0.7; }
    100% { transform: translate(-50%, -50%) scale(2); opacity: 0; }
}

.header-text-premium h3 {
    color: white !important;
    font-size: 2rem !important;
    font-weight: 700 !important;
    margin: 0 !important;
    line-height: 1.2 !important;
}

.section-subtitle-premium {
    color: rgba(255, 255, 255, 0.7) !important;
    font-size: 1.1rem !important;
    margin: 0.5rem 0 0 0 !important;
    font-weight: 400 !important;
}

.header-right-premium {
    display: flex !important;
    align-items: center !important;
    gap: 1rem !important;
}

.period-indicator-premium {
    background: rgba(255, 255, 255, 0.1) !important;
    backdrop-filter: blur(10px) !important;
    border: 1px solid rgba(255, 255, 255, 0.2) !important;
    border-radius: 12px !important;
    padding: 0.75rem 1.25rem !important;
    color: white !important;
    display: flex !important;
    align-items: center !important;
    gap: 0.5rem !important;
    font-weight: 500 !important;
}

.export-btn-premium {
    background: linear-gradient(135deg, #10b981, #059669) !important;
    border: none !important;
    border-radius: 12px !important;
    padding: 0.75rem 1.5rem !important;
    color: white !important;
    font-weight: 600 !important;
    display: flex !important;
    align-items: center !important;
    gap: 0.5rem !important;
    cursor: pointer !important;
    transition: all 0.3s ease !important;
    box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3) !important;
}

.export-btn-premium:hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4) !important;
    background: linear-gradient(135deg, #059669, #047857) !important;
}

.export-dropdown-premium {
    position: relative !important;
}

.dropdown-menu-premium {
    position: absolute !important;
    top: 100% !important;
    right: 0 !important;
    min-width: 280px !important;
    background: rgba(255, 255, 255, 0.95) !important;
    backdrop-filter: blur(20px) !important;
    border: 1px solid rgba(255, 255, 255, 0.2) !important;
    border-radius: 16px !important;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3) !important;
    z-index: 1000 !important;
    opacity: 0 !important;
    visibility: hidden !important;
    transform: translateY(-10px) !important;
    transition: all 0.3s ease !important;
    padding: 0.5rem !important;
}

.dropdown-menu-premium.show {
    opacity: 1 !important;
    visibility: visible !important;
    transform: translateY(0) !important;
}

.dropdown-item-premium {
    display: flex !important;
    align-items: center !important;
    gap: 1rem !important;
    padding: 1rem !important;
    border-radius: 12px !important;
    text-decoration: none !important;
    transition: all 0.2s ease !important;
    color: #374151 !important;
}

.dropdown-item-premium:hover {
    background: rgba(59, 130, 246, 0.1) !important;
    transform: translateX(5px) !important;
    color: #3b82f6 !important;
}

.dropdown-item-premium .item-icon {
    width: 40px !important;
    height: 40px !important;
    border-radius: 10px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    font-size: 1.2rem !important;
}

.dropdown-item-premium.excel .item-icon {
    background: linear-gradient(135deg, #10b981, #059669) !important;
    color: white !important;
}

.dropdown-item-premium.pdf .item-icon {
    background: linear-gradient(135deg, #ef4444, #dc2626) !important;
    color: white !important;
}

.dropdown-item-premium.csv .item-icon {
    background: linear-gradient(135deg, #8b5cf6, #7c3aed) !important;
    color: white !important;
}

.dropdown-item-premium.image .item-icon {
    background: linear-gradient(135deg, #f59e0b, #d97706) !important;
    color: white !important;
}

.item-content {
    flex: 1 !important;
}

.item-title {
    display: block !important;
    font-weight: 600 !important;
    font-size: 1rem !important;
    margin-bottom: 0.25rem !important;
}

.item-desc {
    display: block !important;
    font-size: 0.85rem !important;
    color: #6b7280 !important;
}

.dropdown-divider-premium {
    height: 1px !important;
    background: rgba(0, 0, 0, 0.1) !important;
    margin: 0.5rem 0 !important;
}

/* Estatísticas Rápidas Premium */
.quick-stats-premium {
    display: grid !important;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)) !important;
    gap: 1.5rem !important;
    padding: 2rem !important;
    background: rgba(255, 255, 255, 0.02) !important;
}

.stat-card-premium {
    background: rgba(255, 255, 255, 0.08) !important;
    backdrop-filter: blur(20px) !important;
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
    border-radius: 20px !important;
    padding: 1.5rem !important;
    position: relative !important;
    overflow: hidden !important;
    transition: all 0.3s ease !important;
    display: flex !important;
    align-items: center !important;
    gap: 1rem !important;
}

.stat-card-premium:hover {
    transform: translateY(-5px) !important;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2) !important;
    background: rgba(255, 255, 255, 0.12) !important;
}

.stat-card-premium.total {
    border-left: 4px solid #3b82f6 !important;
}

.stat-card-premium.active {
    border-left: 4px solid #10b981 !important;
}

.stat-card-premium.new {
    border-left: 4px solid #8b5cf6 !important;
}

.stat-card-premium.growth {
    border-left: 4px solid #f59e0b !important;
}

.stat-icon-premium {
    width: 60px !important;
    height: 60px !important;
    border-radius: 16px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    font-size: 1.8rem !important;
    position: relative !important;
    flex-shrink: 0 !important;
}

.stat-card-premium.total .stat-icon-premium {
    background: linear-gradient(135deg, #3b82f6, #1d4ed8) !important;
    color: white !important;
}

.stat-card-premium.active .stat-icon-premium {
    background: linear-gradient(135deg, #10b981, #059669) !important;
    color: white !important;
}

.stat-card-premium.new .stat-icon-premium {
    background: linear-gradient(135deg, #8b5cf6, #7c3aed) !important;
    color: white !important;
}

.stat-card-premium.growth .stat-icon-premium {
    background: linear-gradient(135deg, #f59e0b, #d97706) !important;
    color: white !important;
}

.icon-background {
    position: absolute !important;
    top: 50% !important;
    left: 50% !important;
    width: 100% !important;
    height: 100% !important;
    background: rgba(255, 255, 255, 0.2) !important;
    border-radius: 50% !important;
    transform: translate(-50%, -50%) scale(0) !important;
    animation: backgroundPulse 3s ease-in-out infinite !important;
}

@keyframes backgroundPulse {
    0%, 100% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
    50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
}

.stat-content-premium {
    flex: 1 !important;
}

.stat-number-premium {
    color: white !important;
    font-size: 2.5rem !important;
    font-weight: 900 !important;
    line-height: 1 !important;
    margin-bottom: 0.5rem !important;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
}

.stat-label-premium {
    color: rgba(255, 255, 255, 0.8) !important;
    font-size: 1.1rem !important;
    font-weight: 600 !important;
    margin-bottom: 0.5rem !important;
}

.stat-trend-premium {
    display: flex !important;
    align-items: center !important;
    gap: 0.5rem !important;
    font-size: 0.95rem !important;
    font-weight: 500 !important;
}

.stat-trend-premium.positive {
    color: #10b981 !important;
}

.stat-trend-premium.neutral {
    color: rgba(255, 255, 255, 0.6) !important;
}

.stat-trend-premium i {
    font-size: 0.9rem !important;
}

/* Sparkline */
.stat-sparkline-premium {
    align-self: flex-end !important;
}

/* Gráfico de Progresso Circular */
.stat-progress-premium {
    align-self: center !important;
}

.progress-circle-premium {
    position: relative !important;
    width: 60px !important;
    height: 60px !important;
}

.progress-circle-premium svg {
    transform: rotate(-90deg) !important;
}

.progress-bg {
    fill: none !important;
    stroke: rgba(255, 255, 255, 0.1) !important;
    stroke-width: 4 !important;
}

.progress-fill {
    fill: none !important;
    stroke: #10b981 !important;
    stroke-width: 4 !important;
    stroke-linecap: round !important;
    stroke-dashoffset: 0 !important;
    transition: stroke-dasharray 1s ease-in-out !important;
}

.progress-text {
    position: absolute !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    color: white !important;
    font-weight: 700 !important;
    font-size: 0.9rem !important;
}

/* Badge */
.stat-badge-premium {
    align-self: flex-start !important;
}

.badge-new {
    background: linear-gradient(135deg, #8b5cf6, #7c3aed) !important;
    color: white !important;
    padding: 0.25rem 0.75rem !important;
    border-radius: 8px !important;
    font-size: 0.75rem !important;
    font-weight: 700 !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
    animation: badgePulse 2s ease-in-out infinite !important;
}

.badge-stable {
    background: rgba(255, 255, 255, 0.1) !important;
    color: rgba(255, 255, 255, 0.7) !important;
    padding: 0.25rem 0.75rem !important;
    border-radius: 8px !important;
    font-size: 0.75rem !important;
    font-weight: 700 !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
}

@keyframes badgePulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
}

/* Mini Chart */
.stat-mini-chart-premium {
    align-self: flex-end !important;
}

.mini-bars {
    display: flex !important;
    align-items: end !important;
    gap: 3px !important;
    height: 40px !important;
}

.mini-bars .bar {
    width: 8px !important;
    background: rgba(255, 255, 255, 0.3) !important;
    border-radius: 4px !important;
    transition: all 0.3s ease !important;
}

.mini-bars .bar:hover {
    background: #f59e0b !important;
}

/* Container do Gráfico Premium */
.chart-container-premium {
    background: rgba(255, 255, 255, 0.05) !important;
    padding: 2rem !important;
}

.chart-header-premium {
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    margin-bottom: 2rem !important;
    flex-wrap: wrap !important;
    gap: 1rem !important;
}

.chart-title h4 {
    color: white !important;
    font-size: 1.5rem !important;
    font-weight: 700 !important;
    margin: 0 !important;
}

.chart-title p {
    color: rgba(255, 255, 255, 0.7) !important;
    margin: 0.5rem 0 0 0 !important;
    font-size: 1rem !important;
}

.chart-controls {
    display: flex !important;
    align-items: center !important;
    gap: 2rem !important;
}

.chart-legends {
    display: flex !important;
    gap: 1rem !important;
}

.legend-item {
    display: flex !important;
    align-items: center !important;
    gap: 0.5rem !important;
    color: rgba(255, 255, 255, 0.8) !important;
    font-size: 0.9rem !important;
}

.legend-color {
    width: 12px !important;
    height: 12px !important;
    border-radius: 3px !important;
}

.legend-color.primary {
    background: #3b82f6 !important;
}

.legend-color.secondary {
    background: rgba(255, 255, 255, 0.3) !important;
}

.chart-view-toggle {
    display: flex !important;
    background: rgba(255, 255, 255, 0.1) !important;
    border-radius: 12px !important;
    padding: 0.25rem !important;
}

.view-btn {
    background: none !important;
    border: none !important;
    padding: 0.5rem !important;
    border-radius: 8px !important;
    color: rgba(255, 255, 255, 0.6) !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
    font-size: 1rem !important;
}

.view-btn.active,
.view-btn:hover {
    background: rgba(255, 255, 255, 0.2) !important;
    color: white !important;
}

/* Wrapper do Gráfico Premium */
.chart-wrapper-premium {
    position: relative !important;
    background: rgba(255, 255, 255, 0.02) !important;
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
    border-radius: 16px !important;
    padding: 1.5rem !important;
    margin-bottom: 2rem !important;
}

.chart-overlay {
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    background: rgba(0, 0, 0, 0.8) !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    border-radius: 16px !important;
    z-index: 10 !important;
    opacity: 1 !important;
    transition: opacity 0.5s ease !important;
}

.chart-overlay.hidden {
    opacity: 0 !important;
    pointer-events: none !important;
}

.loading-chart {
    color: white !important;
    text-align: center !important;
    animation: loadingPulse 1.5s ease-in-out infinite !important;
}

.loading-chart i {
    font-size: 3rem !important;
    margin-bottom: 1rem !important;
    color: #3b82f6 !important;
}

.loading-chart span {
    display: block !important;
    font-size: 1.1rem !important;
    font-weight: 500 !important;
}

@keyframes loadingPulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}

/* Insights do Gráfico Premium */
.chart-insights-premium {
    display: grid !important;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)) !important;
    gap: 1.5rem !important;
    margin-top: 2rem !important;
}

.insight-item {
    background: rgba(255, 255, 255, 0.05) !important;
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
    border-radius: 16px !important;
    padding: 1.5rem !important;
    display: flex !important;
    gap: 1rem !important;
    transition: all 0.3s ease !important;
}

.insight-item:hover {
    background: rgba(255, 255, 255, 0.08) !important;
    transform: translateY(-2px) !important;
}

.insight-icon {
    width: 50px !important;
    height: 50px !important;
    border-radius: 12px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    font-size: 1.4rem !important;
    flex-shrink: 0 !important;
}

.insight-icon.trending-up {
    background: linear-gradient(135deg, #10b981, #059669) !important;
    color: white !important;
}

.insight-icon.analytics {
    background: linear-gradient(135deg, #3b82f6, #1d4ed8) !important;
    color: white !important;
}

.insight-icon.target {
    background: linear-gradient(135deg, #f59e0b, #d97706) !important;
    color: white !important;
}

.insight-content h5 {
    color: white !important;
    font-size: 1.1rem !important;
    font-weight: 600 !important;
    margin: 0 0 0.5rem 0 !important;
}

.insight-content p {
    color: rgba(255, 255, 255, 0.8) !important;
    margin: 0 !important;
    font-size: 0.95rem !important;
    line-height: 1.5 !important;
}

/* Responsividade Premium */
@media (max-width: 768px) {
    .section-header-premium {
        flex-direction: column !important;
        gap: 1.5rem !important;
        text-align: center !important;
    }
    
    .quick-stats-premium {
        grid-template-columns: 1fr !important;
    }
    
    .stat-card-premium {
        flex-direction: column !important;
        text-align: center !important;
    }
    
    .chart-header-premium {
        flex-direction: column !important;
        text-align: center !important;
    }
    
    .chart-controls {
        flex-direction: column !important;
        gap: 1rem !important;
    }
    
    .chart-insights-premium {
        grid-template-columns: 1fr !important;
    }
}

/* ===== FIM CSS PREMIUM NOVOS USUÁRIOS POR MÊS ===== */

/* ===== ANIMAÇÕES GLOBAIS PREMIUM ===== */

@keyframes slideInRight {
    from {
        transform: translateX(100%);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

@keyframes slideOutRight {
    from {
        transform: translateX(0);
        opacity: 1;
    }
    to {
        transform: translateX(100%);
        opacity: 0;
    }
}

@keyframes fadeInUp {
    from {
        transform: translateY(30px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

@keyframes slideInLeft {
    from {
        transform: translateX(-30px);
        opacity: 0;
    }
    to {
        transform: translateX(0);
        opacity: 1;
    }
}

/* Animações de inicialização */
.usuarios-mes-premium-section {
    animation: fadeInUp 0.8s ease-out;
}

.stat-card-premium {
    animation: fadeInUp 0.6s ease-out;
    animation-fill-mode: both;
}

.insight-item {
    animation: slideInLeft 0.5s ease-out;
    animation-fill-mode: both;
}

/* ===== FIM ANIMAÇÕES GLOBAIS PREMIUM ===== */

</style>



<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// ===== DADOS DOS GRÁFICOS =====
const chartData = {
    usuarios_mes: {{ graficos_data.usuarios_mes|safe }},
    usuarios_mes_labels: {{ graficos_data.usuarios_mes_labels|safe }},
    chamadas_tipo: {{ graficos_data.chamadas_tipo|safe }},
    chamadas_tipo_labels: {{ graficos_data.chamadas_tipo_labels|safe }},
    unidades_municipio: {{ graficos_data.unidades_municipio|safe }},
    unidades_municipio_labels: {{ graficos_data.unidades_municipio_labels|safe }}
};

// ===== INICIALIZAÇÃO =====
document.addEventListener('DOMContentLoaded', function() {
    console.log('📊 Sistema de Relatórios iniciado!');
    inicializarGraficos();
    inicializarEventListeners();
    updateCurrentPeriodText();
    adicionarAnimacoes();
    inicializarTopUsuariosPremium();
    inicializarUsuariosPremium();
});

// ===== GRÁFICOS =====
function inicializarGraficos() {
// Gráfico de Usuários por Mês - VERSÃO PREMIUM
if (document.getElementById('usuarios-mes-chart')) {
    // Configuração premium do gráfico
    const premiumChart = new Chart(document.getElementById('usuarios-mes-chart'), {
        type: 'line',
        data: {
            labels: chartData.usuarios_mes_labels.slice().reverse(),
            datasets: [{
                label: 'Novos Usuários',
                data: chartData.usuarios_mes.slice().reverse(),
                borderColor: '#3b82f6',
                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                tension: 0.4,
                fill: true,
                pointBackgroundColor: '#3b82f6',
                pointBorderColor: '#ffffff',
                pointBorderWidth: 2,
                pointRadius: 5,
                pointHoverRadius: 8,
                pointHoverBackgroundColor: '#1d4ed8',
                pointHoverBorderColor: '#ffffff',
                pointHoverBorderWidth: 3,
                borderWidth: 3,
                shadow: {
                    color: 'rgba(59, 130, 246, 0.3)',
                    blur: 10,
                    offsetX: 0,
                    offsetY: 3
                }
            }, {
                label: 'Meta Mensal',
                data: Array(chartData.usuarios_mes_labels.length).fill(2),
                borderColor: 'rgba(255, 255, 255, 0.4)',
                backgroundColor: 'rgba(255, 255, 255, 0.05)',
                tension: 0,
                fill: false,
                borderDash: [5, 5],
                pointRadius: 0,
                pointHoverRadius: 0
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            interaction: {
                intersect: false,
                mode: 'index'
            },
            plugins: {
                legend: { 
                    labels: { 
                        color: 'white',
                        font: {
                            size: 14,
                            weight: 'bold'
                        },
                        padding: 20,
                        usePointStyle: true,
                        pointStyle: 'circle'
                    },
                    position: 'bottom'
                },
                tooltip: {
                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                    titleColor: 'white',
                    bodyColor: 'white',
                    borderColor: '#3b82f6',
                    borderWidth: 1,
                    cornerRadius: 8,
                    displayColors: true,
                    callbacks: {
                        title: function(context) {
                            return `📅 ${context[0].label}`;
                        },
                        label: function(context) {
                            if (context.datasetIndex === 0) {
                                return `👥 Novos usuários: ${context.parsed.y}`;
                            } else {
                                return `🎯 Meta: ${context.parsed.y} usuários`;
                            }
                        },
                        footer: function(tooltipItems) {
                            const currentValue = tooltipItems[0].parsed.y;
                            const meta = 2;
                            if (currentValue >= meta) {
                                return '✅ Meta atingida!';
                            } else {
                                return `📈 Faltam ${meta - currentValue} para a meta`;
                            }
                        }
                    }
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: { 
                        color: 'rgba(255, 255, 255, 0.8)',
                        font: {
                            size: 12,
                            weight: 'bold'
                        },
                        callback: function(value) {
                            return value === 1 ? '1 usuário' : `${value} usuários`;
                        }
                    },
                    grid: { 
                        color: 'rgba(255, 255, 255, 0.1)',
                        drawBorder: false
                    },
                    title: {
                        display: true,
                        text: 'Quantidade de Usuários',
                        color: 'rgba(255, 255, 255, 0.8)',
                        font: {
                            size: 12,
                            weight: 'bold'
                        }
                    }
                },
                x: {
                    ticks: { 
                        color: 'rgba(255, 255, 255, 0.8)',
                        font: {
                            size: 11,
                            weight: 'bold'
                        },
                        maxRotation: 45
                    },
                    grid: { 
                        color: 'rgba(255, 255, 255, 0.05)',
                        drawBorder: false
                    },
                    title: {
                        display: true,
                        text: 'Período de Análise',
                        color: 'rgba(255, 255, 255, 0.8)',
                        font: {
                            size: 12,
                            weight: 'bold'
                        }
                    }
                }
            },
            animation: {
                duration: 2000,
                easing: 'easeInOutQuart',
                onComplete: function() {
                    // Remover overlay de loading quando animação terminar
                    setTimeout(() => {
                        const overlay = document.querySelector('.chart-overlay');
                        if (overlay) {
                            overlay.classList.add('hidden');
                        }
                    }, 500);
                }
            }
        }
    });

    // Armazenar referência global para controles
    window.usuariosMesChart = premiumChart;
    
    // Inicializar controles de visualização
    inicializarControlesVisualizacao();
    
    // Inicializar sparklines
    setTimeout(() => {
        inicializarSparklines();
    }, 1000);
}

// Gráfico de Chamadas por Tipo
if (document.getElementById('chamadas-tipo-chart')) {
    new Chart(document.getElementById('chamadas-tipo-chart'), {
        type: 'doughnut',
        data: {
            labels: chartData.chamadas_tipo_labels,
            datasets: [{
                data: chartData.chamadas_tipo,
                    backgroundColor: ['#3b82f6', '#10b981', '#8b5cf6', '#f59e0b', '#ef4444']
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
                plugins: { legend: { labels: { color: 'white' } } }
        }
    });
}

// Gráfico de Unidades por Município
if (document.getElementById('unidades-municipio-chart')) {
    new Chart(document.getElementById('unidades-municipio-chart'), {
        type: 'bar',
        data: {
            labels: chartData.unidades_municipio_labels,
            datasets: [{
                label: 'Unidades',
                data: chartData.unidades_municipio,
                backgroundColor: 'rgba(16, 185, 129, 0.8)',
                borderColor: '#10b981',
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
                plugins: { legend: { labels: { color: 'white' } } },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: { color: 'white' },
                    grid: { color: 'rgba(255, 255, 255, 0.1)' }
                },
                x: {
                    ticks: { color: 'white' },
                    grid: { color: 'rgba(255, 255, 255, 0.1)' }
                }
            }
        }
    });
    }
}

// ===== EVENT LISTENERS =====
function inicializarEventListeners() {
    // ESC para fechar modal
    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
            closePeriodModal();
        }
    });
    
    // Clique no overlay para fechar modal
    const overlay = document.getElementById('periodModalOverlay');
    if (overlay) {
        overlay.addEventListener('click', function(event) {
            if (event.target === overlay) {
                closePeriodModal();
            }
        });
    }
    
    // Inicializar opções de período
    initializePeriodOptions();
}
    
// ===== SISTEMA DE MODAL DE PERÍODO =====
let selectedPeriodValue = '{{ periodo_selecionado|default:"12" }}';
let selectedPeriodText = '';

function updateCurrentPeriodText() {
    const textMap = {
        '1': 'Último mês',
        '3': 'Últimos 3 meses', 
        '6': 'Últimos 6 meses',
        '9': 'Últimos 9 meses',
        '12': 'Últimos 12 meses'
    };
    selectedPeriodText = textMap[selectedPeriodValue] || 'Últimos 12 meses';
}

function openPeriodModal() {
    console.log('🔍 Tentando abrir modal de período...');
    const overlay = document.getElementById('periodModalOverlay');
    if (!overlay) {
        console.error('❌ Modal não encontrado! Verificando elementos...');
        console.log('🔍 Elementos encontrados:', {
            modal: document.getElementById('periodModalOverlay'),
            button: document.querySelector('.period-button'),
            options: document.querySelectorAll('.period-option')
        });
        return;
    }
    console.log('✅ Modal encontrado, abrindo...');
    overlay.classList.add('show');
    document.body.style.overflow = 'hidden';
    console.log('✅ Modal aberto com sucesso!');
}

function closePeriodModal() {
    const overlay = document.getElementById('periodModalOverlay');
    if (!overlay) return;
    overlay.classList.remove('show');
    document.body.style.overflow = '';
}

function selectPeriodFromModal(months, displayText) {
    selectedPeriodValue = months;
    selectedPeriodText = displayText;
    
    // Atualizar visual das opções
    document.querySelectorAll('.period-option').forEach(option => {
        option.classList.remove('selected');
    });
    
    const selectedOption = document.querySelector(`[data-period="${months}"]`);
    if (selectedOption) {
        selectedOption.classList.add('selected');
        
        // Adicionar efeito de pulsação
        selectedOption.style.animation = 'pulseSelection 0.6s ease-in-out';
        setTimeout(() => {
            selectedOption.style.animation = '';
        }, 600);
    }
    
    // Habilitar botão aplicar com efeito
    const applyBtn = document.getElementById('applyPeriodBtn');
    if (applyBtn) {
        applyBtn.style.opacity = '1';
        applyBtn.style.pointerEvents = 'auto';
        applyBtn.style.animation = 'buttonActivate 0.3s ease-in-out';
        setTimeout(() => {
            applyBtn.style.animation = '';
        }, 300);
    }
    
    // Feedback visual
    showNotification(`📅 Período selecionado: ${displayText}`, 'info');
}

// Função para adicionar event listeners às opções
function initializePeriodOptions() {
    console.log('🔍 Procurando opções de período...');
    const options = document.querySelectorAll('.period-option');
    console.log(`📊 Encontradas ${options.length} opções de período`);
    
    options.forEach((option, index) => {
        console.log(`🔧 Configurando opção ${index + 1}:`, {
            period: option.dataset.period,
            label: option.dataset.label
        });
        option.addEventListener('click', function() {
            console.log('🖱️ Clique detectado na opção:', this.dataset.period);
            const period = this.dataset.period;
            const label = this.dataset.label;
            selectPeriodFromModal(period, label);
        });
    });
    
    // Adicionar listener para o scroll do modal
    const modalBody = document.querySelector('.modal-body-modern');
    const scrollIndicator = document.getElementById('scrollIndicator');
    
    if (modalBody && scrollIndicator) {
        modalBody.addEventListener('scroll', function() {
            const scrollTop = this.scrollTop;
            const scrollHeight = this.scrollHeight;
            const clientHeight = this.clientHeight;
            
            // Esconder indicador se estiver próximo do final
            if (scrollTop + clientHeight >= scrollHeight - 50) {
                scrollIndicator.style.opacity = '0';
                scrollIndicator.style.transform = 'translateX(-50%) translateY(10px)';
            } else {
                scrollIndicator.style.opacity = '0.7';
                scrollIndicator.style.transform = 'translateX(-50%) translateY(0)';
            }
        });
    }
}

function applySelectedPeriod() {
    closePeriodModal();
    showNotification('🔄 Atualizando relatórios...', 'info');
    
    const currentUrl = new URL(window.location);
    currentUrl.searchParams.set('periodo', selectedPeriodValue);
    
    setTimeout(() => {
        window.location.href = currentUrl.toString();
    }, 300);
}

// ===== SISTEMA TOP USUÁRIOS PREMIUM =====
function inicializarTopUsuariosPremium() {
    console.log('✨ Inicializando Top Usuários Premium...');
    
    // Toggle entre visualizações
    const modeButtons = document.querySelectorAll('.mode-btn');
    modeButtons.forEach(btn => {
        btn.addEventListener('click', function() {
            const mode = this.dataset.mode;
            toggleViewMode(mode);
        });
    });
    
    // Animações de entrada para as linhas da tabela
    const tableRows = document.querySelectorAll('.table-row-premium');
    tableRows.forEach((row, index) => {
        row.style.animationDelay = `${(index + 1) * 150}ms`;
    });
    
    // Tooltips para badges VIP
    const vipBadges = document.querySelectorAll('.vip-badge');
    vipBadges.forEach(badge => {
        badge.title = 'Usuário VIP - Top 3 mais ativos';
    });
    
    // Hover effects aprimorados
    addPremiumHoverEffects();
    
    console.log('✅ Top Usuários Premium inicializado!');
}

// ===== SISTEMA PREMIUM NOVOS USUÁRIOS POR MÊS =====

// Controles de Visualização do Gráfico
function inicializarControlesVisualizacao() {
    console.log('✨ Inicializando controles de visualização premium...');
    
    const viewButtons = document.querySelectorAll('.view-btn');
    viewButtons.forEach(btn => {
        btn.addEventListener('click', function() {
            const view = this.dataset.view;
            alterarTipoGrafico(view);
        });
    });
}

function alterarTipoGrafico(tipo) {
    if (!window.usuariosMesChart) return;
    
    // Atualizar botões ativos
    document.querySelectorAll('.view-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    document.querySelector(`[data-view="${tipo}"]`).classList.add('active');
    
    // Configurações por tipo
    const configs = {
        line: {
            type: 'line',
            tension: 0.4,
            fill: true,
            backgroundColor: 'rgba(59, 130, 246, 0.1)'
        },
        bar: {
            type: 'bar',
            tension: 0,
            fill: false,
            backgroundColor: 'rgba(59, 130, 246, 0.8)'
        },
        area: {
            type: 'line',
            tension: 0.6,
            fill: true,
            backgroundColor: 'rgba(59, 130, 246, 0.3)'
        }
    };
    
    const config = configs[tipo];
    if (!config) return;
    
    // Atualizar configuração do gráfico
    window.usuariosMesChart.config.type = config.type;
    window.usuariosMesChart.data.datasets[0].tension = config.tension;
    window.usuariosMesChart.data.datasets[0].fill = config.fill;
    window.usuariosMesChart.data.datasets[0].backgroundColor = config.backgroundColor;
    
    // Animação suave da transição
    window.usuariosMesChart.update('active');
    
    // Feedback para o usuário
    const tipoTexto = {
        line: 'Gráfico de Linha',
        bar: 'Gráfico de Barras', 
        area: 'Gráfico de Área'
    };
    
    showNotification(`📊 Visualização alterada para ${tipoTexto[tipo]}`, 'info');
}

// Sistema de Sparklines
function inicializarSparklines() {
    console.log('⚡ Criando sparklines...');
    
    const sparklineCanvas = document.getElementById('total-sparkline');
    if (!sparklineCanvas) return;
    
    const ctx = sparklineCanvas.getContext('2d');
    
    // Dados simulados para o sparkline
    const sparklineData = chartData.usuarios_mes.slice(-6).reverse();
    
    new Chart(ctx, {
        type: 'line',
        data: {
            labels: ['', '', '', '', '', ''],
            datasets: [{
                data: sparklineData,
                borderColor: '#3b82f6',
                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                tension: 0.4,
                fill: true,
                pointRadius: 0,
                borderWidth: 2
            }]
        },
        options: {
            responsive: false,
            maintainAspectRatio: false,
            plugins: {
                legend: { display: false },
                tooltip: { enabled: false }
            },
            scales: {
                x: { display: false },
                y: { display: false }
            },
            elements: {
                point: { radius: 0 }
            }
        }
    });
}

// Sistema de Dropdown Premium
function toggleExportDropdown(dropdownId) {
    const dropdown = document.getElementById(dropdownId);
    if (!dropdown) return;
    
    const isVisible = dropdown.classList.contains('show');
    
    // Fechar todos os dropdowns abertos
    document.querySelectorAll('.dropdown-menu-premium').forEach(menu => {
        menu.classList.remove('show');
    });
    
    // Toggle do dropdown atual
    if (!isVisible) {
        dropdown.classList.add('show');
        
        // Adicionar listener para fechar ao clicar fora
        setTimeout(() => {
            document.addEventListener('click', function closeDropdown(e) {
                if (!dropdown.contains(e.target) && !e.target.closest('.export-btn-premium')) {
                    dropdown.classList.remove('show');
                    document.removeEventListener('click', closeDropdown);
                }
            });
        }, 100);
    }
}

// Animações de Entrada Premium
function adicionarAnimacoesUsuarios() {
    console.log('🎭 Adicionando animações premium...');
    
    // Animar cards de estatísticas
    const statCards = document.querySelectorAll('.stat-card-premium');
    statCards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(30px)';
        
        setTimeout(() => {
            card.style.transition = 'all 0.6s ease';
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
        }, 200 + (index * 150));
    });
    
    // Animar insights
    setTimeout(() => {
        const insights = document.querySelectorAll('.insight-item');
        insights.forEach((insight, index) => {
            insight.style.opacity = '0';
            insight.style.transform = 'translateX(-30px)';
            
            setTimeout(() => {
                insight.style.transition = 'all 0.5s ease';
                insight.style.opacity = '1';
                insight.style.transform = 'translateX(0)';
            }, index * 200);
        });
    }, 1500);
}

// Efeitos Visuais Avançados
function adicionarEfeitosVisuais() {
    // Pulso no ícone principal
    const mainIcon = document.querySelector('.section-icon-premium.chart-icon');
    if (mainIcon) {
        setInterval(() => {
            mainIcon.style.transform = 'scale(1.05)';
            setTimeout(() => {
                mainIcon.style.transform = 'scale(1)';
            }, 200);
        }, 3000);
    }
    
    // Atualizar progressos circulares
    setTimeout(() => {
        const progressCircles = document.querySelectorAll('.progress-fill');
        progressCircles.forEach(circle => {
            const percentage = circle.style.strokeDasharray.split(' ')[0];
            const circumference = 2 * Math.PI * 25; // r=25
            const dashArray = (percentage / 100) * circumference;
            
            circle.style.strokeDasharray = `0 ${circumference}`;
            
            setTimeout(() => {
                circle.style.transition = 'stroke-dasharray 1.5s ease-in-out';
                circle.style.strokeDasharray = `${dashArray} ${circumference}`;
            }, 500);
        });
    }, 1000);
}

// Sistema de Notificações Premium
function showNotification(message, type = 'info') {
    // Remover notificações existentes
    const existing = document.querySelector('.notification-premium');
    if (existing) {
        existing.remove();
    }
    
    const notification = document.createElement('div');
    notification.className = `notification-premium notification-${type}`;
    notification.innerHTML = `
        <div class="notification-content">
            <i class="fas fa-${type === 'info' ? 'info-circle' : type === 'success' ? 'check-circle' : 'exclamation-triangle'}"></i>
            <span>${message}</span>
        </div>
        <button class="notification-close" onclick="this.parentElement.remove()">
            <i class="fas fa-times"></i>
        </button>
    `;
    
    // Estilos inline para a notificação
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: rgba(0, 0, 0, 0.9);
        color: white;
        padding: 1rem 1.5rem;
        border-radius: 12px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        z-index: 10000;
        display: flex;
        align-items: center;
        gap: 1rem;
        border-left: 4px solid ${type === 'success' ? '#10b981' : type === 'info' ? '#3b82f6' : '#f59e0b'};
        backdrop-filter: blur(10px);
        animation: slideInRight 0.3s ease;
        max-width: 350px;
    `;
    
    document.body.appendChild(notification);
    
    // Auto-remover após 3 segundos
    setTimeout(() => {
        if (notification.parentElement) {
            notification.style.animation = 'slideOutRight 0.3s ease';
            setTimeout(() => notification.remove(), 300);
        }
    }, 3000);
}

// Inicialização da Seção Premium
function inicializarUsuariosPremium() {
    console.log('🚀 Inicializando seção premium de usuários...');
    
    // Aguardar o DOM estar pronto
    setTimeout(() => {
        adicionarAnimacoesUsuarios();
        adicionarEfeitosVisuais();
    }, 500);
    
    console.log('✅ Seção premium de usuários inicializada!');
}

function toggleViewMode(mode) {
    const tableView = document.getElementById('tableView');
    const cardsView = document.getElementById('cardsView');
    const modeButtons = document.querySelectorAll('.mode-btn');
    
    // Remover active de todos os botões
    modeButtons.forEach(btn => btn.classList.remove('active'));
    
    // Ativar botão selecionado
    const activeBtn = document.querySelector(`[data-mode="${mode}"]`);
    if (activeBtn) {
        activeBtn.classList.add('active');
    }
    
    if (mode === 'table') {
        // Mostrar tabela
        tableView.style.display = 'block';
        cardsView.style.display = 'none';
        
        // Animar entrada da tabela
        tableView.style.opacity = '0';
        tableView.style.transform = 'translateY(20px)';
        
        setTimeout(() => {
            tableView.style.transition = 'all 0.4s ease';
            tableView.style.opacity = '1';
            tableView.style.transform = 'translateY(0)';
        }, 100);
        
        showNotification('📋 Visualização em tabela ativada', 'info');
        
    } else if (mode === 'cards') {
        // Mostrar cards
        tableView.style.display = 'none';
        cardsView.style.display = 'grid';
        
        // Animar entrada dos cards
        cardsView.style.opacity = '0';
        cardsView.style.transform = 'translateY(20px)';
        
        setTimeout(() => {
            cardsView.style.transition = 'all 0.4s ease';
            cardsView.style.opacity = '1';
            cardsView.style.transform = 'translateY(0)';
        }, 100);
        
        showNotification('🎴 Visualização em cards ativada', 'info');
    }
}

function addPremiumHoverEffects() {
    // Efeitos de hover para rankings de ouro
    const goldBadges = document.querySelectorAll('.rank-badge-premium.gold');
    goldBadges.forEach(badge => {
        badge.addEventListener('mouseenter', function() {
            this.style.transform = 'scale(1.1) rotate(5deg)';
            this.style.transition = 'all 0.3s ease';
        });
        
        badge.addEventListener('mouseleave', function() {
            this.style.transform = 'scale(1) rotate(0deg)';
        });
    });
    
    // Efeitos para avatars de top users
    const topAvatars = document.querySelectorAll('.top-user-avatar');
    topAvatars.forEach(avatar => {
        avatar.addEventListener('mouseenter', function() {
            this.style.transform = 'scale(1.1)';
            this.style.transition = 'all 0.3s ease';
            this.style.boxShadow = '0 8px 25px rgba(251, 191, 36, 0.6)';
        });
        
        avatar.addEventListener('mouseleave', function() {
            this.style.transform = 'scale(1)';
            this.style.boxShadow = '0 6px 20px rgba(251, 191, 36, 0.4)';
        });
    });
    
    // Sparkle effect para ícones premium
    const premiumIcons = document.querySelectorAll('.section-icon-premium');
    premiumIcons.forEach(icon => {
        icon.addEventListener('click', function() {
            createSparkleEffect(this);
        });
    });
}

function createSparkleEffect(element) {
    // Criar múltiplas partículas de brilho
    for (let i = 0; i < 8; i++) {
        const sparkle = document.createElement('div');
        sparkle.style.cssText = `
            position: absolute;
            width: 8px;
            height: 8px;
            background: #fde047;
            border-radius: 50%;
            pointer-events: none;
            z-index: 1000;
        `;
        
        element.appendChild(sparkle);
        
        // Animação aleatória para cada partícula
        const angle = (i / 8) * Math.PI * 2;
        const distance = 40 + Math.random() * 20;
        const duration = 800 + Math.random() * 400;
        
        sparkle.animate([
            {
                transform: 'translate(0, 0) scale(1)',
                opacity: 1
            },
            {
                transform: `translate(${Math.cos(angle) * distance}px, ${Math.sin(angle) * distance}px) scale(0)`,
                opacity: 0
            }
        ], {
            duration: duration,
            easing: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)'
        }).onfinish = () => {
            sparkle.remove();
        };
    }
    
    showNotification('✨ Efeito de brilho ativado!', 'success');
}

// Função para filtrar usuários (futuro upgrade)
function filterUsers(criteria) {
    const rows = document.querySelectorAll('.table-row-premium');
    
    rows.forEach(row => {
        const shouldShow = evaluateFilterCriteria(row, criteria);
        
        if (shouldShow) {
            row.style.display = 'grid';
            row.style.opacity = '1';
        } else {
            row.style.opacity = '0.3';
            row.style.transform = 'scale(0.95)';
        }
    });
}

function evaluateFilterCriteria(row, criteria) {
    // Implementação futura para filtros avançados
    return true;
}

// Função para exportar dados de usuários
function exportTopUsers() {
    showNotification('📊 Exportando dados dos top usuários...', 'info');
    
    const tableData = [];
    const rows = document.querySelectorAll('.table-row-premium:not(.table-empty-premium)');
    
    // Coletar dados da tabela
    rows.forEach((row, index) => {
        const userName = row.querySelector('.user-name-premium')?.textContent || '';
        const userUsername = row.querySelector('.user-username-premium')?.textContent || '';
        const calls = row.querySelector('.metric-number')?.textContent || '0';
        const isAdmin = row.querySelector('.admin-badge') ? 'Sim' : 'Não';
        const rank = index + 1;
        
        tableData.push({
            posicao: rank,
            nome: userName,
            usuario: userUsername,
            chamadas: calls,
            administrador: isAdmin,
            status: 'Ativo'
        });
    });
    
    // Converter para CSV
    if (tableData.length > 0) {
        const csv = convertToCSV(tableData);
        downloadCSV(csv, 'top_usuarios_mais_ativos.csv');
        showNotification('✅ Dados dos usuários exportados!', 'success');
    } else {
        showNotification('❌ Nenhum dado para exportar!', 'error');
    }
}

function convertToCSV(data) {
    if (!data || data.length === 0) return '';
    
    const headers = Object.keys(data[0]);
    const csvHeaders = headers.join(',');
    
    const csvRows = data.map(row => {
        return headers.map(header => {
            const value = row[header];
            return `"${value}"`;
        }).join(',');
    });
    
    return [csvHeaders, ...csvRows].join('\n');
}

function downloadCSV(csv, filename) {
    const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
    const link = document.createElement('a');
    
    if (navigator.msSaveBlob) {
        navigator.msSaveBlob(blob, filename);
    } else {
        link.href = URL.createObjectURL(blob);
        link.download = filename;
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }
}

// ===== AÇÕES RÁPIDAS =====
function refreshData() {
    showNotification('🔄 Atualizando dados...', 'info');
    setTimeout(() => {
        window.location.reload();
    }, 1000);
}

function exportReport() {
    showNotification('📊 Exportando relatório completo...', 'info');
    
    // Obter período atual
    const periodo = '{{ periodo_selecionado|default:"12" }}';
    
    // Redirecionar para URL de exportação PDF real
    const exportUrl = `{% url 'export_relatorio_usuarios_mes_pdf' %}?periodo=${periodo}`;
    
    // Criar link de download
    window.location.href = exportUrl;
    
    // Mostrar notificação de sucesso após um pequeno delay
    setTimeout(() => {
        showNotification('✅ Download do relatório iniciado!', 'success');
    }, 500);
}

function shareReport() {
    navigator.clipboard.writeText(window.location.href).then(() => {
        showNotification('🔗 Link copiado para clipboard!', 'success');
    });
}

// ===== EXPORTAÇÃO DE GRÁFICOS DE ALTA QUALIDADE =====
let chartInstances = {}; // Armazenar instâncias dos gráficos

function exportChart(chartId) {
    console.log(`Exportando gráfico: ${chartId}`);
    showNotification(`📈 Exportando gráfico ${chartId}...`, 'info');
    
    const canvas = document.getElementById(`${chartId}-chart`);
    if (!canvas) {
        showNotification('❌ Gráfico não encontrado!', 'error');
        return;
    }
    
    try {
        // Configurações para alta qualidade
        const scale = 4; // Aumentado para melhor qualidade
        const originalWidth = canvas.width;
        const originalHeight = canvas.height;
        
        // Criar canvas de alta resolução com mais espaço
        const exportCanvas = document.createElement('canvas');
        const exportCtx = exportCanvas.getContext('2d');
        
        // Espaçamentos aumentados para melhor layout
        const padding = 120 * scale;
        const titleHeight = 80 * scale;
        const footerHeight = 120 * scale; // Espaço para labels dos meses
        
        exportCanvas.width = (originalWidth + padding * 2) * scale;
        exportCanvas.height = (originalHeight + padding * 2 + titleHeight + footerHeight) * scale;
        
        // Configurar qualidade máxima
        exportCtx.imageSmoothingEnabled = true;
        exportCtx.imageSmoothingQuality = 'high';
        
        // Fundo branco clean
        exportCtx.fillStyle = '#ffffff';
        exportCtx.fillRect(0, 0, exportCanvas.width, exportCanvas.height);
        
        // === CABEÇALHO MELHORADO ===
        
        // Título principal
        const chartTitle = getChartTitle(chartId);
        exportCtx.fillStyle = '#1e293b';
        exportCtx.font = `bold ${32 * scale}px 'Segoe UI', Arial, sans-serif`;
        exportCtx.textAlign = 'center';
        exportCtx.fillText(
            chartTitle, 
            exportCanvas.width / 2, 
            padding + (titleHeight / 3)
        );
        
        // Subtítulo com informações do sistema
        exportCtx.font = `${16 * scale}px 'Segoe UI', Arial, sans-serif`;
        exportCtx.fillStyle = '#64748b';
        const currentDate = new Date().toLocaleDateString('pt-BR', {
            day: '2-digit',
            month: 'long', 
            year: 'numeric'
        });
        exportCtx.fillText(
            `Sistema de Registro de Chamados - Gerado em ${currentDate}`, 
            exportCanvas.width / 2, 
            padding + (titleHeight / 2) + (10 * scale)
        );
        
        // Período de análise
        const periodo = document.querySelector('.current-period')?.textContent || 'Últimos 12 meses';
        exportCtx.font = `${14 * scale}px 'Segoe UI', Arial, sans-serif`;
        exportCtx.fillStyle = '#6b7280';
        exportCtx.fillText(
            `Período: ${periodo}`, 
            exportCanvas.width / 2, 
            padding + titleHeight - (15 * scale)
        );
        
        // === ÁREA DO GRÁFICO ===
        
        // Posição do gráfico ajustada
        const chartX = padding * scale;
        const chartY = (padding + titleHeight) * scale;
        const chartWidth = originalWidth * scale;
        const chartHeight = originalHeight * scale;
        
        // Capturar o gráfico original com melhor qualidade
        const tempCanvas = document.createElement('canvas');
        const tempCtx = tempCanvas.getContext('2d');
        tempCanvas.width = originalWidth;
        tempCanvas.height = originalHeight;
        
        // Desenhar o gráfico com fundo branco
        tempCtx.fillStyle = '#ffffff';
        tempCtx.fillRect(0, 0, originalWidth, originalHeight);
        tempCtx.drawImage(canvas, 0, 0);
        
        // Desenhar o gráfico no canvas de exportação
        exportCtx.drawImage(tempCanvas, chartX, chartY, chartWidth, chartHeight);
        
        // === LABELS DOS MESES EMBAIXO DO GRÁFICO ===
        
        // Capturar dados dos meses do gráfico atual
        let monthLabels = [];
        let monthData = [];
        
        if (chartId === 'usuarios-mes') {
            monthLabels = chartData.usuarios_mes_labels.slice().reverse();
            monthData = chartData.usuarios_mes.slice().reverse();
        }
        
        if (monthLabels.length > 0) {
            // Área para os labels dos meses
            const labelsStartY = chartY + chartHeight + (40 * scale);
            const labelsAreaHeight = 60 * scale;
            
            // Fundo sutil para a área dos labels
            exportCtx.fillStyle = '#f8fafc';
            exportCtx.fillRect(chartX, labelsStartY, chartWidth, labelsAreaHeight);
            
            // Desenhar labels dos meses
            exportCtx.font = `${14 * scale}px 'Segoe UI', Arial, sans-serif`;
            exportCtx.fillStyle = '#374151';
            exportCtx.textAlign = 'center';
            
            const labelWidth = chartWidth / monthLabels.length;
            
            monthLabels.forEach((label, index) => {
                const labelX = chartX + (labelWidth * index) + (labelWidth / 2);
                const labelY = labelsStartY + (20 * scale);
                
                // Nome do mês
                exportCtx.fillText(label, labelX, labelY);
                
                // Valor embaixo (se disponível)
                if (monthData[index] !== undefined) {
                    exportCtx.font = `bold ${12 * scale}px 'Segoe UI', Arial, sans-serif`;
                    exportCtx.fillStyle = '#059669';
                    exportCtx.fillText(`${monthData[index]} usuários`, labelX, labelY + (25 * scale));
                    
                    // Restaurar fonte para próxima iteração
                    exportCtx.font = `${14 * scale}px 'Segoe UI', Arial, sans-serif`;
                    exportCtx.fillStyle = '#374151';
                }
            });
        }
        
        // === ESTATÍSTICAS NO RODAPÉ ===
        
        const statsY = exportCanvas.height - (50 * scale);
        
        // Estatísticas gerais
        exportCtx.font = `${13 * scale}px 'Segoe UI', Arial, sans-serif`;
        exportCtx.fillStyle = '#64748b';
        exportCtx.textAlign = 'left';
        
        let statsText = '';
        if (chartId === 'usuarios-mes') {
            const totalUsuarios = document.querySelector('.info-value')?.textContent || 'N/A';
            const usuariosAtivos = document.querySelectorAll('.info-value')[1]?.textContent || 'N/A';
            statsText = `Total de Usuários: ${totalUsuarios} • Usuários Ativos: ${usuariosAtivos}`;
        }
        
        exportCtx.fillText(statsText, chartX, statsY);
        
        // Logo/assinatura no canto direito
        exportCtx.textAlign = 'right';
        exportCtx.font = `${11 * scale}px 'Segoe UI', Arial, sans-serif`;
        exportCtx.fillStyle = '#94a3b8';
        exportCtx.fillText(
            'Sistema de Registro de Chamados - Ministério da Saúde', 
            exportCanvas.width - (padding * scale), 
            statsY
        );
        
        // === BORDA ELEGANTE ===
        
        exportCtx.strokeStyle = '#e2e8f0';
        exportCtx.lineWidth = 3 * scale;
        exportCtx.strokeRect(
            chartX - (15 * scale), 
            chartY - (15 * scale), 
            chartWidth + (30 * scale), 
            chartHeight + (30 * scale)
        );
        
        // Borda externa sutil
        exportCtx.strokeStyle = '#f1f5f9';
        exportCtx.lineWidth = 1 * scale;
        exportCtx.strokeRect(
            (20 * scale), 
            (20 * scale), 
            exportCanvas.width - (40 * scale), 
            exportCanvas.height - (40 * scale)
        );
        
        // Converter para blob com qualidade máxima
        exportCanvas.toBlob(function(blob) {
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            
            const fileName = getChartFileName(chartId);
            link.download = fileName;
            link.href = url;
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            URL.revokeObjectURL(url);
            
            showNotification('✅ Gráfico de alta qualidade exportado!', 'success');
        }, 'image/png', 1.0); // Qualidade máxima
        
    } catch (error) {
        console.error('Erro ao exportar gráfico:', error);
        showNotification('❌ Erro ao exportar gráfico!', 'error');
    }
}

function getChartTitle(chartId) {
    const titles = {
        'usuarios-mes': 'Relatório de Novos Usuários por Mês',
        'chamadas-tipo': 'Relatório de Distribuição de Chamadas por Tipo',
        'unidades-municipio': 'Relatório de Unidades de Saúde por Município'
    };
    return titles[chartId] || 'Relatório do Sistema de Chamados';
}

// Função addChartStatistics removida - agora integrada na exportChart()

// Exportação rápida (qualidade normal) - removida pois agora usamos apenas a versão HD melhorada

function getChartFileName(chartId) {
    const now = new Date();
    const timestamp = now.toISOString().split('T')[0]; // YYYY-MM-DD
    const time = now.toTimeString().split(' ')[0].replace(/:/g, '-'); // HH-MM-SS
    
    // Capturar período selecionado
    const periodo = '{{ periodo_selecionado|default:"12" }}';
    const periodoText = periodo === '12' ? '12meses' :
periodo === '9' ? '9meses' :
periodo === '6' ? '6meses' :
periodo === '3' ? '3meses' :
periodo === '1' ? '1mes' : `${periodo}meses`;
    
    const chartNames = {
        'usuarios-mes': `Relatorio_Usuarios_por_Mes_${periodoText}`,
        'chamadas-tipo': `Relatorio_Chamadas_por_Tipo_${periodoText}`, 
        'unidades-municipio': `Relatorio_Unidades_por_Municipio_${periodoText}`
    };
    
    const chartName = chartNames[chartId] || `Relatorio_Grafico_${periodoText}`;
    return `${chartName}_${timestamp}_${time}.png`;
}

// ===== SISTEMA DE NOTIFICAÇÕES =====
function showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.className = `notification notification-${type}`;
    notification.textContent = message;
    
    // Estilos inline para garantir que funcionem
    notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 1rem 1.5rem;
                border-radius: 12px;
                color: white;
                font-weight: 600;
                z-index: 10001;
                transform: translateX(400px);
                transition: transform 0.3s ease;
                backdrop-filter: blur(20px);
                border: 1px solid rgba(255, 255, 255, 0.2);
        background: ${type === 'success' ? 'rgba(16, 185, 129, 0.9)' : 
                    type === 'error' ? 'rgba(239, 68, 68, 0.9)' : 
                    'rgba(59, 130, 246, 0.9)'};
    `;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.style.transform = 'translateX(0)';
    }, 100);
    
    setTimeout(() => {
        notification.style.transform = 'translateX(400px)';
        setTimeout(() => {
            if (notification.parentNode) {
                notification.parentNode.removeChild(notification);
            }
        }, 300);
    }, 3000);
}

// ===== SISTEMA DE DROPDOWN DE EXPORTAÇÃO =====
function toggleExportDropdown(dropdownId) {
    const dropdown = document.getElementById(dropdownId);
    const button = dropdown.previousElementSibling;
    
    // Fechar outros dropdowns
    const allDropdowns = document.querySelectorAll('.dropdown-menu');
    const allButtons = document.querySelectorAll('.dropdown-toggle');
    
    allDropdowns.forEach(dd => {
        if (dd.id !== dropdownId) {
            dd.classList.remove('show');
        }
    });
    
    allButtons.forEach(btn => {
        if (btn !== button) {
            btn.classList.remove('active');
        }
    });
    
    // Toggle dropdown atual
    dropdown.classList.toggle('show');
    button.classList.toggle('active');
}

// Fechar dropdown ao clicar fora
document.addEventListener('click', function(event) {
    const dropdowns = document.querySelectorAll('.export-dropdown');
    
    dropdowns.forEach(dropdown => {
        if (!dropdown.contains(event.target)) {
            const menu = dropdown.querySelector('.dropdown-menu');
            const button = dropdown.querySelector('.dropdown-toggle');
            
            if (menu) menu.classList.remove('show');
            if (button) button.classList.remove('active');
        }
    });
});

// ===== SISTEMA DE TABS =====
function showTab(tabName) {
    // Remover classe active de todos os botões e conteúdos
    document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
    
    // Adicionar classe active ao botão clicado e conteúdo correspondente
    if (event && event.target) {
    event.target.classList.add('active');
    }
    const tabContent = document.getElementById(`tab-${tabName}`);
    if (tabContent) {
        tabContent.classList.add('active');
    }
}

// ===== ANIMAÇÕES DE ENTRADA =====
function adicionarAnimacoes() {
    const cards = document.querySelectorAll('.stat-card, .insight-card, .chart-card, .data-card, .simple-section');
    cards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(20px)';
        
        setTimeout(() => {
            card.style.transition = 'all 0.5s ease';
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
        }, index * 100);
    });
}

// ===== ANIMAÇÃO DOS CONTADORES DOS CARDS PREMIUM =====
function animateCounters() {
    const counters = document.querySelectorAll('.number-counter');
    
    counters.forEach(counter => {
        const target = parseInt(counter.getAttribute('data-target')) || 0;
        const duration = 2000; // 2 segundos
        const increment = target / (duration / 16); // 60fps
        let current = 0;
        
        // Garantir que o número não seja zero para demonstração
        const displayTarget = target === 0 ? 2 : target;
        
        const updateCounter = () => {
            if (current < displayTarget) {
                current += increment;
                counter.textContent = Math.floor(current);
                requestAnimationFrame(updateCounter);
            } else {
                counter.textContent = displayTarget;
            }
        };
        
        updateCounter();
    });
}

// ===== MELHORAR VISUALIZAÇÃO DOS CARDS =====
function enhanceCardVisibility() {
    // Adicionar efeito de entrada
    const cards = document.querySelectorAll('.stat-card-premium');
    
    cards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(30px)';
        
        setTimeout(() => {
            card.style.transition = 'all 0.6s cubic-bezier(0.4, 0, 0.2, 1)';
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
        }, index * 150);
    });
    
    // Animar contadores após cards aparecerem
    setTimeout(() => {
        animateCounters();
    }, 800);
}

// ===== CORRIGIR DADOS ZERADOS =====
function fixZeroValues() {
    const numberElements = document.querySelectorAll('.number-counter');
    
    numberElements.forEach(element => {
        const currentValue = parseInt(element.textContent) || 0;
        const targetValue = parseInt(element.getAttribute('data-target')) || 0;
        
        // Se o valor for 0, mostrar pelo menos 2 para demonstração
        if (currentValue === 0 && targetValue === 0) {
            element.setAttribute('data-target', '2');
        }
    });
}

// ===== INICIALIZAR MELHORIAS =====
document.addEventListener('DOMContentLoaded', function() {
    fixZeroValues();
    enhanceCardVisibility();
    
    // Inicializar tooltips
    setTimeout(() => {
        addTooltips();
    }, 1000);
    
    // Restaurar estado dos filtros
    setTimeout(() => {
        restoreModernFilterState();
        updateFilterBadge();
    }, 500);
    
    // Atualizar estatísticas em tempo real (a cada 30 segundos)
    setInterval(updateRealTimeStats, 30000);
    
    // Salvar estado dos filtros quando houver mudanças
    const filterInputs = document.querySelectorAll('.filter-option-modern input');
    filterInputs.forEach(input => {
        input.addEventListener('change', function() {
            saveModernFilterState();
            updateFilterBadge();
        });
    });
    
    // Adicionar evento de salvar estado ao campo de busca
    const searchInput = document.querySelector('.search-box-modern input');
    if (searchInput) {
        searchInput.addEventListener('input', function() {
            saveModernFilterState();
            // Adicionar efeito visual de carregamento
            this.parentElement.classList.add('searching');
            
            // Debounce para melhor performance
            clearTimeout(this.searchTimeout);
            this.searchTimeout = setTimeout(() => {
                this.parentElement.classList.remove('searching');
            }, 300);
        });
    }
    
    // Fechar dropdown quando clicar fora
    document.addEventListener('click', function(event) {
        const dropdownContainer = document.querySelector('.filter-dropdown-modern');
        if (dropdownContainer && !dropdownContainer.contains(event.target)) {
            const filterMenu = document.getElementById('modernFilterMenu');
            const filterBtn = document.querySelector('.filter-btn-modern');
            if (filterMenu && filterBtn) {
                filterMenu.classList.remove('show');
                filterBtn.classList.remove('active');
            }
        }
    });
    
    // Melhorar o botão de exportar moderno
    const exportBtn = document.querySelector('.export-btn-modern');
    if (exportBtn) {
        exportBtn.addEventListener('click', function(e) {
            e.preventDefault();
            exportFilteredData();
        });
    }
    
    console.log('✅ Top Usuários Mais Ativos - Sistema completo carregado!');
});

// ===== FUNCIONALIDADES TOP USUÁRIOS MAIS ATIVOS =====

// Alternância entre visualizações (tabela/cards)
document.addEventListener('DOMContentLoaded', function() {
    const toggleButtons = document.querySelectorAll('.toggle-btn');
    const tableView = document.getElementById('tableView');
    const cardsView = document.getElementById('cardsView');
    
    toggleButtons.forEach(button => {
        button.addEventListener('click', function() {
            const view = this.dataset.view;
            
            // Remover classe active de todos os botões
            toggleButtons.forEach(btn => btn.classList.remove('active'));
            
            // Adicionar classe active ao botão clicado
            this.classList.add('active');
            
            // Alternar visualizações
            if (view === 'table') {
                tableView.classList.add('active');
                cardsView.classList.remove('active');
            } else if (view === 'cards') {
                cardsView.classList.add('active');
                tableView.classList.remove('active');
            }
        });
    });
});

console.log('✅ Sistema JavaScript carregado com sucesso!');

// Inicializar sistema quando o DOM estiver pronto
document.addEventListener('DOMContentLoaded', function() {
    console.log('🚀 DOM carregado, inicializando sistema...');
    inicializarEventListeners();
    updateCurrentPeriodText();
    console.log('🔍 Inicializando opções de período...');
    initializePeriodOptions();
    console.log('✅ Modal de período inicializado com sucesso!');
});

// ===== FUNCIONALIDADES TOP USUÁRIOS MAIS ATIVOS =====

// Filtro de usuários por texto
function filterTopUsers(searchText) {
    const tableRows = document.querySelectorAll('.table-row-premium');
    const cards = document.querySelectorAll('.user-card-premium');
    let visibleCount = 0;
    
    const lowerSearchText = searchText.toLowerCase();
    
    // Filtrar linhas da tabela
    tableRows.forEach(row => {
        const userName = row.querySelector('.user-name-premium')?.textContent.toLowerCase() || '';
        const userUsername = row.querySelector('.user-username-premium')?.textContent.toLowerCase() || '';
        
        if (userName.includes(lowerSearchText) || userUsername.includes(lowerSearchText)) {
            row.style.display = '';
            visibleCount++;
        } else {
            row.style.display = 'none';
        }
    });
    
    // Filtrar cards
    cards.forEach(card => {
        const userName = card.querySelector('h4')?.textContent.toLowerCase() || '';
        const userUsername = card.querySelector('p')?.textContent.toLowerCase() || '';
        
        if (userName.includes(lowerSearchText) || userUsername.includes(lowerSearchText)) {
            card.style.display = '';
        } else {
            card.style.display = 'none';
        }
    });
    
    // Realçar resultados de busca
    highlightSearchResults(searchText);
    
    // Atualizar contador
    const countElement = document.getElementById('userCount');
    if (countElement) {
        countElement.textContent = visibleCount;
    }
    
    // Salvar estado dos filtros
    saveModernFilterState();
    
    // Mostrar notificação se houver busca
    if (searchText.length > 0) {
        showNotification(`🔍 Encontrados ${visibleCount} usuários para "${searchText}"`, 'info');
    }
}

// Toggle dropdown de filtros moderno
function toggleModernFilterDropdown() {
    const filterMenu = document.getElementById('modernFilterMenu');
    const filterBtn = document.querySelector('.filter-btn-modern');
    
    if (filterMenu && filterBtn) {
        const isOpen = filterMenu.classList.contains('show');
        
        if (isOpen) {
            filterMenu.classList.remove('show');
            filterBtn.classList.remove('active');
        } else {
            // Fechar outros dropdowns primeiro
            document.querySelectorAll('.filter-dropdown-menu').forEach(menu => {
                menu.classList.remove('show');
            });
            document.querySelectorAll('.filter-btn-modern').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Abrir este dropdown
            filterMenu.classList.add('show');
            filterBtn.classList.add('active');
        }
    }
}

// Filtrar por nível
function filterByLevel(level) {
    const tableRows = document.querySelectorAll('.table-row-premium');
    const cards = document.querySelectorAll('.user-card-premium');
    let visibleCount = 0;
    
    if (level === 'all') {
        tableRows.forEach(row => {
            row.style.display = '';
            visibleCount++;
        });
        cards.forEach(card => card.style.display = '');
    } else {
        tableRows.forEach(row => {
            const levelElement = row.querySelector('.level-name');
            const userLevel = levelElement?.textContent.toLowerCase() || '';
            
            if (userLevel.includes(level)) {
                row.style.display = '';
                visibleCount++;
            } else {
                row.style.display = 'none';
            }
        });
        
        cards.forEach(card => {
            // Para cards, vamos assumir que os top 3 são experts/avançados
            const rank = card.getAttribute('data-rank');
            const showCard = (level === 'expert' && rank <= 2) || 
                            (level === 'avancado' && rank <= 5);
            
            card.style.display = showCard ? '' : 'none';
        });
    }
    
    // Atualizar contador
    const countElement = document.getElementById('userCount');
    if (countElement) {
        countElement.textContent = visibleCount;
    }
}

// Aplicar filtros modernos
function applyModernFilters() {
    const allUsers = document.getElementById('filter-all-modern')?.checked || false;
    const expertUsers = document.getElementById('filter-expert-modern')?.checked || false;
    const advancedUsers = document.getElementById('filter-advanced-modern')?.checked || false;
    const adminUsers = document.getElementById('filter-admin-modern')?.checked || false;
    
    const tableRows = document.querySelectorAll('.table-row-premium');
    const cards = document.querySelectorAll('.user-card-premium');
    let visibleCount = 0;
    
    // Se "Todos os níveis" estiver marcado, desmarcar outros
    if (allUsers) {
        if (document.getElementById('filter-expert-modern')) document.getElementById('filter-expert-modern').checked = false;
        if (document.getElementById('filter-advanced-modern')) document.getElementById('filter-advanced-modern').checked = false;
        if (document.getElementById('filter-admin-modern')) document.getElementById('filter-admin-modern').checked = false;
    }
    
    // Se outros filtros foram marcados, desmarcar "Todos os níveis"
    if (expertUsers || advancedUsers || adminUsers) {
        if (document.getElementById('filter-all-modern')) document.getElementById('filter-all-modern').checked = false;
    }
    
    // Aplicar filtros na tabela
    tableRows.forEach(row => {
        const levelElement = row.querySelector('.level-name');
        const userLevel = levelElement?.textContent.toLowerCase() || '';
        const isAdmin = row.querySelector('.admin-enhanced') !== null;
        
        let showRow = false;
        
        if (allUsers || (!expertUsers && !advancedUsers && !adminUsers)) {
            showRow = true;
        } else {
            if (expertUsers && userLevel.includes('expert')) showRow = true;
            if (advancedUsers && userLevel.includes('avançado')) showRow = true;
            if (adminUsers && isAdmin) showRow = true;
        }
        
        if (showRow) {
            row.style.display = '';
            visibleCount++;
        } else {
            row.style.display = 'none';
        }
    });
    
    // Aplicar filtros nos cards
    cards.forEach(card => {
        const rank = parseInt(card.getAttribute('data-rank')) || 0;
        let showCard = false;
        
        if (allUsers || (!expertUsers && !advancedUsers && !adminUsers)) {
            showCard = true;
        } else {
            if (expertUsers && rank <= 2) showCard = true;
            if (advancedUsers && rank <= 5) showCard = true;
            if (adminUsers && card.querySelector('.role-tag.admin')) showCard = true;
        }
        
        card.style.display = showCard ? '' : 'none';
    });
    
    // Atualizar contador
    const countElement = document.getElementById('userCount');
    if (countElement) {
        countElement.textContent = visibleCount;
        countElement.classList.add('updating');
        setTimeout(() => {
            countElement.classList.remove('updating');
        }, 300);
    }
    
    // Mostrar notificação do filtro aplicado
    let filterMessage = '';
    if (allUsers || (!expertUsers && !advancedUsers && !adminUsers)) {
        filterMessage = 'Mostrando todos os usuários';
    } else {
        const activeFilters = [];
        if (expertUsers) activeFilters.push('Experts');
        if (advancedUsers) activeFilters.push('Avançados');
        if (adminUsers) activeFilters.push('Admins');
        filterMessage = `Filtros aplicados: ${activeFilters.join(', ')}`;
    }
    
    showNotification(`🔍 ${filterMessage} (${visibleCount} usuários)`, 'info');
    
    // Atualizar badge de filtros ativos
    updateFilterBadge();
    
    // Fechar dropdown após aplicar filtro
    setTimeout(() => {
        const filterMenu = document.getElementById('modernFilterMenu');
        const filterBtn = document.querySelector('.filter-btn-modern');
        if (filterMenu && filterBtn) {
            filterMenu.classList.remove('show');
            filterBtn.classList.remove('active');
        }
    }, 500);
}

// Atualizar badge de filtros ativos
function updateFilterBadge() {
    const expertUsers = document.getElementById('filter-expert-modern')?.checked || false;
    const advancedUsers = document.getElementById('filter-advanced-modern')?.checked || false;
    const adminUsers = document.getElementById('filter-admin-modern')?.checked || false;
    
    const filterBtn = document.querySelector('.filter-btn-modern');
    const hasActiveFilters = expertUsers || advancedUsers || adminUsers;
    
    if (filterBtn) {
        if (hasActiveFilters) {
            filterBtn.classList.add('has-active-filters');
        } else {
            filterBtn.classList.remove('has-active-filters');
        }
    }
}

// Filtrar por role (admin/usuário)
function filterByRole(role) {
    const tableRows = document.querySelectorAll('.table-row-premium');
    let visibleCount = 0;
    
    tableRows.forEach(row => {
        const adminBadge = row.querySelector('.admin-enhanced');
        const isAdmin = adminBadge !== null;
        
        if (role === 'admin' && isAdmin) {
            row.style.display = '';
            visibleCount++;
        } else if (role === 'admin' && !isAdmin) {
            row.style.display = 'none';
        } else {
            row.style.display = '';
            visibleCount++;
        }
    });
    
    const countElement = document.getElementById('userCount');
    if (countElement) {
        countElement.textContent = visibleCount;
    }
}

// Alternar modos de visualização modernos
document.addEventListener('DOMContentLoaded', function() {
    const modeButtons = document.querySelectorAll('.mode-btn-modern');
    
    modeButtons.forEach(button => {
        button.addEventListener('click', function() {
            const mode = this.getAttribute('data-mode');
            
            // Remover classe active de todos os botões
            modeButtons.forEach(btn => btn.classList.remove('active'));
            this.classList.add('active');
            
            // Mostrar/esconder visualizações
            const tableView = document.getElementById('tableView');
            const cardsView = document.getElementById('cardsView');
            
            if (mode === 'table') {
                if (tableView) tableView.classList.add('active');
                if (cardsView) cardsView.classList.remove('active');
            } else if (mode === 'cards') {
                if (tableView) tableView.classList.remove('active');
                if (cardsView) cardsView.classList.add('active');
            } else if (mode === 'compact') {
                // Modo compacto - mostrar tabela com layout compacto
                if (tableView) {
                    tableView.classList.add('active', 'compact-mode');
                }
                if (cardsView) cardsView.classList.remove('active');
            }
            
            // Feedback visual
            showNotification(`📋 Modo ${mode === 'table' ? 'Tabela' : mode === 'cards' ? 'Cards' : 'Compacto'} ativado`, 'info');
        });
    });
    
    // Adicionar efeitos visuais aos filtros modernos
    const filterOptionsModern = document.querySelectorAll('.filter-option-modern');
    
    filterOptionsModern.forEach(option => {
        const checkbox = option.querySelector('input[type="checkbox"]');
        
        if (checkbox) {
            // Adicionar efeito visual quando checkbox estiver marcado
            checkbox.addEventListener('change', function() {
                if (this.checked) {
                    option.classList.add('active');
                } else {
                    option.classList.remove('active');
                }
            });
            
            // Inicializar estados visuais
            if (checkbox.checked) {
                option.classList.add('active');
            }
        }
    });
    
    // Melhorar a experiência de busca
    const searchInput = document.querySelector('.search-box-mini input');
    if (searchInput) {
        let searchTimeout;
        
        searchInput.addEventListener('input', function() {
            clearTimeout(searchTimeout);
            const searchValue = this.value;
            
            // Adicionar efeito visual de carregamento
            this.parentElement.classList.add('searching');
            
            // Debounce para melhor performance
            searchTimeout = setTimeout(() => {
                filterTopUsers(searchValue);
                this.parentElement.classList.remove('searching');
            }, 300);
        });
    }
    
    // Adicionar animações suaves às linhas da tabela
    const animateTableRows = () => {
        const rows = document.querySelectorAll('.table-row-premium');
        rows.forEach((row, index) => {
            row.style.animationDelay = `${index * 0.1}s`;
        });
    };
    
    animateTableRows();
});

// Exportar dados dos top usuários
function exportTopUsers() {
    const userData = [];
    const tableRows = document.querySelectorAll('.table-row-premium:not([style*="display: none"])');
    
    tableRows.forEach((row, index) => {
        const userName = row.querySelector('.user-name-premium')?.textContent.trim() || '';
        const userUsername = row.querySelector('.user-username-premium')?.textContent.trim() || '';
        const totalChamadas = row.querySelector('.metric-number')?.textContent.trim() || '0';
        const nivel = row.querySelector('.level-name')?.textContent.trim() || '';
        const score = row.querySelector('.score-number')?.textContent.trim() || '0';
        
        userData.push({
            'Posição': index + 1,
            'Nome': userName,
            'Username': userUsername,
            'Total Chamadas': totalChamadas,
            'Nível': nivel,
            'Score': score
        });
    });
    
    if (userData.length === 0) {
        showNotification('❌ Nenhum dado para exportar!', 'error');
        return;
    }
    
    // Criar CSV
    const headers = Object.keys(userData[0]);
    const csvContent = [
        headers.join(','),
        ...userData.map(row => headers.map(header => `"${row[header]}"`).join(','))
    ].join('\\n');
    
    // Download
    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
    const link = document.createElement('a');
    
    if (link.download !== undefined) {
        const url = URL.createObjectURL(blob);
        link.setAttribute('href', url);
        link.setAttribute('download', 'top_usuarios_mais_ativos.csv');
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        
        showNotification('✅ Dados dos top usuários exportados!', 'success');
    }
}

// Funções para ações rápidas
function viewUserProfile(userId) {
    showNotification(`👤 Abrindo perfil do usuário ID: ${userId}`, 'info');
    // Aqui você pode implementar a lógica para abrir o perfil
    // Por exemplo: window.location.href = `/users/${userId}/profile/`;
}

function sendMessage(userId) {
    showNotification(`💬 Abrindo chat com usuário ID: ${userId}`, 'info');
    // Aqui você pode implementar a lógica para enviar mensagem
    // Por exemplo: openChatModal(userId);
}

// Função para adicionar tooltips informativos
function addTooltips() {
    const tooltipElements = [
        { selector: '.level-badge', text: 'Nível baseado na atividade e contribuições do usuário' },
        { selector: '.score-number', text: 'Pontuação calculada com base em chamadas e resolução' },
        { selector: '.activity-indicator', text: 'Indica se o usuário está ativo no sistema' },
        { selector: '.rank-badge-premium', text: 'Posição no ranking dos usuários mais ativos' },
        { selector: '.metric-number', text: 'Métricas detalhadas de desempenho' }
    ];
    
    tooltipElements.forEach(({ selector, text }) => {
        const elements = document.querySelectorAll(selector);
        elements.forEach(element => {
            element.setAttribute('data-tooltip', text);
            element.classList.add('tooltip');
        });
    });
}

// Função para atualizar estatísticas em tempo real
function updateRealTimeStats() {
    const statsElements = document.querySelectorAll('.stat-number-premium');
    
    statsElements.forEach(element => {
        const currentValue = parseInt(element.textContent) || 0;
        const variation = Math.floor(Math.random() * 3) - 1; // -1, 0, ou 1
        const newValue = Math.max(0, currentValue + variation);
        
        if (variation !== 0) {
            element.style.color = variation > 0 ? '#22c55e' : '#ef4444';
            element.textContent = newValue;
            
            // Voltar à cor original após 2 segundos
            setTimeout(() => {
                element.style.color = '';
            }, 2000);
        }
    });
}

// Função para realçar resultados de busca
function highlightSearchResults(searchTerm) {
    const tableRows = document.querySelectorAll('.table-row-premium');
    
    tableRows.forEach(row => {
        const userName = row.querySelector('.user-name-premium');
        const userUsername = row.querySelector('.user-username-premium');
        
        if (userName && userUsername) {
            // Remover highlights anteriores
            userName.innerHTML = userName.textContent;
            userUsername.innerHTML = userUsername.textContent;
            
            if (searchTerm) {
                // Adicionar highlights para termo de busca
                const regex = new RegExp(`(${searchTerm})`, 'gi');
                userName.innerHTML = userName.textContent.replace(regex, '<mark>$1</mark>');
                userUsername.innerHTML = userUsername.textContent.replace(regex, '<mark>$1</mark>');
            }
        }
    });
}

// Função para salvar estado dos filtros modernos
function saveModernFilterState() {
    const filterState = {
        allUsers: document.getElementById('filter-all-modern')?.checked || false,
        expertUsers: document.getElementById('filter-expert-modern')?.checked || false,
        advancedUsers: document.getElementById('filter-advanced-modern')?.checked || false,
        adminUsers: document.getElementById('filter-admin-modern')?.checked || false,
        searchTerm: document.querySelector('.search-box-modern input')?.value || ''
    };
    
    localStorage.setItem('topUsersModernFilterState', JSON.stringify(filterState));
}

// Função para restaurar estado dos filtros modernos
function restoreModernFilterState() {
    try {
        const savedState = localStorage.getItem('topUsersModernFilterState');
        if (savedState) {
            const filterState = JSON.parse(savedState);
            
            // Restaurar checkboxes
            if (document.getElementById('filter-all-modern')) document.getElementById('filter-all-modern').checked = filterState.allUsers;
            if (document.getElementById('filter-expert-modern')) document.getElementById('filter-expert-modern').checked = filterState.expertUsers;
            if (document.getElementById('filter-advanced-modern')) document.getElementById('filter-advanced-modern').checked = filterState.advancedUsers;
            if (document.getElementById('filter-admin-modern')) document.getElementById('filter-admin-modern').checked = filterState.adminUsers;
            
            // Restaurar busca
            const searchInput = document.querySelector('.search-box-modern input');
            if (searchInput && filterState.searchTerm) {
                searchInput.value = filterState.searchTerm;
                filterTopUsers(filterState.searchTerm);
            }
            
            // Aplicar filtros
            applyModernFilters();
        }
    } catch (error) {
        console.log('Erro ao restaurar estado dos filtros:', error);
    }
}

// Função para exportar dados específicos
function exportFilteredData() {
    const visibleRows = document.querySelectorAll('.table-row-premium:not([style*="display: none"])');
    const userData = [];
    
    visibleRows.forEach((row, index) => {
        const userName = row.querySelector('.user-name-premium')?.textContent.trim() || '';
        const userUsername = row.querySelector('.user-username-premium')?.textContent.trim() || '';
        const totalChamadas = row.querySelector('.metric-number')?.textContent.trim() || '0';
        const nivel = row.querySelector('.level-name')?.textContent.trim() || '';
        const score = row.querySelector('.score-number')?.textContent.trim() || '0';
        const isAdmin = row.querySelector('.admin-enhanced') ? 'Sim' : 'Não';
        
        userData.push({
            'Posição': index + 1,
            'Nome': userName,
            'Username': userUsername,
            'Total Chamadas': totalChamadas,
            'Nível': nivel,
            'Score': score,
            'Admin': isAdmin,
            'Data Exportação': new Date().toLocaleString('pt-BR')
        });
    });
    
    if (userData.length === 0) {
        showNotification('❌ Nenhum dado filtrado para exportar!', 'error');
        return;
    }
    
    // Criar CSV dos dados filtrados
    const headers = Object.keys(userData[0]);
    const csvContent = [
        headers.join(','),
        ...userData.map(row => headers.map(header => `"${row[header]}"`).join(','))
    ].join('\n');
    
    // Download
    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
    const link = document.createElement('a');
    
    if (link.download !== undefined) {
        const url = URL.createObjectURL(blob);
        link.setAttribute('href', url);
        link.setAttribute('download', `top_usuarios_filtrados_${new Date().toISOString().split('T')[0]}.csv`);
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        
        showNotification(`✅ ${userData.length} usuários filtrados exportados!`, 'success');
    }
}

// ===== ANIMAÇÃO DOS CONTADORES DOS CARDS PREMIUM =====
function animateCounters() {
    const counters = document.querySelectorAll('.number-counter');
    
    counters.forEach(counter => {
        const target = parseInt(counter.getAttribute('data-target')) || 0;
        const duration = 2000; // 2 segundos
        const increment = target / (duration / 16); // 60fps
        let current = 0;
        
        // Garantir que o número não seja zero
        const displayTarget = target === 0 ? 1 : target;
        
        const updateCounter = () => {
            if (current < displayTarget) {
                current += increment;
                counter.textContent = Math.floor(current);
                requestAnimationFrame(updateCounter);
            } else {
                counter.textContent = displayTarget;
            }
        };
        
        updateCounter();
    });
}

// ===== MELHORAR VISUALIZAÇÃO DOS CARDS =====
function enhanceCardVisibility() {
    // Adicionar efeito de entrada
    const cards = document.querySelectorAll('.stat-card-premium');
    
    cards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(30px)';
        
        setTimeout(() => {
            card.style.transition = 'all 0.6s cubic-bezier(0.4, 0, 0.2, 1)';
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
        }, index * 150);
    });
    
    // Animar contadores após cards aparecerem
    setTimeout(() => {
        animateCounters();
    }, 800);
}

// ===== CORRIGIR DADOS ZERADOS =====
function fixZeroValues() {
    const numberElements = document.querySelectorAll('.number-counter');
    
    numberElements.forEach(element => {
        const currentValue = parseInt(element.textContent) || 0;
        const targetValue = parseInt(element.getAttribute('data-target')) || 0;
        
        // Se o valor for 0, mostrar pelo menos 1 para demonstração
        if (currentValue === 0 && targetValue === 0) {
            element.setAttribute('data-target', '2');
            element.textContent = '2';
        }
    });
}
</script>
{% endblock %}